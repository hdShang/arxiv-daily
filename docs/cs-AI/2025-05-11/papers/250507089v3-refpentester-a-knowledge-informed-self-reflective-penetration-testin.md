---
layout: default
title: RefPentester: A Knowledge-Informed Self-Reflective Penetration Testing Framework Based on Large Language Models
---

# RefPentester: A Knowledge-Informed Self-Reflective Penetration Testing Framework Based on Large Language Models

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2505.07089" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2505.07089v3</a>
  <a href="https://arxiv.org/pdf/2505.07089.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2505.07089v3" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2505.07089v3', 'RefPentester: A Knowledge-Informed Self-Reflective Penetration Testing Framework Based on Large Language Models')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Hanzheng Dai, Yuanliang Li, Jun Yan, Zhibo Zhang

**åˆ†ç±»**: cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-05-11 (æ›´æ–°: 2025-06-25)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºRefPentesterä»¥è§£å†³è‡ªåŠ¨æ¸—é€æµ‹è¯•ä¸­çš„çŸ¥è¯†ä¸è¶³é—®é¢˜**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±å››ï¼šç”Ÿæˆå¼åŠ¨ä½œ (Generative Motion)** **æ”¯æŸ±ä¹ï¼šå…·èº«å¤§æ¨¡å‹ (Embodied Foundation Models)**

**å…³é”®è¯**: `è‡ªåŠ¨æ¸—é€æµ‹è¯•` `å¤§è¯­è¨€æ¨¡å‹` `çŸ¥è¯†é©±åŠ¨` `è‡ªåæœºåˆ¶` `ä¿¡æ¯å®‰å…¨` `æ¸—é€æµ‹è¯•æ¡†æ¶` `æœºå™¨å­¦ä¹ `

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰çš„LLMåŸºç¡€è‡ªåŠ¨æ¸—é€æµ‹è¯•æ¡†æ¶åœ¨å¤æ‚ä»»åŠ¡ä¸­è¡¨ç°ä¸ä½³ï¼Œä¸»è¦ç”±äºçŸ¥è¯†ä¸å¹³è¡¡å’Œç¼ºä¹å­¦ä¹ æœºåˆ¶ã€‚
2. æœ¬æ–‡æå‡ºRefPentesteræ¡†æ¶ï¼Œé€šè¿‡çŸ¥è¯†é©±åŠ¨å’Œè‡ªåæœºåˆ¶æ¥æå‡æ¸—é€æµ‹è¯•çš„æœ‰æ•ˆæ€§å’Œé€‚åº”æ€§ã€‚
3. å®éªŒç»“æœæ˜¾ç¤ºï¼ŒRefPentesteråœ¨æ¸—é€æµ‹è¯•é˜¶æ®µè½¬æ¢ä¸­è¡¨ç°ä¼˜å¼‚ï¼ŒæˆåŠŸç‡æ˜¾è‘—é«˜äºåŸºçº¿æ¨¡å‹ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

åŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„è‡ªåŠ¨æ¸—é€æµ‹è¯•ï¼ˆAutoPTï¼‰å› å…¶è‡ªåŠ¨åŒ–ä¼¦ç†é»‘å®¢è¿‡ç¨‹å’Œè¯†åˆ«ç›®æ ‡ç³»ç»Ÿæ¼æ´çš„èƒ½åŠ›è€Œå—åˆ°å…³æ³¨ã€‚ç„¶è€Œï¼Œç°æœ‰çš„LLMåŸºç¡€AutoPTæ¡†æ¶åœ¨å¤æ‚ä»»åŠ¡ä¸­å¾€å¾€è¡¨ç°ä¸ä½³ï¼ŒåŸå› åŒ…æ‹¬è®­ç»ƒçŸ¥è¯†ä¸å¹³è¡¡ã€è§„åˆ’è¿‡ç¨‹çŸ­è§†ä»¥åŠå‘½ä»¤ç”Ÿæˆä¸­çš„å¹»è§‰ã€‚æ­¤å¤–ï¼Œç°æœ‰æ¡†æ¶ç¼ºä¹ä»å¤±è´¥ä¸­å­¦ä¹ çš„æœºåˆ¶ï¼Œé™åˆ¶äº†æ¸—é€æµ‹è¯•ç­–ç•¥çš„è‡ªé€‚åº”æ”¹è¿›ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§çŸ¥è¯†é©±åŠ¨çš„è‡ªåæ¸—é€æµ‹è¯•æ¡†æ¶RefPentesterï¼Œæ—¨åœ¨å¸®åŠ©äººç±»æ“ä½œå‘˜è¯†åˆ«æ¸—é€æµ‹è¯•è¿‡ç¨‹çš„å½“å‰é˜¶æ®µï¼Œé€‰æ‹©é€‚å½“çš„æˆ˜æœ¯å’ŒæŠ€æœ¯ï¼Œæä¾›é€æ­¥æ“ä½œæŒ‡å¯¼ï¼Œå¹¶åæ€å’Œå­¦ä¹ ä¹‹å‰å¤±è´¥çš„æ“ä½œã€‚è¯„ä¼°ç»“æœè¡¨æ˜ï¼ŒRefPentesteråœ¨Hack The Boxçš„Sauæœºå™¨ä¸ŠæˆåŠŸæ­ç¤ºå‡­è¯ï¼Œè¶…è¶ŠåŸºçº¿GPT-4oæ¨¡å‹16.7%ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šæœ¬æ–‡æ—¨åœ¨è§£å†³ç°æœ‰è‡ªåŠ¨æ¸—é€æµ‹è¯•æ¡†æ¶åœ¨å¤æ‚ä»»åŠ¡ä¸­çš„ä¸è¶³ï¼ŒåŒ…æ‹¬çŸ¥è¯†ä¸å¹³è¡¡ã€çŸ­è§†è§„åˆ’å’Œç¼ºä¹è‡ªé€‚åº”å­¦ä¹ æœºåˆ¶ç­‰ç—›ç‚¹ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šRefPentesteræ¡†æ¶é€šè¿‡çŸ¥è¯†é©±åŠ¨å’Œè‡ªåæœºåˆ¶ï¼Œå¸®åŠ©æ“ä½œå‘˜åœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­è¯†åˆ«é˜¶æ®µã€é€‰æ‹©æˆ˜æœ¯å’ŒæŠ€æœ¯ï¼Œå¹¶ä»å¤±è´¥ä¸­å­¦ä¹ ï¼Œä»¥æå‡æ¸—é€æµ‹è¯•çš„æœ‰æ•ˆæ€§ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥æ¡†æ¶å°†æ¸—é€æµ‹è¯•è¿‡ç¨‹å»ºæ¨¡ä¸ºä¸ƒçŠ¶æ€çš„é˜¶æ®µæœºï¼Œä¸»è¦æ¨¡å—åŒ…æ‹¬é˜¶æ®µè¯†åˆ«ã€æˆ˜æœ¯é€‰æ‹©ã€æ“ä½œæŒ‡å¯¼å’Œåæ€å­¦ä¹ ç­‰ã€‚

**å…³é”®åˆ›æ–°**ï¼šRefPentesterçš„æ ¸å¿ƒåˆ›æ–°åœ¨äºå…¶è‡ªåæœºåˆ¶ï¼Œèƒ½å¤Ÿåœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­å®æ—¶å­¦ä¹ å’Œè°ƒæ•´ç­–ç•¥ï¼Œæ˜¾è‘—æå‡äº†é€‚åº”æ€§å’ŒæˆåŠŸç‡ã€‚

**å…³é”®è®¾è®¡**ï¼šæ¡†æ¶è®¾è®¡ä¸­è€ƒè™‘äº†å¤šç§å‚æ•°è®¾ç½®å’ŒæŸå¤±å‡½æ•°ï¼Œç¡®ä¿æ¨¡å‹åœ¨ä¸åŒæ¸—é€æµ‹è¯•é˜¶æ®µçš„æœ‰æ•ˆæ€§ï¼Œå…·ä½“ç»†èŠ‚åŒ…æ‹¬é˜¶æ®µæœºçš„çŠ¶æ€è½¬ç§»å’ŒçŸ¥è¯†æ•´åˆæœºåˆ¶ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼ŒRefPentesteråœ¨Hack The Boxçš„Sauæœºå™¨ä¸ŠæˆåŠŸæ­ç¤ºå‡­è¯ï¼Œè¶…è¶ŠåŸºçº¿GPT-4oæ¨¡å‹16.7%ã€‚æ­¤å¤–ï¼Œåœ¨æ¸—é€æµ‹è¯•é˜¶æ®µè½¬æ¢ä¸­ï¼ŒRefPentesterçš„æˆåŠŸç‡ä¹Ÿæ˜¾è‘—é«˜äºå…¶ä»–ç°æœ‰æ¡†æ¶ï¼Œå±•ç¤ºäº†å…¶ä¼˜è¶Šçš„æ€§èƒ½ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

RefPentesteræ¡†æ¶å…·æœ‰å¹¿æ³›çš„åº”ç”¨æ½œåŠ›ï¼Œå°¤å…¶åœ¨ä¿¡æ¯å®‰å…¨é¢†åŸŸçš„æ¸—é€æµ‹è¯•ä¸­ï¼Œå¯ä»¥å¸®åŠ©å®‰å…¨ä¸“å®¶æ›´é«˜æ•ˆåœ°è¯†åˆ«å’Œä¿®å¤ç³»ç»Ÿæ¼æ´ã€‚æœªæ¥ï¼Œè¯¥æ¡†æ¶è¿˜å¯æ‰©å±•è‡³å…¶ä»–é¢†åŸŸï¼Œå¦‚ç½‘ç»œå®‰å…¨åŸ¹è®­å’Œè‡ªåŠ¨åŒ–å®‰å…¨è¯„ä¼°ï¼Œæå‡æ•´ä½“å®‰å…¨é˜²æŠ¤èƒ½åŠ›ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Automated penetration testing (AutoPT) powered by large language models (LLMs) has gained attention for its ability to automate ethical hacking processes and identify vulnerabilities in target systems by leveraging the inherent knowledge of LLMs. However, existing LLM-based AutoPT frameworks often underperform compared to human experts in challenging tasks for several reasons: the imbalanced knowledge used in LLM training, short-sightedness in the planning process, and hallucinations during command generation. Moreover, the trial-and-error nature of the PT process is constrained by existing frameworks lacking mechanisms to learn from previous failures, restricting adaptive improvement of PT strategies. To address these limitations, we propose a knowledge-informed, self-reflective PT framework powered by LLMs, called RefPentester. This AutoPT framework is designed to assist human operators in identifying the current stage of the PT process, selecting appropriate tactics and techniques for each stage, choosing suggested actions, providing step-by-step operational guidance, and reflecting on and learning from previous failed operations. We also modeled the PT process as a seven-state Stage Machine to integrate the proposed framework effectively. The evaluation shows that RefPentester can successfully reveal credentials on Hack The Box's Sau machine, outperforming the baseline GPT-4o model by 16.7%. Across PT stages, RefPentester also demonstrates superior success rates on PT stage transitions.

