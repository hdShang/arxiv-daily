---
layout: default
title: IntentMiner: Intent Inversion Attack via Tool Call Analysis in the Model Context Protocol
---

# IntentMiner: Intent Inversion Attack via Tool Call Analysis in the Model Context Protocol

**arXiv**: [2512.14166v1](https://arxiv.org/abs/2512.14166) | [PDF](https://arxiv.org/pdf/2512.14166.pdf)

**ä½œè€…**: Yunhao Yao, Zhiqiang Wang, Haoran Cheng, Yihang Cheng, Haohua Du, Xiang-Yang Li

**åˆ†ç±»**: cs.CR, cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: 12 pages, 6 figures

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºIntentMineræ¡†æž¶ï¼Œé€šè¿‡åˆ†æžæ¨¡åž‹ä¸Šä¸‹æ–‡åè®®ä¸­çš„å·¥å…·è°ƒç”¨ï¼Œæ­ç¤ºåŽ»è€¦åˆæ™ºèƒ½ä½“æž¶æž„ä¸­çš„æ„å›¾åæ¼”éšç§å¨èƒã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **è§†è§‰é‡Œç¨‹è®¡** **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `æ„å›¾åæ¼”æ”»å‡»` `æ¨¡åž‹ä¸Šä¸‹æ–‡åè®®` `éšç§å¨èƒ` `å·¥å…·è°ƒç”¨åˆ†æž` `åˆ†å±‚ä¿¡æ¯éš”ç¦»` `ä¸‰ç»´è¯­ä¹‰åˆ†æž` `æ™ºèƒ½ä½“å®‰å…¨` `åŽ»è€¦åˆæž¶æž„`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. æ ¸å¿ƒé—®é¢˜ï¼šæ¨¡åž‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰ä½œä¸ºåŽ»è€¦åˆæ™ºèƒ½ä½“æž¶æž„çš„æ ‡å‡†ï¼Œä½¿ç¬¬ä¸‰æ–¹æœåŠ¡å™¨èƒ½è§‚å¯Ÿå·¥å…·äº¤äº’æ—¥å¿—ï¼Œå¯¼è‡´ç”¨æˆ·æ„å›¾å¯èƒ½è¢«åŠè¯šå®žä¸­ä»‹åæ¼”ï¼ŒçŽ°æœ‰æ–¹æ³•ç¼ºä¹å¯¹æ­¤éšç§å¨èƒçš„ç³»ç»Ÿè¯„ä¼°ã€‚
2. æ–¹æ³•è¦ç‚¹ï¼šæå‡ºIntentMineræ¡†æž¶ï¼Œé€šè¿‡åˆ†å±‚ä¿¡æ¯éš”ç¦»å’Œä¸‰ç»´è¯­ä¹‰åˆ†æžï¼Œæ•´åˆå·¥å…·ç›®çš„ã€è°ƒç”¨è¯­å¥å’Œè¿”å›žç»“æžœï¼Œåœ¨æ­¥éª¤çº§åˆ«å‡†ç¡®æŽ¨æ–­ç”¨æˆ·æ„å›¾ï¼Œä»¥è¯„ä¼°æ„å›¾åæ¼”æ¼æ´žã€‚
3. å®žéªŒæˆ–æ•ˆæžœï¼šå®žéªŒæ˜¾ç¤ºIntentMinerä¸ŽåŽŸå§‹ç”¨æˆ·æŸ¥è¯¢çš„è¯­ä¹‰å¯¹é½åº¦è¶…è¿‡85%ï¼Œæ˜¾è‘—ä¼˜äºŽåŸºçº¿æ–¹æ³•ï¼Œæ­ç¤ºäº†åŽ»è€¦åˆæž¶æž„ä¸­å·¥å…·æ—¥å¿—ä½œä¸ºéšç§æ³„éœ²è½½ä½“çš„é£Žé™©ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å¤§åž‹è¯­è¨€æ¨¡åž‹ï¼ˆLLMsï¼‰å‘è‡ªä¸»æ™ºèƒ½ä½“çš„å¿«é€Ÿå‘å±•ï¼Œä¿ƒä½¿æ¨¡åž‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰æˆä¸ºå‘çŽ°å’Œè°ƒç”¨å¤–éƒ¨å·¥å…·çš„æ ‡å‡†ã€‚è™½ç„¶è¿™ç§æž¶æž„å°†æŽ¨ç†å¼•æ“Žä¸Žå·¥å…·æ‰§è¡Œè§£è€¦ä»¥æå‡å¯æ‰©å±•æ€§ï¼Œä½†ä¹Ÿå¼•å…¥äº†æ˜¾è‘—çš„éšç§æš´éœ²é¢ï¼šä½œä¸ºåŠè¯šå®žä¸­ä»‹çš„ç¬¬ä¸‰æ–¹MCPæœåŠ¡å™¨ï¼Œå¯ä»¥åœ¨ç”¨æˆ·ä¿¡ä»»è¾¹ç•Œä¹‹å¤–è§‚å¯Ÿè¯¦ç»†çš„å·¥å…·äº¤äº’æ—¥å¿—ã€‚æœ¬æ–‡é¦–å…ˆè¯†åˆ«å¹¶å½¢å¼åŒ–äº†ä¸€ç§æ–°çš„éšç§å¨èƒï¼Œç§°ä¸ºæ„å›¾åæ¼”ï¼Œå³åŠè¯šå®žçš„MCPæœåŠ¡å™¨ä»…é€šè¿‡åˆ†æžåˆæ³•çš„å·¥å…·è°ƒç”¨æ¥å°è¯•é‡å»ºç”¨æˆ·çš„ç§æœ‰åº•å±‚æ„å›¾ã€‚ä¸ºäº†ç³»ç»Ÿè¯„ä¼°è¿™ä¸€æ¼æ´žï¼Œæˆ‘ä»¬æå‡ºäº†IntentMineræ¡†æž¶ï¼Œè¯¥æ¡†æž¶åˆ©ç”¨åˆ†å±‚ä¿¡æ¯éš”ç¦»å’Œä¸‰ç»´è¯­ä¹‰åˆ†æžï¼Œæ•´åˆå·¥å…·ç›®çš„ã€è°ƒç”¨è¯­å¥å’Œè¿”å›žç»“æžœï¼Œä»¥åœ¨æ­¥éª¤çº§åˆ«å‡†ç¡®æŽ¨æ–­ç”¨æˆ·æ„å›¾ã€‚å¤§é‡å®žéªŒè¡¨æ˜Žï¼ŒIntentMinerå®žçŽ°äº†ä¸ŽåŽŸå§‹ç”¨æˆ·æŸ¥è¯¢çš„é«˜åº¦è¯­ä¹‰å¯¹é½ï¼ˆè¶…è¿‡85%ï¼‰ï¼Œæ˜¾è‘—ä¼˜äºŽåŸºçº¿æ–¹æ³•ã€‚è¿™äº›ç»“æžœçªæ˜¾äº†è§£è€¦æ™ºèƒ½ä½“æž¶æž„ä¸­å›ºæœ‰çš„éšç§é£Žé™©ï¼Œæ­ç¤ºäº†çœ‹ä¼¼è‰¯æ€§çš„å·¥å…·æ‰§è¡Œæ—¥å¿—å¯ä»¥ä½œä¸ºæš´éœ²ç”¨æˆ·ç§˜å¯†çš„æœ‰æ•ˆè½½ä½“ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡è¦è§£å†³çš„å…·ä½“é—®é¢˜æ˜¯æ¨¡åž‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰åœ¨åŽ»è€¦åˆæ™ºèƒ½ä½“æž¶æž„ä¸­å¼•å…¥çš„éšç§å¨èƒï¼Œå³æ„å›¾åæ¼”æ”»å‡»ã€‚çŽ°æœ‰æ–¹æ³•çš„ç—›ç‚¹åœ¨äºŽï¼ŒMCPä½œä¸ºæ ‡å‡†åè®®ï¼Œå…è®¸ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ä½œä¸ºåŠè¯šå®žä¸­ä»‹è§‚å¯Ÿå·¥å…·äº¤äº’æ—¥å¿—ï¼Œä½†è¿™äº›æ—¥å¿—é€šå¸¸è¢«è§†ä¸ºè‰¯æ€§æ•°æ®ï¼Œç¼ºä¹å¯¹ç”¨æˆ·ç§æœ‰æ„å›¾å¯èƒ½è¢«é‡å»ºçš„ç³»ç»Ÿæ€§è¯„ä¼°ï¼Œå¯¼è‡´éšç§é£Žé™©è¢«ä½Žä¼°ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒè§£å†³æ€è·¯æ˜¯è®¾è®¡ä¸€ä¸ªæ¡†æž¶æ¥æ¨¡æ‹Ÿå’Œè¯„ä¼°æ„å›¾åæ¼”æ”»å‡»ï¼Œé€šè¿‡åˆ†æžå·¥å…·è°ƒç”¨çš„è¯­ä¹‰ä¿¡æ¯æ¥æŽ¨æ–­ç”¨æˆ·æ„å›¾ã€‚è¿™æ ·è®¾è®¡æ˜¯å› ä¸ºå·¥å…·è°ƒç”¨æ—¥å¿—åŒ…å«äº†ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå¦‚å·¥å…·ç›®çš„ã€è°ƒç”¨å‚æ•°å’Œè¿”å›žç»“æžœï¼‰ï¼Œè¿™äº›ä¿¡æ¯åœ¨åŽ»è€¦åˆæž¶æž„ä¸­æš´éœ²ç»™ç¬¬ä¸‰æ–¹ï¼Œå¯èƒ½è¢«æ¶æ„åˆ©ç”¨æ¥é‡å»ºç”¨æˆ·æ„å›¾ï¼Œä»Žè€Œæ­ç¤ºéšç§æ¼æ´žã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“æž¶æž„åŒ…æ‹¬æ•°æ®æ”¶é›†ã€é¢„å¤„ç†ã€æ„å›¾æŽ¨æ–­å’Œè¯„ä¼°å››ä¸ªé˜¶æ®µã€‚ä¸»è¦æ¨¡å—æœ‰ï¼š1) å·¥å…·è°ƒç”¨æ—¥å¿—æ”¶é›†æ¨¡å—ï¼Œä»ŽMCPæœåŠ¡å™¨èŽ·å–å·¥å…·äº¤äº’æ•°æ®ï¼›2) åˆ†å±‚ä¿¡æ¯éš”ç¦»æ¨¡å—ï¼Œå°†æ—¥å¿—åˆ†è§£ä¸ºå·¥å…·ç›®çš„ã€è°ƒç”¨è¯­å¥å’Œè¿”å›žç»“æžœç­‰å±‚æ¬¡ï¼›3) ä¸‰ç»´è¯­ä¹‰åˆ†æžæ¨¡å—ï¼Œæ•´åˆè¿™äº›å±‚æ¬¡ä¿¡æ¯è¿›è¡Œè¯­ä¹‰å»ºæ¨¡ï¼›4) æ„å›¾æŽ¨æ–­æ¨¡å—ï¼ŒåŸºäºŽåˆ†æžç»“æžœåœ¨æ­¥éª¤çº§åˆ«ç”Ÿæˆç”¨æˆ·æ„å›¾æè¿°ï¼›5) è¯„ä¼°æ¨¡å—ï¼Œé€šè¿‡è¯­ä¹‰å¯¹é½åº¦ç­‰æŒ‡æ ‡é‡åŒ–æ”»å‡»æ•ˆæžœã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹æ˜¯æå‡ºäº†åˆ†å±‚ä¿¡æ¯éš”ç¦»å’Œä¸‰ç»´è¯­ä¹‰åˆ†æžçš„æ–¹æ³•ï¼Œå°†å·¥å…·è°ƒç”¨æ—¥å¿—çš„å¤šç»´åº¦ä¿¡æ¯ï¼ˆå·¥å…·ç›®çš„ã€è°ƒç”¨è¯­å¥ã€è¿”å›žç»“æžœï¼‰ç³»ç»Ÿæ•´åˆï¼Œä»¥å¢žå¼ºæ„å›¾æŽ¨æ–­çš„å‡†ç¡®æ€§ã€‚ä¸ŽçŽ°æœ‰æ–¹æ³•çš„æœ¬è´¨åŒºåˆ«åœ¨äºŽï¼ŒçŽ°æœ‰ç ”ç©¶å¤šå…³æ³¨å·¥å…·æ‰§è¡Œçš„å®‰å…¨æ€§ï¼Œè€Œæœ¬æ–‡é¦–æ¬¡å½¢å¼åŒ–å¹¶è¯„ä¼°äº†åŸºäºŽå·¥å…·æ—¥å¿—çš„æ„å›¾åæ¼”æ”»å‡»ï¼Œçªå‡ºäº†åŽ»è€¦åˆæž¶æž„ä¸­éšç§å¨èƒçš„æ–°ç»´åº¦ã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) åˆ†å±‚ä¿¡æ¯éš”ç¦»ç­–ç•¥ï¼Œå°†å·¥å…·æ—¥å¿—ç»“æž„åŒ–åˆ†è§£ï¼Œé¿å…ä¿¡æ¯æ··æ·†ï¼›2) ä¸‰ç»´è¯­ä¹‰åˆ†æžç®—æ³•ï¼Œä½¿ç”¨è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯ï¼ˆå¦‚åµŒå…¥å‘é‡å’Œç›¸ä¼¼åº¦è®¡ç®—ï¼‰æ¥èžåˆä¸åŒå±‚æ¬¡çš„ä¿¡æ¯ï¼›3) æ­¥éª¤çº§æŽ¨æ–­æœºåˆ¶ï¼Œé€æ­¥éª¤åˆ†æžå·¥å…·è°ƒç”¨åºåˆ—ï¼Œä»¥é‡å»ºæ•´ä½“æ„å›¾ï¼›4) è¯„ä¼°æŒ‡æ ‡ï¼Œé‡‡ç”¨è¯­ä¹‰å¯¹é½åº¦ï¼ˆå¦‚åŸºäºŽBERTçš„ç›¸ä¼¼åº¦å¾—åˆ†ï¼‰æ¥é‡åŒ–æŽ¨æ–­ç»“æžœä¸ŽåŽŸå§‹æŸ¥è¯¢çš„ä¸€è‡´æ€§ï¼Œå®žéªŒè®¾ç½®ä¸­å¯èƒ½æ¶‰åŠåŸºçº¿å¯¹æ¯”ï¼ˆå¦‚åŸºäºŽç®€å•æ—¥å¿—åˆ†æžçš„æ–¹æ³•ï¼‰å’Œå‚æ•°è°ƒä¼˜ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

æœ€é‡è¦çš„å®žéªŒç»“æžœæ˜¾ç¤ºï¼ŒIntentMineråœ¨æ„å›¾åæ¼”æ”»å‡»ä¸­å®žçŽ°äº†è¶…è¿‡85%çš„è¯­ä¹‰å¯¹é½åº¦ï¼Œæ˜¾è‘—ä¼˜äºŽåŸºçº¿æ–¹æ³•ï¼ˆå…·ä½“æå‡å¹…åº¦æœªåœ¨æ‘˜è¦ä¸­ç»™å‡ºï¼Œä½†å¼ºè°ƒâ€œæ˜¾è‘—ä¼˜äºŽâ€ï¼‰ã€‚è¿™è¡¨æ˜Žå·¥å…·è°ƒç”¨æ—¥å¿—èƒ½æœ‰æ•ˆæš´éœ²ç”¨æˆ·æ„å›¾ï¼Œæ­ç¤ºäº†åŽ»è€¦åˆæ™ºèƒ½ä½“æž¶æž„çš„å›ºæœ‰éšç§é£Žé™©ã€‚å®žéªŒå¯èƒ½æ¶‰åŠå¤šæ ·åŒ–çš„å·¥å…·è°ƒç”¨åœºæ™¯ï¼Œä»¥éªŒè¯æ¡†æž¶çš„é²æ£’æ€§å’Œæ³›åŒ–èƒ½åŠ›ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶çš„æ½œåœ¨åº”ç”¨é¢†åŸŸåŒ…æ‹¬æ™ºèƒ½ä½“å®‰å…¨è¯„ä¼°ã€éšç§ä¿æŠ¤è®¾è®¡å’Œåè®®æ ‡å‡†åŒ–ã€‚å®žé™…ä»·å€¼åœ¨äºŽå¸®åŠ©å¼€å‘è€…å’Œç ”ç©¶äººå‘˜è¯†åˆ«å’Œç¼“è§£åŽ»è€¦åˆæž¶æž„ï¼ˆå¦‚åŸºäºŽMCPçš„LLMæ™ºèƒ½ä½“ï¼‰ä¸­çš„éšç§æ¼æ´žï¼Œé€šè¿‡æ¨¡æ‹Ÿæ”»å‡»æ¥å¢žå¼ºç³»ç»Ÿçš„æŠ—æ„å›¾åæ¼”èƒ½åŠ›ã€‚æœªæ¥å½±å“å¯èƒ½æŽ¨åŠ¨æ›´å®‰å…¨çš„å·¥å…·è°ƒç”¨åè®®è®¾è®¡ï¼Œä¿ƒè¿›äººå·¥æ™ºèƒ½åœ¨æ•æ„Ÿåœºæ™¯ï¼ˆå¦‚åŒ»ç–—ã€é‡‘èžï¼‰ä¸­çš„å¯ä¿¡éƒ¨ç½²ï¼Œå¹¶ä¸ºéšç§å¢žå¼ºæŠ€æœ¯æä¾›æ–°æ–¹å‘ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> The rapid evolution of Large Language Models (LLMs) into autonomous agents has led to the adoption of the Model Context Protocol (MCP) as a standard for discovering and invoking external tools. While this architecture decouples the reasoning engine from tool execution to enhance scalability, it introduces a significant privacy surface: third-party MCP servers, acting as semi-honest intermediaries, can observe detailed tool interaction logs outside the user's trusted boundary. In this paper, we first identify and formalize a novel privacy threat termed Intent Inversion, where a semi-honest MCP server attempts to reconstruct the user's private underlying intent solely by analyzing legitimate tool calls. To systematically assess this vulnerability, we propose IntentMiner, a framework that leverages Hierarchical Information Isolation and Three-Dimensional Semantic Analysis, integrating tool purpose, call statements, and returned results, to accurately infer user intent at the step level. Extensive experiments demonstrate that IntentMiner achieves a high degree of semantic alignment (over 85%) with original user queries, significantly outperforming baseline approaches. These results highlight the inherent privacy risks in decoupled agent architectures, revealing that seemingly benign tool execution logs can serve as a potent vector for exposing user secrets.

