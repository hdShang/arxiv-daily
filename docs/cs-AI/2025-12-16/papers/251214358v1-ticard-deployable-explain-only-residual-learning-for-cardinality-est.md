---
layout: default
title: TiCard: Deployable EXPLAIN-only Residual Learning for Cardinality Estimation
---

# TiCard: Deployable EXPLAIN-only Residual Learning for Cardinality Estimation

**arXiv**: [2512.14358v1](https://arxiv.org/abs/2512.14358) | [PDF](https://arxiv.org/pdf/2512.14358.pdf)

**ä½œè€…**: Qizhi Wang

**åˆ†ç±»**: cs.AI, cs.DB

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: 16 pages(/wo references), 4 figures, 10 tables

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºTiCardæ¡†æž¶ï¼Œé€šè¿‡ä»…ä½¿ç”¨EXPLAINç‰¹å¾çš„æ®‹å·®å­¦ä¹ æ¥å¢žå¼ºæ•°æ®åº“åŸºæ•°ä¼°è®¡ï¼Œè§£å†³ä¼ ç»Ÿæ–¹æ³•å¿½ç•¥ç›¸å…³æ€§å’Œå­¦ä¹ åž‹æ–¹æ³•éƒ¨ç½²å›°éš¾çš„é—®é¢˜ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **è§†è§‰é‡Œç¨‹è®¡**

**å…³é”®è¯**: `åŸºæ•°ä¼°è®¡` `æŸ¥è¯¢ä¼˜åŒ–` `æ®‹å·®å­¦ä¹ ` `æ•°æ®åº“å¢žå¼º` `å¯éƒ¨ç½²AI` `æ¢¯åº¦æå‡å›žå½’å™¨` `è¡¨æ ¼åŸºç¡€æ¨¡åž‹` `AI4DB`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. æ ¸å¿ƒé—®é¢˜ï¼šä¼ ç»ŸåŸºæ•°ä¼°è®¡å™¨å¿½ç•¥æ•°æ®ç›¸å…³æ€§ï¼Œå¯¼è‡´ä¼°è®¡ä¸å‡†ç¡®ï¼›å­¦ä¹ åž‹æ–¹æ³•éœ€è¦å¤æ‚è®­ç»ƒæµç¨‹å’Œä¾µå…¥å¼é›†æˆï¼Œéƒ¨ç½²å›°éš¾ã€‚
2. æ–¹æ³•è¦ç‚¹ï¼šæå‡ºTiCardæ¡†æž¶ï¼Œé€šè¿‡ä»…ä½¿ç”¨EXPLAINç‰¹å¾å­¦ä¹ ä¹˜æ³•æ®‹å·®æ ¡æ­£æ¥å¢žå¼ºåŽŸç”Ÿä¼°è®¡å™¨ï¼Œå®žçŽ°ä½Žä¾µå…¥æ€§éƒ¨ç½²ã€‚
3. å®žéªŒæˆ–æ•ˆæžœï¼šåœ¨ä½Žè¿½è¸ªè®¾ç½®ä¸‹ï¼ŒTiCardæ˜¾è‘—é™ä½Žå°¾éƒ¨Q-errorï¼Œå¦‚P90ä»Ž312.85é™è‡³13.69ï¼ŒåŒæ—¶ä¿æŒä¸­ä½æ•°å‡†ç¡®æ€§ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

åŸºæ•°ä¼°è®¡æ˜¯åŸºäºŽæˆæœ¬çš„æŸ¥è¯¢ä¼˜åŒ–çš„å…³é”®ç“¶é¢ˆï¼Œä½†å¯éƒ¨ç½²çš„æ”¹è¿›ä»ç„¶å›°éš¾ï¼šä¼ ç»Ÿä¼°è®¡å™¨å¿½ç•¥äº†ç›¸å…³æ€§ï¼Œè€Œå­¦ä¹ åž‹ä¼°è®¡å™¨é€šå¸¸éœ€è¦ç‰¹å®šäºŽå·¥ä½œè´Ÿè½½çš„è®­ç»ƒæµç¨‹ï¼Œå¹¶éœ€è¦ä¾µå…¥æ€§åœ°é›†æˆåˆ°ä¼˜åŒ–å™¨ä¸­ã€‚æœ¬æ–‡æå‡ºäº†TiCardï¼Œä¸€ä¸ªä½Žä¾µå…¥æ€§ã€åŸºäºŽæ ¡æ­£çš„æ¡†æž¶ï¼Œç”¨äºŽå¢žå¼ºï¼ˆè€Œéžæ›¿æ¢ï¼‰æ•°æ®åº“çš„åŽŸç”Ÿä¼°è®¡å™¨ã€‚TiCardä½¿ç”¨ä»…EXPLAINç‰¹å¾å­¦ä¹ ä¹˜æ³•æ®‹å·®æ ¡æ­£ï¼Œå¹¶ä»…ä½¿ç”¨EXPLAIN ANALYZEè¿›è¡Œç¦»çº¿æ ‡ç­¾ç”Ÿæˆã€‚æˆ‘ä»¬ç ”ç©¶äº†ä¸¤ç§å®žé™…å®žä¾‹åŒ–ï¼šï¼ˆiï¼‰ç”¨äºŽäºšæ¯«ç§’æŽ¨ç†çš„æ¢¯åº¦æå‡å›žå½’å™¨ï¼Œä»¥åŠï¼ˆiiï¼‰TabPFNï¼Œä¸€ç§ä¸Šä¸‹æ–‡è¡¨æ ¼åŸºç¡€æ¨¡åž‹ï¼Œé€šè¿‡åˆ·æ–°å°åž‹å‚è€ƒé›†è¿›è¡Œé€‚åº”ï¼Œæ— éœ€æ¢¯åº¦é‡æ–°è®­ç»ƒã€‚åœ¨TiDBä¸Šä½¿ç”¨TPCHå’ŒJoin Order Benchmarkï¼Œåœ¨ä½Žè¿½è¸ªè®¾ç½®ä¸‹ï¼ˆæ€»å…±263æ¬¡æ‰§è¡Œï¼›157æ¬¡ç”¨äºŽå­¦ä¹ ï¼‰ï¼ŒTiCardæ˜¾è‘—æé«˜äº†ç®—å­çº§åˆ«çš„å°¾éƒ¨å‡†ç¡®æ€§ï¼šP90 Q-errorä»Ž312.85ï¼ˆåŽŸç”Ÿï¼‰é™è‡³13.69ï¼ˆTiCard-GBRï¼‰ï¼ŒP99ä»Ž37,974.37é™è‡³3,416.50ï¼ˆTiCard-TabPFNï¼‰ï¼ŒåŒæ—¶ä»…è¿žæŽ¥ç­–ç•¥ä¿æŒäº†è¿‘ä¹Žå®Œç¾Žçš„ä¸­ä½æ•°è¡Œä¸ºã€‚æˆ‘ä»¬å°†TiCardå®šä½ä¸ºä¸“æ³¨äºŽå¯éƒ¨ç½²æ€§çš„AI4DBæž„å»ºå—ï¼šæ˜Žç¡®çš„èŒƒå›´ã€ä¿å®ˆçš„é›†æˆç­–ç•¥ï¼Œä»¥åŠä»Žç¦»çº¿æ ¡æ­£åˆ°ä¼˜åŒ–å™¨å†…ä½¿ç”¨çš„é›†æˆè·¯çº¿å›¾ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡è§£å†³æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ä¸­åŸºæ•°ä¼°è®¡çš„å‡†ç¡®æ€§é—®é¢˜ã€‚çŽ°æœ‰æ–¹æ³•çš„ç—›ç‚¹åŒ…æ‹¬ï¼šä¼ ç»Ÿä¼°è®¡å™¨ï¼ˆå¦‚ç›´æ–¹å›¾ï¼‰å¿½ç•¥æ•°æ®ç›¸å…³æ€§ï¼Œå¯¼è‡´ä¼°è®¡åå·®ï¼›å­¦ä¹ åž‹ä¼°è®¡å™¨ï¼ˆå¦‚ç¥žç»ç½‘ç»œï¼‰éœ€è¦å¤§é‡æ ‡æ³¨æ•°æ®ã€ç‰¹å®šå·¥ä½œè´Ÿè½½è®­ç»ƒå’Œä¾µå…¥å¼é›†æˆåˆ°ä¼˜åŒ–å™¨ï¼Œéƒ¨ç½²æˆæœ¬é«˜ä¸”ä¸çµæ´»ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡æå‡ºTiCardæ¡†æž¶ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯â€œå¢žå¼ºè€Œéžæ›¿æ¢â€æ•°æ®åº“åŽŸç”Ÿä¼°è®¡å™¨ã€‚é€šè¿‡ä»…ä½¿ç”¨EXPLAINæŸ¥è¯¢è®¡åˆ’ç‰¹å¾ï¼ˆå¦‚ç®—å­ç±»åž‹ã€è°“è¯ä¿¡æ¯ï¼‰å­¦ä¹ ä¹˜æ³•æ®‹å·®æ ¡æ­£ï¼Œå¯¹åŽŸç”Ÿä¼°è®¡å€¼è¿›è¡Œå¾®è°ƒï¼Œä»Žè€Œåœ¨ä¿æŒä½Žä¾µå…¥æ€§çš„åŒæ—¶æé«˜å‡†ç¡®æ€§ã€‚è¿™ç§è®¾è®¡é¿å…äº†å­¦ä¹ åž‹æ–¹æ³•å¯¹åŽŸå§‹æ•°æ®æˆ–å¤æ‚ç‰¹å¾çš„ä¾èµ–ï¼Œç®€åŒ–äº†éƒ¨ç½²æµç¨‹ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“æž¶æž„åˆ†ä¸ºç¦»çº¿å­¦ä¹ å’Œåœ¨çº¿æŽ¨ç†ä¸¤ä¸ªé˜¶æ®µã€‚ç¦»çº¿é˜¶æ®µï¼šä½¿ç”¨EXPLAIN ANALYZEæ‰§è¡ŒæŸ¥è¯¢ï¼Œæ”¶é›†çœŸå®žåŸºæ•°ä½œä¸ºæ ‡ç­¾ï¼Œç»“åˆEXPLAIN-onlyç‰¹å¾ï¼ˆå¦‚æŸ¥è¯¢è®¡åˆ’ç»“æž„ï¼‰è®­ç»ƒæ ¡æ­£æ¨¡åž‹ã€‚åœ¨çº¿é˜¶æ®µï¼šåœ¨æŸ¥è¯¢ä¼˜åŒ–æ—¶ï¼Œä»…ä½¿ç”¨EXPLAINç‰¹å¾è¾“å…¥è®­ç»ƒå¥½çš„æ¨¡åž‹ï¼Œé¢„æµ‹æ®‹å·®æ ¡æ­£å› å­ï¼Œåº”ç”¨äºŽåŽŸç”Ÿä¼°è®¡å€¼å¾—åˆ°æœ€ç»ˆä¼°è®¡ã€‚æ¡†æž¶æ”¯æŒå¤šç§æ¨¡åž‹å®žä¾‹åŒ–ï¼Œå¦‚æ¢¯åº¦æå‡å›žå½’å™¨ï¼ˆGBRï¼‰å’ŒTabPFNåŸºç¡€æ¨¡åž‹ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°æ˜¯â€œEXPLAIN-onlyæ®‹å·®å­¦ä¹ â€ã€‚ä¸ŽçŽ°æœ‰å­¦ä¹ åž‹æ–¹æ³•ç›¸æ¯”ï¼ŒTiCardä»…ä¾èµ–æŸ¥è¯¢è®¡åˆ’ç‰¹å¾ï¼Œæ— éœ€è®¿é—®åŽŸå§‹æ•°æ®æˆ–å¤æ‚ç»Ÿè®¡ä¿¡æ¯ï¼Œé™ä½Žäº†æ•°æ®éšç§å’Œé›†æˆå¤æ‚åº¦ã€‚æœ¬è´¨åŒºåˆ«åœ¨äºŽï¼šå®ƒä½œä¸ºæ ¡æ­£å±‚å åŠ åœ¨åŽŸç”Ÿä¼°è®¡å™¨ä¸Šï¼Œè€Œéžç‹¬ç«‹ä¼°è®¡å™¨ï¼Œå®žçŽ°äº†æ¨¡å—åŒ–å’Œå¯æ’æ‹”æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬ï¼šä½¿ç”¨ä¹˜æ³•æ®‹å·®æ ¡æ­£ï¼ˆå³ä¼°è®¡å€¼ = åŽŸç”Ÿä¼°è®¡å€¼ Ã— æ ¡æ­£å› å­ï¼‰ï¼Œä»¥ä¿æŒä¼°è®¡å°ºåº¦ï¼›æŸå¤±å‡½æ•°åŸºäºŽQ-errorï¼ˆä¼°è®¡å€¼ä¸ŽçœŸå®žå€¼çš„æœ€å¤§æ¯”çŽ‡ï¼‰ä¼˜åŒ–ï¼Œä¸“æ³¨äºŽå°¾éƒ¨å‡†ç¡®æ€§ï¼›æ¨¡åž‹å®žä¾‹åŒ–ä¸­ï¼ŒGBRç”¨äºŽå¿«é€ŸæŽ¨ç†ï¼ˆäºšæ¯«ç§’çº§ï¼‰ï¼ŒTabPFNé€šè¿‡å°å‚è€ƒé›†ï¼ˆå¦‚157ä¸ªæ ·æœ¬ï¼‰è¿›è¡Œä¸Šä¸‹æ–‡é€‚åº”ï¼Œæ— éœ€æ¢¯åº¦é‡è®­ç»ƒï¼Œæé«˜äº†æ ·æœ¬æ•ˆçŽ‡ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

æœ€é‡è¦çš„å®žéªŒç»“æžœåŒ…æ‹¬ï¼šåœ¨TiDBæ•°æ®åº“ä¸Šï¼Œä½¿ç”¨TPCHå’ŒJoin Order Benchmarkæ•°æ®é›†ï¼Œåœ¨ä½Žè¿½è¸ªè®¾ç½®ï¼ˆä»…263æ¬¡æ‰§è¡Œï¼Œ157æ¬¡ç”¨äºŽå­¦ä¹ ï¼‰ä¸‹ï¼ŒTiCardæ˜¾è‘—æå‡äº†ç®—å­çº§åˆ«çš„å°¾éƒ¨å‡†ç¡®æ€§ã€‚å…·ä½“æ€§èƒ½æ•°æ®ï¼šåŽŸç”Ÿä¼°è®¡å™¨çš„P90 Q-errorä¸º312.85ï¼ŒTiCard-GBRå°†å…¶é™è‡³13.69ï¼ˆæå‡çº¦95.6%ï¼‰ï¼›P99 Q-errorä»Ž37,974.37é™è‡³3,416.50ï¼ˆTiCard-TabPFNï¼Œæå‡çº¦91.0%ï¼‰ã€‚åŒæ—¶ï¼Œä»…è¿žæŽ¥ç­–ç•¥ä¿æŒäº†è¿‘ä¹Žå®Œç¾Žçš„ä¸­ä½æ•°è¡Œä¸ºï¼ŒéªŒè¯äº†æ¡†æž¶åœ¨ä¿æŒæ•´ä½“å‡†ç¡®æ€§çš„åŒæ—¶ä¼˜åŒ–å°¾éƒ¨è¯¯å·®çš„æœ‰æ•ˆæ€§ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶ä¸»è¦åº”ç”¨äºŽæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰çš„æŸ¥è¯¢ä¼˜åŒ–é¢†åŸŸï¼Œç‰¹åˆ«æ˜¯åŸºäºŽæˆæœ¬çš„æŸ¥è¯¢ä¼˜åŒ–å™¨ã€‚å®žé™…ä»·å€¼åœ¨äºŽæä¾›äº†ä¸€ç§ä½Žä¾µå…¥æ€§ã€å¯éƒ¨ç½²çš„åŸºæ•°ä¼°è®¡å¢žå¼ºæ–¹æ¡ˆï¼Œé€‚ç”¨äºŽç”Ÿäº§çŽ¯å¢ƒä¸­çš„æ•°æ®åº“ï¼ˆå¦‚TiDBï¼‰ï¼Œèƒ½æ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½è€Œä¸ç ´åçŽ°æœ‰ç³»ç»Ÿæž¶æž„ã€‚æœªæ¥å½±å“å¯èƒ½æŽ¨åŠ¨AI4DBï¼ˆäººå·¥æ™ºèƒ½ç”¨äºŽæ•°æ®åº“ï¼‰çš„å‘å±•ï¼Œä½œä¸ºæž„å»ºå—æ”¯æŒä»Žç¦»çº¿æ ¡æ­£åˆ°åœ¨çº¿ä¼˜åŒ–çš„å¹³æ»‘é›†æˆï¼Œä¿ƒè¿›å­¦ä¹ åž‹æ–¹æ³•åœ¨å®žé™…ç³»ç»Ÿä¸­çš„å¹¿æ³›åº”ç”¨ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Cardinality estimation is a key bottleneck for cost-based query optimization, yet deployable improvements remain difficult: classical estimators miss correlations, while learned estimators often require workload-specific training pipelines and invasive integration into the optimizer. This paper presents TiCard, a low intrusion, correction-based framework that augments (rather than replaces) a database's native estimator. TiCard learns multiplicative residual corrections using EXPLAIN-only features, and uses EXPLAIN ANALYZE only for offline labels. We study two practical instantiations: (i) a Gradient Boosting Regressor for sub-millisecond inference, and (ii) TabPFN, an in-context tabular foundation model that adapts by refreshing a small reference set without gradient retraining. On TiDB with TPCH and the Join Order Benchmark, in a low-trace setting (263 executions total; 157 used for learning), TiCard improves operator-level tail accuracy substantially: P90 Q-error drops from 312.85 (native) to 13.69 (TiCard-GBR), and P99 drops from 37,974.37 to 3,416.50 (TiCard-TabPFN), while a join-only policy preserves near-perfect median behavior. We position TiCard as an AI4DB building block focused on deployability: explicit scope, conservative integration policies, and an integration roadmap from offline correction to in-optimizer use.

