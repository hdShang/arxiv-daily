---
layout: default
title: TiCard: Deployable EXPLAIN-only Residual Learning for Cardinality Estimation
---

# TiCard: Deployable EXPLAIN-only Residual Learning for Cardinality Estimation

**arXiv**: [2512.14358v1](https://arxiv.org/abs/2512.14358) | [PDF](https://arxiv.org/pdf/2512.14358.pdf)

**ä½œè€…**: Qizhi Wang

**åˆ†ç±»**: cs.AI, cs.DB

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: 16 pages(/wo references), 4 figures, 10 tables

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºTiCardæ¡†æž¶ï¼Œé€šè¿‡ä»…ä½¿ç”¨EXPLAINç‰¹å¾çš„æ®‹å·®å­¦ä¹ å¢žå¼ºæ•°æ®åº“åŸºæ•°ä¼°è®¡ï¼Œè§£å†³ä¼ ç»Ÿæ–¹æ³•å¿½ç•¥ç›¸å…³æ€§å’Œå­¦ä¹ æ¨¡åž‹éƒ¨ç½²å›°éš¾çš„é—®é¢˜ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **è§†è§‰é‡Œç¨‹è®¡**

**å…³é”®è¯**: `åŸºæ•°ä¼°è®¡` `æŸ¥è¯¢ä¼˜åŒ–` `æ®‹å·®å­¦ä¹ ` `æ•°æ®åº“å¢žå¼º` `å¯éƒ¨ç½²AI` `æ¢¯åº¦æå‡å›žå½’å™¨` `è¡¨æ ¼åŸºç¡€æ¨¡åž‹` `ä½Žä¾µå…¥æ€§é›†æˆ`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. æ ¸å¿ƒé—®é¢˜ï¼šä¼ ç»ŸåŸºæ•°ä¼°è®¡å™¨å¿½ç•¥æ•°æ®ç›¸å…³æ€§ï¼Œè€Œå­¦ä¹ åž‹ä¼°è®¡å™¨éƒ¨ç½²å›°éš¾ï¼Œéœ€è¦ä¾µå…¥æ€§é›†æˆå’Œç‰¹å®šå·¥ä½œè´Ÿè½½è®­ç»ƒã€‚
2. æ–¹æ³•è¦ç‚¹ï¼šæå‡ºTiCardæ¡†æž¶ï¼Œé€šè¿‡ä»…ä½¿ç”¨EXPLAINç‰¹å¾å­¦ä¹ ä¹˜æ³•æ®‹å·®æ ¡æ­£æ¥å¢žå¼ºæ•°æ®åº“åŽŸç”Ÿä¼°è®¡å™¨ï¼Œå®žçŽ°ä½Žä¾µå…¥æ€§éƒ¨ç½²ã€‚
3. å®žéªŒæˆ–æ•ˆæžœï¼šåœ¨ä½Žè·Ÿè¸ªè®¾ç½®ä¸‹ï¼ŒTiCardæ˜¾è‘—æå‡å°¾éƒ¨å‡†ç¡®æ€§ï¼ŒP90 Q-errorä»Ž312.85é™è‡³13.69ï¼ŒP99ä»Ž37,974.37é™è‡³3,416.50ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

åŸºæ•°ä¼°è®¡æ˜¯åŸºäºŽæˆæœ¬çš„æŸ¥è¯¢ä¼˜åŒ–çš„å…³é”®ç“¶é¢ˆï¼Œä½†å¯éƒ¨ç½²çš„æ”¹è¿›ä»ç„¶å›°éš¾ï¼šä¼ ç»Ÿä¼°è®¡å™¨å¿½ç•¥äº†ç›¸å…³æ€§ï¼Œè€Œå­¦ä¹ åž‹ä¼°è®¡å™¨é€šå¸¸éœ€è¦ç‰¹å®šäºŽå·¥ä½œè´Ÿè½½çš„è®­ç»ƒæµç¨‹å¹¶ä¾µå…¥æ€§åœ°é›†æˆåˆ°ä¼˜åŒ–å™¨ä¸­ã€‚æœ¬æ–‡æå‡ºäº†TiCardï¼Œè¿™æ˜¯ä¸€ä¸ªä½Žä¾µå…¥æ€§ã€åŸºäºŽæ ¡æ­£çš„æ¡†æž¶ï¼Œç”¨äºŽå¢žå¼ºï¼ˆè€Œéžæ›¿æ¢ï¼‰æ•°æ®åº“çš„åŽŸç”Ÿä¼°è®¡å™¨ã€‚TiCardä½¿ç”¨ä»…EXPLAINç‰¹å¾å­¦ä¹ ä¹˜æ³•æ®‹å·®æ ¡æ­£ï¼Œå¹¶ä¸”ä»…å°†EXPLAIN ANALYZEç”¨äºŽç¦»çº¿æ ‡ç­¾ã€‚æˆ‘ä»¬ç ”ç©¶äº†ä¸¤ç§å®žé™…å®žä¾‹åŒ–ï¼šï¼ˆiï¼‰ç”¨äºŽäºšæ¯«ç§’æŽ¨ç†çš„æ¢¯åº¦æå‡å›žå½’å™¨ï¼Œä»¥åŠï¼ˆiiï¼‰TabPFNï¼Œä¸€ç§ä¸Šä¸‹æ–‡è¡¨æ ¼åŸºç¡€æ¨¡åž‹ï¼Œé€šè¿‡åˆ·æ–°å°åž‹å‚è€ƒé›†è€Œæ— éœ€æ¢¯åº¦é‡æ–°è®­ç»ƒæ¥é€‚åº”ã€‚åœ¨TiDBä¸Šä½¿ç”¨TPCHå’Œè¿žæŽ¥é¡ºåºåŸºå‡†æµ‹è¯•ï¼Œåœ¨ä½Žè·Ÿè¸ªè®¾ç½®ï¼ˆæ€»å…±263æ¬¡æ‰§è¡Œï¼›157æ¬¡ç”¨äºŽå­¦ä¹ ï¼‰ä¸­ï¼ŒTiCardæ˜¾è‘—æé«˜äº†ç®—å­çº§åˆ«çš„å°¾éƒ¨å‡†ç¡®æ€§ï¼šP90 Q-errorä»Ž312.85ï¼ˆåŽŸç”Ÿï¼‰é™è‡³13.69ï¼ˆTiCard-GBRï¼‰ï¼ŒP99ä»Ž37,974.37é™è‡³3,416.50ï¼ˆTiCard-TabPFNï¼‰ï¼Œè€Œä»…è¿žæŽ¥ç­–ç•¥ä¿æŒäº†è¿‘ä¹Žå®Œç¾Žçš„ä¸­ä½æ•°è¡Œä¸ºã€‚æˆ‘ä»¬å°†TiCardå®šä½ä¸ºä¸“æ³¨äºŽå¯éƒ¨ç½²æ€§çš„AI4DBæž„å»ºå—ï¼šæ˜Žç¡®çš„èŒƒå›´ã€ä¿å®ˆçš„é›†æˆç­–ç•¥ä»¥åŠä»Žç¦»çº¿æ ¡æ­£åˆ°ä¼˜åŒ–å™¨å†…ä½¿ç”¨çš„é›†æˆè·¯çº¿å›¾ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡è§£å†³æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–ä¸­åŸºæ•°ä¼°è®¡çš„å‡†ç¡®æ€§é—®é¢˜ã€‚çŽ°æœ‰æ–¹æ³•çš„ç—›ç‚¹åœ¨äºŽï¼šä¼ ç»Ÿä¼°è®¡å™¨ï¼ˆå¦‚ç›´æ–¹å›¾ï¼‰æ— æ³•æ•æ‰æ•°æ®ç›¸å…³æ€§ï¼Œå¯¼è‡´ä¼°è®¡åå·®ï¼›è€Œå­¦ä¹ åž‹ä¼°è®¡å™¨ï¼ˆå¦‚ç¥žç»ç½‘ç»œï¼‰è™½ç„¶èƒ½å»ºæ¨¡å¤æ‚å…³ç³»ï¼Œä½†é€šå¸¸éœ€è¦å¤§é‡è®­ç»ƒæ•°æ®ã€ç‰¹å®šå·¥ä½œè´Ÿè½½çš„å®šåˆ¶åŒ–æµç¨‹ï¼Œå¹¶ä¸”é›†æˆåˆ°æ•°æ®åº“ä¼˜åŒ–å™¨ä¸­æ—¶ä¾µå…¥æ€§å¼ºï¼Œéš¾ä»¥å®žé™…éƒ¨ç½²ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡æå‡ºTiCardæ¡†æž¶ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œå¢žå¼ºè€Œéžæ›¿æ¢â€æ•°æ®åº“çš„åŽŸç”Ÿä¼°è®¡å™¨ã€‚é€šè¿‡ä»…ä½¿ç”¨EXPLAINå‘½ä»¤æå–çš„ç‰¹å¾ï¼ˆå¦‚ç®—å­ç±»åž‹ã€è°“è¯ä¿¡æ¯ç­‰ï¼‰ï¼Œå­¦ä¹ ä¸€ä¸ªä¹˜æ³•æ®‹å·®æ ¡æ­£å› å­ï¼Œå¯¹åŽŸç”Ÿä¼°è®¡å€¼è¿›è¡Œæ ¡æ­£ï¼Œä»Žè€Œåœ¨ä¿æŒä½Žä¾µå…¥æ€§çš„åŒæ—¶æå‡ä¼°è®¡å‡†ç¡®æ€§ã€‚è¿™ç§è®¾è®¡é¿å…äº†å®Œå…¨æ›¿æ¢ä¼°è®¡å™¨å¸¦æ¥çš„å¤æ‚é›†æˆé—®é¢˜ï¼Œå¹¶åˆ©ç”¨EXPLAIN ANALYZEçš„ç¦»çº¿æ‰§è¡Œç»“æžœä½œä¸ºç›‘ç£æ ‡ç­¾ï¼Œå‡å°‘åœ¨çº¿å¼€é”€ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“æž¶æž„åˆ†ä¸ºç¦»çº¿å­¦ä¹ å’Œåœ¨çº¿æŽ¨ç†ä¸¤ä¸ªé˜¶æ®µã€‚ç¦»çº¿é˜¶æ®µï¼šä½¿ç”¨EXPLAIN ANALYZEæ‰§è¡ŒæŸ¥è¯¢ï¼Œæ”¶é›†çœŸå®žåŸºæ•°ä½œä¸ºæ ‡ç­¾ï¼›åŒæ—¶ï¼Œä»…ä½¿ç”¨EXPLAINæå–ç‰¹å¾ï¼ˆä¸æ‰§è¡ŒæŸ¥è¯¢ï¼‰ã€‚åŸºäºŽè¿™äº›ç‰¹å¾å’Œæ ‡ç­¾ï¼Œè®­ç»ƒæ®‹å·®æ ¡æ­£æ¨¡åž‹ã€‚åœ¨çº¿é˜¶æ®µï¼šå¯¹äºŽæ–°æŸ¥è¯¢ï¼Œä»…è¿è¡ŒEXPLAINèŽ·å–ç‰¹å¾ï¼Œè¾“å…¥è®­ç»ƒå¥½çš„æ¨¡åž‹é¢„æµ‹æ ¡æ­£å› å­ï¼Œç„¶åŽä¹˜ä»¥åŽŸç”Ÿä¼°è®¡å€¼å¾—åˆ°æœ€ç»ˆä¼°è®¡ã€‚æ¡†æž¶æ”¯æŒå¤šç§æ¨¡åž‹å®žä¾‹åŒ–ï¼Œå¦‚æ¢¯åº¦æå‡å›žå½’å™¨ï¼ˆGBRï¼‰å’ŒTabPFNã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°æ˜¯â€œä»…EXPLAINç‰¹å¾â€çš„æ®‹å·®å­¦ä¹ æœºåˆ¶ã€‚ä¸ŽçŽ°æœ‰å­¦ä¹ åž‹ä¼°è®¡å™¨ç›¸æ¯”ï¼ŒTiCardçš„æœ¬è´¨åŒºåˆ«åœ¨äºŽï¼š1ï¼‰ä½Žä¾µå…¥æ€§ï¼šä»…ä¾èµ–æ•°æ®åº“æ ‡å‡†æŽ¥å£ï¼ˆEXPLAINï¼‰ï¼Œæ— éœ€ä¿®æ”¹ä¼˜åŒ–å™¨å†…æ ¸ï¼›2ï¼‰é€šç”¨æ€§ï¼šé€šè¿‡æ®‹å·®æ ¡æ­£é€‚åº”ä¸åŒæ•°æ®åº“çš„åŽŸç”Ÿä¼°è®¡å™¨ï¼Œè€Œéžæž„å»ºç«¯åˆ°ç«¯æ¨¡åž‹ï¼›3ï¼‰é«˜æ•ˆæ€§ï¼šç¦»çº¿æ ‡ç­¾æ”¶é›†å’Œåœ¨çº¿ç‰¹å¾æå–éƒ½åŸºäºŽè½»é‡çº§æ“ä½œï¼Œå‡å°‘æ€§èƒ½å¼€é”€ã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1ï¼‰ç‰¹å¾å·¥ç¨‹ï¼šä»…ä»ŽEXPLAINè¾“å‡ºä¸­æå–ç»“æž„åŒ–ç‰¹å¾ï¼Œå¦‚ç®—å­ç±»åž‹ã€è¡¨åã€è°“è¯æ¡ä»¶ç­‰ï¼Œé¿å…ä¾èµ–åŽŸå§‹æ•°æ®æˆ–ç»Ÿè®¡ä¿¡æ¯ï¼›2ï¼‰æŸå¤±å‡½æ•°ï¼šä½¿ç”¨Q-errorï¼ˆä¼°è®¡å€¼ä¸ŽçœŸå®žå€¼çš„æœ€å¤§æ¯”çŽ‡ï¼‰ä½œä¸ºä¼˜åŒ–ç›®æ ‡ï¼Œé‡ç‚¹å…³æ³¨å°¾éƒ¨å‡†ç¡®æ€§ï¼›3ï¼‰æ¨¡åž‹é€‰æ‹©ï¼šå®žä¾‹åŒ–ä¸¤ç§æ¨¡åž‹â€”â€”æ¢¯åº¦æå‡å›žå½’å™¨ï¼ˆGBRï¼‰ç”¨äºŽäºšæ¯«ç§’çº§å¿«é€ŸæŽ¨ç†ï¼ŒTabPFNï¼ˆä¸€ç§è¡¨æ ¼åŸºç¡€æ¨¡åž‹ï¼‰é€šè¿‡å°æ ·æœ¬å‚è€ƒé›†è‡ªé€‚åº”ï¼Œæ— éœ€æ¢¯åº¦é‡æ–°è®­ç»ƒï¼›4ï¼‰éƒ¨ç½²ç­–ç•¥ï¼šå®šä¹‰æ˜Žç¡®çš„èŒƒå›´ï¼ˆå¦‚ä»…æ ¡æ­£è¿žæŽ¥æ“ä½œï¼‰å’Œä¿å®ˆé›†æˆæ”¿ç­–ï¼Œç¡®ä¿ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

åœ¨TiDBæ•°æ®åº“ä¸Šï¼Œä½¿ç”¨TPCHå’ŒJoin Order Benchmarkè¿›è¡Œå®žéªŒï¼Œåœ¨ä½Žè·Ÿè¸ªè®¾ç½®ï¼ˆä»…263æ¬¡æ‰§è¡Œï¼Œå…¶ä¸­157æ¬¡ç”¨äºŽå­¦ä¹ ï¼‰ä¸‹ï¼ŒTiCardæ˜¾è‘—æå‡äº†ç®—å­çº§åˆ«çš„å°¾éƒ¨å‡†ç¡®æ€§ã€‚å…·ä½“ç»“æžœï¼šåŽŸç”Ÿä¼°è®¡å™¨çš„P90 Q-errorä¸º312.85ï¼ŒTiCard-GBRå°†å…¶é™è‡³13.69ï¼ˆæå‡çº¦22å€ï¼‰ï¼›P99 Q-errorä»Ž37,974.37é™è‡³3,416.50ï¼ˆTiCard-TabPFNï¼Œæå‡çº¦11å€ï¼‰ã€‚åŒæ—¶ï¼Œé€šè¿‡ä»…è¿žæŽ¥ç­–ç•¥ï¼Œä¿æŒäº†è¿‘ä¹Žå®Œç¾Žçš„ä¸­ä½æ•°ä¼°è®¡è¡Œä¸ºï¼ŒéªŒè¯äº†æ¡†æž¶çš„æœ‰æ•ˆæ€§å’Œå¯éƒ¨ç½²æ€§ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶ä¸»è¦åº”ç”¨äºŽæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰çš„æŸ¥è¯¢ä¼˜åŒ–é¢†åŸŸï¼Œç‰¹åˆ«æ˜¯åŸºæ•°ä¼°è®¡æ¨¡å—ã€‚å…¶å®žé™…ä»·å€¼åœ¨äºŽæä¾›äº†ä¸€ç§å¯éƒ¨ç½²çš„AIå¢žå¼ºæ–¹æ¡ˆï¼Œèƒ½å¤Ÿåœ¨ä¸æ˜¾è‘—æ”¹åŠ¨æ•°æ®åº“å†…æ ¸çš„æƒ…å†µä¸‹ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–æ•ˆæžœã€‚æœªæ¥å½±å“åŒ…æ‹¬ï¼šä½œä¸ºAI4DBï¼ˆäººå·¥æ™ºèƒ½ç”¨äºŽæ•°æ®åº“ï¼‰çš„å…³é”®æž„å»ºå—ï¼ŒæŽ¨åŠ¨å­¦ä¹ åž‹æ–¹æ³•åœ¨å·¥ä¸šçº§æ•°æ®åº“ä¸­çš„è½åœ°ï¼Œä»Žç¦»çº¿æ ¡æ­£é€æ­¥æ‰©å±•åˆ°åœ¨çº¿ä¼˜åŒ–å™¨é›†æˆï¼Œé€‚ç”¨äºŽäº‘æ•°æ®åº“ã€å¤§æ•°æ®åˆ†æžç­‰åœºæ™¯ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Cardinality estimation is a key bottleneck for cost-based query optimization, yet deployable improvements remain difficult: classical estimators miss correlations, while learned estimators often require workload-specific training pipelines and invasive integration into the optimizer. This paper presents TiCard, a low intrusion, correction-based framework that augments (rather than replaces) a database's native estimator. TiCard learns multiplicative residual corrections using EXPLAIN-only features, and uses EXPLAIN ANALYZE only for offline labels. We study two practical instantiations: (i) a Gradient Boosting Regressor for sub-millisecond inference, and (ii) TabPFN, an in-context tabular foundation model that adapts by refreshing a small reference set without gradient retraining. On TiDB with TPCH and the Join Order Benchmark, in a low-trace setting (263 executions total; 157 used for learning), TiCard improves operator-level tail accuracy substantially: P90 Q-error drops from 312.85 (native) to 13.69 (TiCard-GBR), and P99 drops from 37,974.37 to 3,416.50 (TiCard-TabPFN), while a join-only policy preserves near-perfect median behavior. We position TiCard as an AI4DB building block focused on deployability: explicit scope, conservative integration policies, and an integration roadmap from offline correction to in-optimizer use.

