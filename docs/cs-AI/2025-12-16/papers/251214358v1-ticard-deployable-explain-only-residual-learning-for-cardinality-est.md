---
layout: default
title: TiCard: Deployable EXPLAIN-only Residual Learning for Cardinality Estimation
---

# TiCard: Deployable EXPLAIN-only Residual Learning for Cardinality Estimation

**arXiv**: [2512.14358v1](https://arxiv.org/abs/2512.14358) | [PDF](https://arxiv.org/pdf/2512.14358.pdf)

**ä½œè€…**: Qizhi Wang

**åˆ†ç±»**: cs.AI, cs.DB

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: 16 pages(/wo references), 4 figures, 10 tables

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**TiCardï¼šä¸€ç§å¯éƒ¨ç½²çš„ã€ä»…ä½¿ç”¨EXPLAINä¿¡æ¯çš„åŸºæ•°ä¼°è®¡æ®‹å·®å­¦ä¹ æ¡†æž¶**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **3Dæ„ŸçŸ¥ä¸ŽçŠ¶æ€ä¼°è®¡ (Perception & State Est)**

**å…³é”®è¯**: `åŸºæ•°ä¼°è®¡` `æŸ¥è¯¢ä¼˜åŒ–` `æ®‹å·®å­¦ä¹ ` `æ•°æ®åº“ç³»ç»Ÿ` `AI4DB` `å¯éƒ¨ç½²æ€§` `EXPLAINä¿¡æ¯`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰åŸºæ•°ä¼°è®¡å™¨éš¾ä»¥å…¼é¡¾å‡†ç¡®æ€§å’Œå¯éƒ¨ç½²æ€§ï¼Œä¼ ç»Ÿæ–¹æ³•å¿½ç•¥ç›¸å…³æ€§ï¼Œå­¦ä¹ æ–¹æ³•åˆ™éœ€å®šåˆ¶è®­ç»ƒå’Œæ·±åº¦é›†æˆã€‚
2. TiCardé€šè¿‡å­¦ä¹ æ®‹å·®æ ¡æ­£æ¥å¢žå¼ºåŽŸç”Ÿä¼°è®¡å™¨ï¼Œä»…ä¾èµ–EXPLAINä¿¡æ¯ï¼Œé™ä½Žäº†ä¾µå…¥æ€§ï¼Œæå‡äº†éƒ¨ç½²ä¾¿æ·æ€§ã€‚
3. å®žéªŒè¡¨æ˜Žï¼ŒTiCardåœ¨TPCHå’ŒJoin Order Benchmarkä¸Šæ˜¾è‘—æå‡äº†å°¾éƒ¨ç²¾åº¦ï¼ŒP90å’ŒP99 Q-errorå‡å¤§å¹…é™ä½Žã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

åŸºæ•°ä¼°è®¡æ˜¯åŸºäºŽä»£ä»·çš„æŸ¥è¯¢ä¼˜åŒ–çš„å…³é”®ç“¶é¢ˆï¼Œä½†å¯éƒ¨ç½²çš„æ”¹è¿›ä»ç„¶å›°éš¾ï¼šä¼ ç»Ÿä¼°è®¡å™¨ä¼šé—æ¼ç›¸å…³æ€§ï¼Œè€Œå­¦ä¹ çš„ä¼°è®¡å™¨é€šå¸¸éœ€è¦ç‰¹å®šäºŽå·¥ä½œè´Ÿè½½çš„è®­ç»ƒæµç¨‹å’Œä¾µå…¥å¼åœ°é›†æˆåˆ°ä¼˜åŒ–å™¨ä¸­ã€‚æœ¬æ–‡æå‡ºäº†TiCardï¼Œä¸€ä¸ªä½Žä¾µå…¥ã€åŸºäºŽæ ¡æ­£çš„æ¡†æž¶ï¼Œå®ƒå¢žå¼ºï¼ˆè€Œä¸æ˜¯æ›¿æ¢ï¼‰æ•°æ®åº“çš„åŽŸç”Ÿä¼°è®¡å™¨ã€‚TiCardä½¿ç”¨ä»…æ¥è‡ªEXPLAINçš„ç‰¹å¾å­¦ä¹ ä¹˜æ³•æ®‹å·®æ ¡æ­£ï¼Œå¹¶ä¸”ä»…ä½¿ç”¨EXPLAIN ANALYZEè¿›è¡Œç¦»çº¿æ ‡ç­¾ç”Ÿæˆã€‚æˆ‘ä»¬ç ”ç©¶äº†ä¸¤ç§å®žé™…çš„å®žä¾‹åŒ–ï¼šï¼ˆiï¼‰ç”¨äºŽäºšæ¯«ç§’çº§æŽ¨ç†çš„æ¢¯åº¦æå‡å›žå½’å™¨ï¼Œä»¥åŠï¼ˆiiï¼‰TabPFNï¼Œä¸€ç§ä¸Šä¸‹æ–‡è¡¨æ ¼åŸºç¡€æ¨¡åž‹ï¼Œå®ƒé€šè¿‡åˆ·æ–°ä¸€ä¸ªå°çš„å‚è€ƒé›†æ¥é€‚åº”ï¼Œè€Œæ— éœ€æ¢¯åº¦é‡æ–°è®­ç»ƒã€‚åœ¨ä½¿ç”¨TPCHå’ŒJoin Order Benchmarkçš„TiDBä¸Šï¼Œåœ¨ä½Žè·Ÿè¸ªè®¾ç½®ï¼ˆæ€»å…±263æ¬¡æ‰§è¡Œï¼›157æ¬¡ç”¨äºŽå­¦ä¹ ï¼‰ä¸­ï¼ŒTiCardæ˜¾è‘—æé«˜äº†ç®—å­çº§åˆ«çš„å°¾éƒ¨ç²¾åº¦ï¼šP90 Q-errorä»Ž312.85ï¼ˆåŽŸç”Ÿï¼‰é™è‡³13.69ï¼ˆTiCard-GBRï¼‰ï¼ŒP99ä»Ž37,974.37é™è‡³3,416.50ï¼ˆTiCard-TabPFNï¼‰ï¼Œè€Œä»…è¿žæŽ¥ç­–ç•¥ä¿æŒäº†è¿‘ä¹Žå®Œç¾Žçš„ä¸­é—´å€¼è¡Œä¸ºã€‚æˆ‘ä»¬å°†TiCardå®šä½ä¸ºä¸€ç§ä¸“æ³¨äºŽå¯éƒ¨ç½²æ€§çš„AI4DBæž„å»ºå—ï¼šæ˜Žç¡®çš„èŒƒå›´ã€ä¿å®ˆçš„é›†æˆç­–ç•¥ä»¥åŠä»Žç¦»çº¿æ ¡æ­£åˆ°ä¼˜åŒ–å™¨å†…ä½¿ç”¨çš„é›†æˆè·¯çº¿å›¾ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šåŸºæ•°ä¼°è®¡æ˜¯æŸ¥è¯¢ä¼˜åŒ–çš„æ ¸å¿ƒï¼Œä½†çŽ°æœ‰æ–¹æ³•å­˜åœ¨å‡†ç¡®æ€§å’Œå¯éƒ¨ç½²æ€§ä¹‹é—´çš„çŸ›ç›¾ã€‚ä¼ ç»Ÿä¼°è®¡å™¨æ— æ³•æ•æ‰å¤æ‚çš„ç›¸å…³æ€§ï¼Œå¯¼è‡´ä¼°è®¡åå·®ï¼›è€ŒåŸºäºŽæœºå™¨å­¦ä¹ çš„ä¼°è®¡å™¨é€šå¸¸éœ€è¦é’ˆå¯¹ç‰¹å®šå·¥ä½œè´Ÿè½½è¿›è¡Œè®­ç»ƒï¼Œå¹¶ä¸”éœ€è¦ä¾µå…¥å¼åœ°é›†æˆåˆ°æ•°æ®åº“ä¼˜åŒ–å™¨ä¸­ï¼Œå¢žåŠ äº†éƒ¨ç½²å’Œç»´æŠ¤çš„æˆæœ¬ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šTiCardçš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨æœºå™¨å­¦ä¹ æ¨¡åž‹å­¦ä¹ åŽŸç”Ÿä¼°è®¡å™¨çš„æ®‹å·®ï¼Œå³åŽŸç”Ÿä¼°è®¡å™¨ä¸ŽçœŸå®žåŸºæ•°ä¹‹é—´çš„å·®å¼‚ã€‚é€šè¿‡é¢„æµ‹æ®‹å·®ï¼ŒTiCardå¯ä»¥æ ¡æ­£åŽŸç”Ÿä¼°è®¡å™¨çš„åå·®ï¼Œä»Žè€Œæé«˜åŸºæ•°ä¼°è®¡çš„å‡†ç¡®æ€§ã€‚åŒæ—¶ï¼ŒTiCardçš„è®¾è®¡ç›®æ ‡æ˜¯ä½Žä¾µå…¥æ€§ï¼Œå°½é‡å‡å°‘å¯¹çŽ°æœ‰æ•°æ®åº“ç³»ç»Ÿçš„ä¿®æ”¹ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šTiCardçš„æ•´ä½“æ¡†æž¶åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªä¸»è¦é˜¶æ®µï¼š1) æ•°æ®æ”¶é›†ï¼šé€šè¿‡EXPLAINå‘½ä»¤èŽ·å–æŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’å’Œç›¸å…³ç‰¹å¾ã€‚2) æ ‡ç­¾ç”Ÿæˆï¼šä½¿ç”¨EXPLAIN ANALYZEå‘½ä»¤èŽ·å–çœŸå®žçš„åŸºæ•°ä½œä¸ºæ ‡ç­¾ã€‚3) æ¨¡åž‹è®­ç»ƒï¼šä½¿ç”¨æ”¶é›†åˆ°çš„æ•°æ®è®­ç»ƒæ®‹å·®é¢„æµ‹æ¨¡åž‹ã€‚4) åœ¨çº¿é¢„æµ‹ï¼šåœ¨æŸ¥è¯¢ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨EXPLAINå‘½ä»¤èŽ·å–æŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’å’Œç›¸å…³ç‰¹å¾ï¼Œç„¶åŽä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡åž‹é¢„æµ‹æ®‹å·®ï¼Œå¹¶å°†å…¶åº”ç”¨äºŽåŽŸç”Ÿä¼°è®¡å™¨çš„ç»“æžœï¼Œå¾—åˆ°æœ€ç»ˆçš„åŸºæ•°ä¼°è®¡ã€‚

**å…³é”®åˆ›æ–°**ï¼šTiCardçš„å…³é”®åˆ›æ–°åœ¨äºŽå…¶ä½Žä¾µå…¥æ€§çš„è®¾è®¡å’Œå¯¹EXPLAINä¿¡æ¯çš„å·§å¦™åˆ©ç”¨ã€‚é€šè¿‡ä»…ä½¿ç”¨EXPLAINå‘½ä»¤èŽ·å–ç‰¹å¾ï¼ŒTiCardé¿å…äº†å¯¹æ•°æ®åº“å†…æ ¸çš„ä¿®æ”¹ï¼Œé™ä½Žäº†éƒ¨ç½²çš„å¤æ‚æ€§ã€‚æ­¤å¤–ï¼ŒTiCardè¿˜æŽ¢ç´¢äº†ä¸¤ç§ä¸åŒçš„æ¨¡åž‹å®žä¾‹åŒ–ï¼šæ¢¯åº¦æå‡å›žå½’å™¨ï¼ˆGBRï¼‰å’ŒTabPFNï¼Œä»¥æ»¡è¶³ä¸åŒçš„æ€§èƒ½å’Œéƒ¨ç½²éœ€æ±‚ã€‚

**å…³é”®è®¾è®¡**ï¼šTiCardçš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ç‰¹å¾é€‰æ‹©ï¼šé€‰æ‹©ä¸ŽåŸºæ•°ä¼°è®¡ç›¸å…³çš„EXPLAINä¿¡æ¯ä½œä¸ºç‰¹å¾ï¼Œä¾‹å¦‚ç®—å­ç±»åž‹ã€è°“è¯ç­‰ã€‚2) æ¨¡åž‹é€‰æ‹©ï¼šæ ¹æ®æ€§èƒ½å’Œéƒ¨ç½²éœ€æ±‚é€‰æ‹©åˆé€‚çš„æœºå™¨å­¦ä¹ æ¨¡åž‹ï¼Œä¾‹å¦‚GBRæˆ–TabPFNã€‚3) è®­ç»ƒç­–ç•¥ï¼šé‡‡ç”¨ç¦»çº¿è®­ç»ƒçš„æ–¹å¼ï¼Œä½¿ç”¨EXPLAIN ANALYZEå‘½ä»¤èŽ·å–çš„çœŸå®žåŸºæ•°ä½œä¸ºæ ‡ç­¾ã€‚4) é›†æˆç­–ç•¥ï¼šå°†é¢„æµ‹çš„æ®‹å·®ä»¥ä¹˜æ³•çš„æ–¹å¼åº”ç”¨äºŽåŽŸç”Ÿä¼°è®¡å™¨çš„ç»“æžœï¼Œä»¥ä¿è¯ä¼°è®¡ç»“æžœçš„åˆç†æ€§ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

TiCardåœ¨TiDBæ•°æ®åº“ä¸Šè¿›è¡Œäº†å®žéªŒï¼Œä½¿ç”¨TPCHå’ŒJoin Order Benchmarkæ•°æ®é›†ã€‚å®žéªŒç»“æžœè¡¨æ˜Žï¼ŒTiCardæ˜¾è‘—æé«˜äº†ç®—å­çº§åˆ«çš„å°¾éƒ¨ç²¾åº¦ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨æ¢¯åº¦æå‡å›žå½’å™¨ï¼ˆTiCard-GBRï¼‰æ—¶ï¼ŒP90 Q-errorä»ŽåŽŸç”Ÿä¼°è®¡å™¨çš„312.85é™è‡³13.69ï¼›ä½¿ç”¨TabPFNï¼ˆTiCard-TabPFNï¼‰æ—¶ï¼ŒP99 Q-errorä»Ž37,974.37é™è‡³3,416.50ã€‚è¿™äº›ç»“æžœè¡¨æ˜Žï¼ŒTiCardèƒ½å¤Ÿæœ‰æ•ˆåœ°æ ¡æ­£åŽŸç”Ÿä¼°è®¡å™¨çš„åå·®ï¼Œæé«˜åŸºæ•°ä¼°è®¡çš„å‡†ç¡®æ€§ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

TiCardå¯åº”ç”¨äºŽå„ç§éœ€è¦ç²¾ç¡®åŸºæ•°ä¼°è®¡çš„æ•°æ®åº“ç³»ç»Ÿï¼Œä¾‹å¦‚OLTPå’ŒOLAPæ•°æ®åº“ã€‚é€šè¿‡æé«˜åŸºæ•°ä¼°è®¡çš„å‡†ç¡®æ€§ï¼ŒTiCardå¯ä»¥å¸®åŠ©æŸ¥è¯¢ä¼˜åŒ–å™¨é€‰æ‹©æ›´ä¼˜çš„æ‰§è¡Œè®¡åˆ’ï¼Œä»Žè€Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚æ­¤å¤–ï¼ŒTiCardçš„ä½Žä¾µå…¥æ€§è®¾è®¡ä½¿å…¶æ˜“äºŽéƒ¨ç½²å’Œé›†æˆï¼Œé™ä½Žäº†ç»´æŠ¤æˆæœ¬ã€‚æœªæ¥ï¼ŒTiCardå¯ä»¥è¿›ä¸€æ­¥æ‰©å±•åˆ°æ”¯æŒæ›´å¤æ‚çš„æŸ¥è¯¢å’Œå·¥ä½œè´Ÿè½½ï¼Œå¹¶ä¸Žå…¶ä»–AI4DBæŠ€æœ¯ç›¸ç»“åˆï¼Œæž„å»ºæ›´æ™ºèƒ½çš„æ•°æ®åº“ç³»ç»Ÿã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Cardinality estimation is a key bottleneck for cost-based query optimization, yet deployable improvements remain difficult: classical estimators miss correlations, while learned estimators often require workload-specific training pipelines and invasive integration into the optimizer. This paper presents TiCard, a low intrusion, correction-based framework that augments (rather than replaces) a database's native estimator. TiCard learns multiplicative residual corrections using EXPLAIN-only features, and uses EXPLAIN ANALYZE only for offline labels. We study two practical instantiations: (i) a Gradient Boosting Regressor for sub-millisecond inference, and (ii) TabPFN, an in-context tabular foundation model that adapts by refreshing a small reference set without gradient retraining. On TiDB with TPCH and the Join Order Benchmark, in a low-trace setting (263 executions total; 157 used for learning), TiCard improves operator-level tail accuracy substantially: P90 Q-error drops from 312.85 (native) to 13.69 (TiCard-GBR), and P99 drops from 37,974.37 to 3,416.50 (TiCard-TabPFN), while a join-only policy preserves near-perfect median behavior. We position TiCard as an AI4DB building block focused on deployability: explicit scope, conservative integration policies, and an integration roadmap from offline correction to in-optimizer use.

