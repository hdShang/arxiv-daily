---
layout: default
title: Model-Based Reinforcement Learning in Discrete-Action Non-Markovian Reward Decision Processes
---

# Model-Based Reinforcement Learning in Discrete-Action Non-Markovian Reward Decision Processes

**arXiv**: [2512.14617v1](https://arxiv.org/abs/2512.14617) | [PDF](https://arxiv.org/pdf/2512.14617.pdf)

**ä½œè€…**: Alessandro Trapasso, Luca Iocchi, Fabio Patrizi

**åˆ†ç±»**: cs.LG, cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: 19 pages, 32 figures, includes appendix

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºQR-MAXç®—æ³•ä»¥è§£å†³ç¦»æ•£åŠ¨ä½œéžé©¬å°”å¯å¤«å¥–åŠ±å†³ç­–è¿‡ç¨‹ä¸­çš„æ ·æœ¬æ•ˆçŽ‡å’Œæœ€ä¼˜æ€§ä¿è¯é—®é¢˜**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **è§†è§‰é‡Œç¨‹è®¡** **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `éžé©¬å°”å¯å¤«å¥–åŠ±å†³ç­–è¿‡ç¨‹` `åŸºäºŽæ¨¡åž‹çš„å¼ºåŒ–å­¦ä¹ ` `å¥–åŠ±æœº` `æ ·æœ¬æ•ˆçŽ‡` `PACæ”¶æ•›` `ç¦»æ•£åŠ¨ä½œç©ºé—´` `è¿žç»­çŠ¶æ€ç©ºé—´` `SimHashç¦»æ•£åŒ–`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. æ ¸å¿ƒé—®é¢˜ï¼šä¼ ç»Ÿé©¬å°”å¯å¤«å¼ºåŒ–å­¦ä¹ æ— æ³•å¤„ç†ä¾èµ–åŽ†å²çš„ä»»åŠ¡ï¼Œéžé©¬å°”å¯å¤«å¥–åŠ±å†³ç­–è¿‡ç¨‹æ–¹æ³•ç¼ºä¹æœ€ä¼˜æ€§å’Œæ ·æœ¬æ•ˆçŽ‡çš„å½¢å¼åŒ–ä¿è¯ã€‚
2. æ–¹æ³•è¦ç‚¹ï¼šæå‡ºQR-MAXç®—æ³•ï¼Œé€šè¿‡å¥–åŠ±æœºå°†é©¬å°”å¯å¤«è½¬ç§»ä¸Žéžé©¬å°”å¯å¤«å¥–åŠ±å› å­åˆ†è§£ï¼Œå®žçŽ°å¤šé¡¹å¼æ ·æœ¬å¤æ‚åº¦çš„PACæ”¶æ•›ã€‚
3. å®žéªŒæˆ–æ•ˆæžœï¼šåœ¨å¤æ‚çŽ¯å¢ƒä¸­ç›¸æ¯”çŽ°æœ‰æ–¹æ³•æ˜¾è‘—æå‡æ ·æœ¬æ•ˆçŽ‡ï¼Œå¹¶å¢žå¼ºå¯»æ‰¾æœ€ä¼˜ç­–ç•¥çš„é²æ£’æ€§ï¼Œæ‰©å±•åˆ°è¿žç»­çŠ¶æ€ç©ºé—´è¡¨çŽ°ç¨³å®šã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

è®¸å¤šå®žé™…å†³ç­–é—®é¢˜æ¶‰åŠçš„ä»»åŠ¡æˆåŠŸä¾èµ–äºŽæ•´ä¸ªç³»ç»ŸåŽ†å²ï¼Œè€Œéžä»…è¾¾åˆ°å…·æœ‰æœŸæœ›å±žæ€§çš„çŠ¶æ€ã€‚é©¬å°”å¯å¤«å¼ºåŒ–å­¦ä¹ æ–¹æ³•ä¸é€‚ç”¨äºŽæ­¤ç±»ä»»åŠ¡ï¼Œè€Œéžé©¬å°”å¯å¤«å¥–åŠ±å†³ç­–è¿‡ç¨‹ä½¿æ™ºèƒ½ä½“èƒ½å¤Ÿå¤„ç†æ—¶é—´ä¾èµ–æ€§ä»»åŠ¡ã€‚è¿™ç§æ–¹æ³•é•¿æœŸä»¥æ¥ç¼ºä¹å¯¹ï¼ˆè¿‘ä¼¼ï¼‰æœ€ä¼˜æ€§å’Œæ ·æœ¬æ•ˆçŽ‡çš„å½¢å¼åŒ–ä¿è¯ã€‚æˆ‘ä»¬é€šè¿‡QR-MAXä¸ºè§£å†³è¿™ä¸¤ä¸ªé—®é¢˜åšå‡ºè´¡çŒ®ï¼Œè¿™æ˜¯ä¸€ç§åŸºäºŽæ¨¡åž‹çš„æ–°åž‹ç®—æ³•ï¼Œç”¨äºŽç¦»æ•£éžé©¬å°”å¯å¤«å¥–åŠ±å†³ç­–è¿‡ç¨‹ï¼Œé€šè¿‡å¥–åŠ±æœºå°†é©¬å°”å¯å¤«è½¬ç§»å­¦ä¹ ä¸Žéžé©¬å°”å¯å¤«å¥–åŠ±å¤„ç†è¿›è¡Œå› å­åˆ†è§£ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªåˆ©ç”¨è¿™ç§å› å­åˆ†è§£èŽ·å¾—å¤šé¡¹å¼æ ·æœ¬å¤æ‚åº¦ä¸‹PACæ”¶æ•›åˆ°Îµ-æœ€ä¼˜ç­–ç•¥çš„åŸºäºŽæ¨¡åž‹çš„ç¦»æ•£åŠ¨ä½œéžé©¬å°”å¯å¤«å¥–åŠ±å†³ç­–è¿‡ç¨‹å¼ºåŒ–å­¦ä¹ ç®—æ³•ã€‚ç„¶åŽï¼Œæˆ‘ä»¬å°†QR-MAXæ‰©å±•åˆ°è¿žç»­çŠ¶æ€ç©ºé—´ï¼Œæå‡ºBucket-QR-MAXï¼Œè¿™æ˜¯ä¸€ç§åŸºäºŽSimHashçš„ç¦»æ•£åŒ–å™¨ï¼Œä¿æŒç›¸åŒçš„å› å­åˆ†è§£ç»“æž„ï¼Œæ— éœ€æ‰‹åŠ¨ç½‘æ ¼åŒ–æˆ–å‡½æ•°é€¼è¿‘å³å¯å®žçŽ°å¿«é€Ÿç¨³å®šçš„å­¦ä¹ ã€‚æˆ‘ä»¬åœ¨å¤æ‚åº¦é€’å¢žçš„çŽ¯å¢ƒä¸­å°†æˆ‘ä»¬çš„æ–¹æ³•ä¸ŽçŽ°ä»£æœ€å…ˆè¿›çš„åŸºäºŽæ¨¡åž‹çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•è¿›è¡Œå®žéªŒæ¯”è¾ƒï¼Œæ˜¾ç¤ºå‡ºæ ·æœ¬æ•ˆçŽ‡çš„æ˜¾è‘—æé«˜å’Œå¯»æ‰¾æœ€ä¼˜ç­–ç•¥çš„é²æ£’æ€§å¢žå¼ºã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡è§£å†³ç¦»æ•£åŠ¨ä½œéžé©¬å°”å¯å¤«å¥–åŠ±å†³ç­–è¿‡ç¨‹ä¸­çš„å¼ºåŒ–å­¦ä¹ é—®é¢˜ï¼Œå…¶ä¸­ä»»åŠ¡æˆåŠŸä¾èµ–äºŽæ•´ä¸ªç³»ç»ŸåŽ†å²è€Œéžå•ä¸ªçŠ¶æ€ã€‚çŽ°æœ‰åŸºäºŽæ¨¡åž‹çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•åœ¨éžé©¬å°”å¯å¤«å¥–åŠ±è®¾ç½®ä¸‹ç¼ºä¹å½¢å¼åŒ–ä¿è¯ï¼Œå¯¼è‡´æ ·æœ¬æ•ˆçŽ‡ä½Žå’Œæœ€ä¼˜æ€§ä¸ç¡®å®šã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šæ ¸å¿ƒæ€è·¯æ˜¯å°†é©¬å°”å¯å¤«çŠ¶æ€è½¬ç§»å­¦ä¹ ä¸Žéžé©¬å°”å¯å¤«å¥–åŠ±å¤„ç†è¿›è¡Œå› å­åˆ†è§£ï¼Œé€šè¿‡å¥–åŠ±æœºæ¥ç¼–ç åŽ†å²ä¾èµ–çš„å¥–åŠ±ç»“æž„ï¼Œä»Žè€Œåˆ†ç¦»å­¦ä¹ è¿‡ç¨‹ï¼Œæé«˜æ•ˆçŽ‡å’Œå¯åˆ†æžæ€§ã€‚è¿™ç§è®¾è®¡å…è®¸ç®—æ³•ä¸“æ³¨äºŽå­¦ä¹ çŠ¶æ€åŠ¨æ€ï¼ŒåŒæ—¶åˆ©ç”¨å¥–åŠ±æœºå¤„ç†å¤æ‚çš„æ—¶é—´ä¾èµ–æ€§ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“æž¶æž„åŒ…æ‹¬ä¸¤ä¸ªä¸»è¦é˜¶æ®µï¼šé¦–å…ˆï¼Œä½¿ç”¨åŸºäºŽæ¨¡åž‹çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•å­¦ä¹ é©¬å°”å¯å¤«çŠ¶æ€è½¬ç§»æ¨¡åž‹ï¼›å…¶æ¬¡ï¼Œé€šè¿‡å¥–åŠ±æœºå°†éžé©¬å°”å¯å¤«å¥–åŠ±è½¬æ¢ä¸ºé©¬å°”å¯å¤«å½¢å¼ï¼Œå¹¶æ•´åˆåˆ°ç­–ç•¥ä¼˜åŒ–ä¸­ã€‚QR-MAXç®—æ³•åœ¨æ­¤åŸºç¡€ä¸Šå®žçŽ°ç­–ç•¥è¿­ä»£ï¼Œè€ŒBucket-QR-MAXæ‰©å±•éƒ¨åˆ†æ·»åŠ SimHashç¦»æ•£åŒ–æ¨¡å—ä»¥å¤„ç†è¿žç»­çŠ¶æ€ç©ºé—´ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°æ˜¯é¦–æ¬¡æå‡ºåŸºäºŽæ¨¡åž‹çš„å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œåœ¨ç¦»æ•£åŠ¨ä½œéžé©¬å°”å¯å¤«å¥–åŠ±å†³ç­–è¿‡ç¨‹ä¸­å®žçŽ°å¤šé¡¹å¼æ ·æœ¬å¤æ‚åº¦çš„PACæ”¶æ•›åˆ°Îµ-æœ€ä¼˜ç­–ç•¥ã€‚ä¸ŽçŽ°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œæœ¬è´¨åŒºåˆ«åœ¨äºŽåˆ©ç”¨å¥–åŠ±æœºè¿›è¡Œå› å­åˆ†è§£ï¼Œé¿å…äº†ç›´æŽ¥å¤„ç†éžé©¬å°”å¯å¤«å¥–åŠ±çš„å¤æ‚æ€§ï¼Œä»Žè€ŒèŽ·å¾—å½¢å¼åŒ–ä¿è¯ã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬å¥–åŠ±æœºçš„æž„å»ºï¼Œç”¨äºŽç¼–ç éžé©¬å°”å¯å¤«å¥–åŠ±é€»è¾‘ï¼›åœ¨QR-MAXä¸­ï¼Œé‡‡ç”¨æ¨¡åž‹å­¦ä¹ æ¨¡å—ä¼°è®¡çŠ¶æ€è½¬ç§»æ¦‚çŽ‡ï¼›åœ¨Bucket-QR-MAXä¸­ï¼Œä½¿ç”¨SimHashæŠ€æœ¯è¿›è¡ŒçŠ¶æ€ç¦»æ•£åŒ–ï¼Œå‚æ•°è®¾ç½®æ¶‰åŠå“ˆå¸Œå‡½æ•°çš„é€‰æ‹©å’Œæ¡¶å¤§å°ï¼Œä»¥å¹³è¡¡ç²¾åº¦å’Œè®¡ç®—æ•ˆçŽ‡ï¼Œæ— éœ€æ‰‹åŠ¨ç½‘æ ¼åŒ–æˆ–å¤æ‚å‡½æ•°é€¼è¿‘ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒç»“æžœæ˜¾ç¤ºï¼ŒQR-MAXåœ¨å¤æ‚åº¦é€’å¢žçš„çŽ¯å¢ƒä¸­ç›¸æ¯”çŽ°ä»£æœ€å…ˆè¿›çš„åŸºäºŽæ¨¡åž‹å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼Œæ ·æœ¬æ•ˆçŽ‡æ˜¾è‘—æå‡ï¼Œå…·ä½“æå‡å¹…åº¦æœªçŸ¥ä½†è®ºæ–‡å¼ºè°ƒä¸ºâ€œæ˜¾è‘—â€ã€‚Bucket-QR-MAXåœ¨è¿žç»­çŠ¶æ€ç©ºé—´ä¸­å®žçŽ°å¿«é€Ÿç¨³å®šå­¦ä¹ ï¼Œæ— éœ€æ‰‹åŠ¨ç½‘æ ¼åŒ–ï¼Œè¡¨çŽ°å‡ºå¢žå¼ºçš„é²æ£’æ€§ï¼Œåœ¨å¯»æ‰¾æœ€ä¼˜ç­–ç•¥æ–¹é¢ä¼˜äºŽåŸºçº¿æ–¹æ³•ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶åœ¨æœºå™¨äººä»»åŠ¡è§„åˆ’ã€è‡ªåŠ¨é©¾é©¶ã€æ¸¸æˆAIå’Œå·¥ä¸šè‡ªåŠ¨åŒ–ç­‰é¢†åŸŸå…·æœ‰æ½œåœ¨åº”ç”¨ä»·å€¼ï¼Œç‰¹åˆ«é€‚ç”¨äºŽéœ€è¦å¤„ç†åŽ†å²ä¾èµ–å†³ç­–çš„åœºæ™¯ï¼Œå¦‚é•¿æœŸä»»åŠ¡å®Œæˆæˆ–åºåˆ—åŠ¨ä½œä¼˜åŒ–ã€‚å®žé™…ä»·å€¼åœ¨äºŽæä¾›é«˜æ•ˆä¸”å¯è¯æ˜Žæœ€ä¼˜çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•ï¼Œæœªæ¥å¯èƒ½æŽ¨åŠ¨éžé©¬å°”å¯å¤«çŽ¯å¢ƒä¸‹çš„æ™ºèƒ½ç³»ç»Ÿå‘å±•ï¼Œå¢žå¼ºå¤æ‚å†³ç­–ä»»åŠ¡çš„å¯é æ€§å’Œå¯æ‰©å±•æ€§ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Many practical decision-making problems involve tasks whose success depends on the entire system history, rather than on achieving a state with desired properties. Markovian Reinforcement Learning (RL) approaches are not suitable for such tasks, while RL with non-Markovian reward decision processes (NMRDPs) enables agents to tackle temporal-dependency tasks. This approach has long been known to lack formal guarantees on both (near-)optimality and sample efficiency. We contribute to solving both issues with QR-MAX, a novel model-based algorithm for discrete NMRDPs that factorizes Markovian transition learning from non-Markovian reward handling via reward machines. To the best of our knowledge, this is the first model-based RL algorithm for discrete-action NMRDPs that exploits this factorization to obtain PAC convergence to $\varepsilon$-optimal policies with polynomial sample complexity. We then extend QR-MAX to continuous state spaces with Bucket-QR-MAX, a SimHash-based discretiser that preserves the same factorized structure and achieves fast and stable learning without manual gridding or function approximation. We experimentally compare our method with modern state-of-the-art model-based RL approaches on environments of increasing complexity, showing a significant improvement in sample efficiency and increased robustness in finding optimal policies.

