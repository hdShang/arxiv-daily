---
layout: default
title: RADAR: Accelerating Large Language Model Inference With RL-Based Dynamic Draft Trees
---

# RADAR: Accelerating Large Language Model Inference With RL-Based Dynamic Draft Trees

**arXiv**: [2512.14069v1](https://arxiv.org/abs/2512.14069) | [PDF](https://arxiv.org/pdf/2512.14069.pdf)

**ä½œè€…**: Junjie Ma, Jinlong Li

**åˆ†ç±»**: cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: 5 pages, 2 figures

**ðŸ”— ä»£ç /é¡¹ç›®**: [GITHUB](https://github.com/minaduki-sora/RADAR)

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºŽå¼ºåŒ–å­¦ä¹ çš„åŠ¨æ€è‰ç¨¿æ ‘æ–¹æ³•RADARï¼Œä»¥åŠ é€Ÿå¤§è¯­è¨€æ¨¡åž‹æŽ¨ç†è¿‡ç¨‹ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `å¤§è¯­è¨€æ¨¡åž‹æŽ¨ç†åŠ é€Ÿ` `æŽ¨æµ‹é‡‡æ ·` `å¼ºåŒ–å­¦ä¹ ` `åŠ¨æ€è‰ç¨¿æ ‘` `é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹` `ç¦»çº¿å¼ºåŒ–å­¦ä¹ ` `è‡ªå›žå½’è§£ç ä¼˜åŒ–` `è®¡ç®—æ•ˆçŽ‡æå‡`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰æŽ¨æµ‹é‡‡æ ·æ–¹æ³•ä¸­è‰ç¨¿æ¨¡åž‹è°ƒç”¨æ¬¡æ•°å›ºå®šï¼Œç¼ºä¹çµæ´»æ€§ï¼Œå¯¼è‡´è®¡ç®—å†—ä½™å’Œæ•ˆçŽ‡ä½Žä¸‹ã€‚
2. RADARå°†è‰ç¨¿æ ‘ç”Ÿæˆå»ºæ¨¡ä¸ºMDPï¼Œåˆ©ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ è®­ç»ƒé¢„æµ‹æ¨¡åž‹ï¼ŒåŠ¨æ€å†³å®šè‰ç¨¿æ¨¡åž‹è°ƒç”¨ã€‚
3. å®žéªŒæ˜¾ç¤ºRADARåœ¨å¤šä¸ªLLMå’Œä»»åŠ¡ä¸Šå®žçŽ°3.17x-4.82xåŠ é€Ÿï¼Œæ˜¾è‘—è¶…è¶Šè‡ªå›žå½’è§£ç åŸºçº¿ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

çŽ°ä»£å¤§è¯­è¨€æ¨¡åž‹ï¼ˆLLMsï¼‰çš„æŽ¨ç†è¿‡ç¨‹æˆæœ¬é«˜æ˜‚ä¸”é€Ÿåº¦ç¼“æ…¢ï¼ŒæŽ¨æµ‹é‡‡æ ·å·²æˆä¸ºè§£å†³æ­¤é—®é¢˜çš„æœ‰æ•ˆæ–¹æ¡ˆã€‚ç„¶è€Œï¼ŒæŽ¨æµ‹é‡‡æ ·ä¸­ç”¨äºŽç”Ÿæˆå€™é€‰æ ‡è®°çš„è‰ç¨¿æ¨¡åž‹è°ƒç”¨æ¬¡æ•°æ˜¯ä¸€ä¸ªé¢„è®¾çš„è¶…å‚æ•°ï¼Œç¼ºä¹çµæ´»æ€§ã€‚ä¸ºäº†æ›´æœ‰æ•ˆåœ°ç”Ÿæˆå’Œåˆ©ç”¨å€™é€‰æ ‡è®°ï¼Œæˆ‘ä»¬æå‡ºäº†RADARï¼Œè¿™æ˜¯ä¸€ç§åŸºäºŽå¼ºåŒ–å­¦ä¹ åŠ¨æ€è‰ç¨¿æ ‘çš„æ–°åž‹æŽ¨æµ‹é‡‡æ ·æ–¹æ³•ã€‚RADARå°†è‰ç¨¿æ ‘ç”Ÿæˆè¿‡ç¨‹å»ºæ¨¡ä¸ºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMDPï¼‰ï¼Œå¹¶é‡‡ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ è®­ç»ƒé¢„æµ‹æ¨¡åž‹ï¼Œä»Žè€Œå®žçŽ°å¯¹è‰ç¨¿æ¨¡åž‹è°ƒç”¨çš„å®žæ—¶å†³ç­–ï¼Œå‡å°‘å†—ä½™è®¡ç®—å¹¶è¿›ä¸€æ­¥åŠ é€ŸæŽ¨ç†ã€‚åœ¨ä¸‰ä¸ªLLMå’Œå››ä¸ªä»»åŠ¡ä¸Šçš„è¯„ä¼°è¡¨æ˜Žï¼ŒRADARç›¸æ¯”è‡ªå›žå½’è§£ç åŸºçº¿å®žçŽ°äº†3.17å€è‡³4.82å€çš„åŠ é€Ÿã€‚ä»£ç å¯åœ¨https://github.com/minaduki-sora/RADARèŽ·å–ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³å¤§è¯­è¨€æ¨¡åž‹æŽ¨ç†ä¸­çš„æ•ˆçŽ‡é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯æŽ¨æµ‹é‡‡æ ·æ–¹æ³•ä¸­è‰ç¨¿æ¨¡åž‹è°ƒç”¨æ¬¡æ•°å›ºå®šå¯¼è‡´çš„çµæ´»æ€§ä¸è¶³å’Œè®¡ç®—å†—ä½™ã€‚çŽ°æœ‰æŽ¨æµ‹é‡‡æ ·æ–¹æ³•é¢„è®¾è‰ç¨¿æ¨¡åž‹è°ƒç”¨æ¬¡æ•°ï¼Œæ— æ³•æ ¹æ®è¾“å…¥åŠ¨æ€è°ƒæ•´ï¼Œå¯èƒ½ç”Ÿæˆè¿‡å¤šæˆ–è¿‡å°‘å€™é€‰æ ‡è®°ï¼Œå½±å“æŽ¨ç†é€Ÿåº¦å’Œèµ„æºåˆ©ç”¨ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡æå‡ºRADARæ–¹æ³•ï¼Œé€šè¿‡å°†è‰ç¨¿æ ‘ç”Ÿæˆè¿‡ç¨‹å»ºæ¨¡ä¸ºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMDPï¼‰ï¼Œå¹¶åˆ©ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ è®­ç»ƒé¢„æµ‹æ¨¡åž‹ï¼Œå®žçŽ°åŠ¨æ€å†³ç­–è‰ç¨¿æ¨¡åž‹è°ƒç”¨æ¬¡æ•°ã€‚è¿™æ ·è®¾è®¡å¯ä»¥å®žæ—¶ä¼˜åŒ–å€™é€‰æ ‡è®°ç”Ÿæˆï¼Œå‡å°‘ä¸å¿…è¦è®¡ç®—ï¼Œæå‡æŽ¨ç†æ•ˆçŽ‡ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šRADARçš„æ•´ä½“æž¶æž„åŒ…æ‹¬è‰ç¨¿æ¨¡åž‹ã€ç›®æ ‡æ¨¡åž‹å’Œå¼ºåŒ–å­¦ä¹ é¢„æµ‹æ¨¡å—ã€‚æµç¨‹åˆ†ä¸ºç¦»çº¿è®­ç»ƒå’Œåœ¨çº¿æŽ¨ç†ä¸¤ä¸ªé˜¶æ®µï¼šç¦»çº¿é˜¶æ®µä½¿ç”¨åŽ†å²æ•°æ®è®­ç»ƒé¢„æµ‹æ¨¡åž‹ï¼Œå­¦ä¹ æœ€ä¼˜è°ƒç”¨ç­–ç•¥ï¼›åœ¨çº¿é˜¶æ®µæ ¹æ®å½“å‰çŠ¶æ€åŠ¨æ€å†³å®šè‰ç¨¿æ¨¡åž‹è°ƒç”¨æ¬¡æ•°ï¼Œç”Ÿæˆå€™é€‰æ ‡è®°æ ‘ï¼Œç„¶åŽç”±ç›®æ ‡æ¨¡åž‹éªŒè¯å¹¶æŽ¥å—æœ‰æ•ˆæ ‡è®°ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°æ˜¯å°†å¼ºåŒ–å­¦ä¹ å¼•å…¥æŽ¨æµ‹é‡‡æ ·ï¼Œå®žçŽ°åŠ¨æ€è‰ç¨¿æ ‘ç”Ÿæˆã€‚ä¸ŽçŽ°æœ‰å›ºå®šè°ƒç”¨æ¬¡æ•°çš„æ–¹æ³•ç›¸æ¯”ï¼ŒRADARèƒ½è‡ªé€‚åº”è°ƒæ•´ç­–ç•¥ï¼Œæœ¬è´¨åŒºåˆ«åœ¨äºŽä»Žé™æ€è¶…å‚æ•°ä¼˜åŒ–è½¬å‘åŸºäºŽçŠ¶æ€çš„å®žæ—¶å†³ç­–ï¼Œæé«˜äº†çµæ´»æ€§å’Œæ•ˆçŽ‡ã€‚

**å…³é”®è®¾è®¡**ï¼šæŠ€æœ¯ç»†èŠ‚åŒ…æ‹¬ï¼šå°†è‰ç¨¿æ ‘ç”Ÿæˆå»ºæ¨¡ä¸ºMDPï¼ŒçŠ¶æ€ä¸ºå½“å‰è§£ç ä¸Šä¸‹æ–‡ï¼ŒåŠ¨ä½œä¸ºè°ƒç”¨è‰ç¨¿æ¨¡åž‹æ¬¡æ•°ï¼Œå¥–åŠ±ä¸ºåŠ é€Ÿæ¯”ï¼›é‡‡ç”¨ç¦»çº¿å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼ˆå¦‚ä¿å®ˆQå­¦ä¹ ï¼‰è®­ç»ƒé¢„æµ‹æ¨¡åž‹ï¼Œé¿å…åœ¨çº¿æŽ¢ç´¢å¼€é”€ï¼›ç½‘ç»œç»“æž„å¯èƒ½åŸºäºŽTransformeræˆ–MLPï¼Œå…·ä½“å‚æ•°è®¾ç½®æœªåœ¨æ‘˜è¦ä¸­è¯¦è¿°ï¼Œéœ€å‚è€ƒè®ºæ–‡æ­£æ–‡ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

RADARåœ¨ä¸‰ä¸ªå¤§è¯­è¨€æ¨¡åž‹å’Œå››ä¸ªä»»åŠ¡ä¸Šçš„å®žéªŒç»“æžœæ˜¾ç¤ºï¼Œç›¸æ¯”è‡ªå›žå½’è§£ç åŸºçº¿ï¼Œå®žçŽ°äº†3.17å€è‡³4.82å€çš„åŠ é€Ÿã€‚å…·ä½“æ€§èƒ½æ•°æ®è¡¨æ˜Žï¼Œè¯¥æ–¹æ³•èƒ½æœ‰æ•ˆå‡å°‘å†—ä½™è®¡ç®—ï¼Œæå‡æŽ¨ç†æ•ˆçŽ‡ï¼ŒéªŒè¯äº†åŠ¨æ€å†³ç­–ç­–ç•¥çš„ä¼˜è¶Šæ€§ã€‚å¯¹æ¯”åŸºçº¿åŒ…æ‹¬ä¼ ç»ŸæŽ¨æµ‹é‡‡æ ·æ–¹æ³•ï¼ŒRADARåœ¨çµæ´»æ€§å’Œé€Ÿåº¦æ–¹é¢å‡æœ‰æ˜¾è‘—æå‡ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

RADARå¯åº”ç”¨äºŽéœ€è¦é«˜æ•ˆå¤§è¯­è¨€æ¨¡åž‹æŽ¨ç†çš„åœºæ™¯ï¼Œå¦‚èŠå¤©æœºå™¨äººã€ä»£ç ç”Ÿæˆã€æ–‡æœ¬æ‘˜è¦å’Œæœºå™¨ç¿»è¯‘ç­‰ã€‚å…¶å®žé™…ä»·å€¼åœ¨äºŽé™ä½Žè®¡ç®—æˆæœ¬ã€æå‡å“åº”é€Ÿåº¦ï¼Œé€‚ç”¨äºŽäº‘æœåŠ¡å’Œè¾¹ç¼˜è®¾å¤‡ã€‚æœªæ¥å¯èƒ½æŽ¨åŠ¨æ›´æ™ºèƒ½çš„è‡ªé€‚åº”æŽ¨ç†æ–¹æ³•å‘å±•ï¼Œä¿ƒè¿›AIéƒ¨ç½²çš„æ™®åŠåŒ–ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Inference with modern Large Language Models (LLMs) is expensive and slow, and speculative sampling has emerged as an effective solution to this problem, however, the number of the calls to the draft model for generating candidate tokens in speculative sampling is a preset hyperparameter, lacking flexibility. To generate and utilize the candidate tokens more effectively, we propose RADAR, a novel speculative sampling method with RL-based dynamic draft trees. RADAR formulates the draft tree generation process as a Markov Decision Process (MDP) and employs offline reinforcement learning to train a prediction model, which enables real-time decision on the calls to the draft model, reducing redundant computations and further accelerating inference. Evaluations across three LLMs and four tasks show that RADAR achieves a speedup of 3.17x-4.82x over the auto-regressive decoding baseline. The code is available at https://github.com/minaduki-sora/RADAR.

