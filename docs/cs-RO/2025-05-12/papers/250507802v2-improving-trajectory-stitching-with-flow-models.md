---
layout: default
title: Improving Trajectory Stitching with Flow Models
---

# Improving Trajectory Stitching with Flow Models

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2505.07802" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2505.07802v2</a>
  <a href="https://arxiv.org/pdf/2505.07802.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2505.07802v2" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2505.07802v2', 'Improving Trajectory Stitching with Flow Models')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Reece O'Mahoney, Wanming Yu, Ioannis Havoutis

**åˆ†ç±»**: cs.RO, cs.AI, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-05-12 (æ›´æ–°: 2025-06-03)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºæµæ¨¡å‹çš„è½¨è¿¹æ‹¼æ¥æ–¹æ³•ä»¥è§£å†³æœºå™¨äººè·¯å¾„è§„åˆ’é—®é¢˜**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)**

**å…³é”®è¯**: `è½¨è¿¹è§„åˆ’` `ç”Ÿæˆæ¨¡å‹` `æœºå™¨äººæŠ€æœ¯` `æµæ¨¡å‹` `è·¯å¾„æ‹¼æ¥` `é¿éšœä»»åŠ¡` `æœºå™¨å­¦ä¹ `

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰çš„è½¨è¿¹è§„åˆ’æ–¹æ³•åœ¨ç¼ºä¹å®Œæ•´è½¨è¿¹çš„æƒ…å†µä¸‹è¡¨ç°ä¸ä½³ï¼Œæ— æ³•æœ‰æ•ˆè¿›è¡Œè½¨è¿¹æ‹¼æ¥ã€‚
2. æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„æ¶æ„å’Œæ•°æ®é›†é€‰æ‹©ï¼Œç»“åˆæ”¹è¿›çš„è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ï¼Œå¢å¼ºäº†è½¨è¿¹è§„åˆ’èƒ½åŠ›ã€‚
3. å®éªŒç»“æœè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨é¿éšœä»»åŠ¡ä¸­è¡¨ç°ä¼˜å¼‚ï¼Œèƒ½å¤Ÿå¤„ç†æ›´å¤§éšœç¢ç‰©ï¼Œæ€§èƒ½æ˜¾è‘—ä¼˜äºåŸºçº¿æ–¹æ³•ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ç”Ÿæˆæ¨¡å‹åœ¨è½¨è¿¹è§„åˆ’ä¸­å±•ç°å‡ºè‰¯å¥½çš„æ½œåŠ›ï¼Œå°¤å…¶æ˜¯åœ¨å»ºæ¨¡å¤æ‚åˆ†å¸ƒå’Œå¼•å¯¼æ¨ç†è¿‡ç¨‹ä¸­ã€‚ç„¶è€Œï¼Œç°æœ‰æ–¹æ³•åœ¨è®­ç»ƒé›†ä¸­ç¼ºä¹å®Œæ•´è½¨è¿¹æ—¶è¡¨ç°ä¸ä½³ï¼Œå¯¼è‡´æ— æ³•è¿›è¡Œæœ‰æ•ˆçš„è½¨è¿¹æ‹¼æ¥ã€‚æœ¬æ–‡è¯†åˆ«å‡ºè¿™ä¸€é—®é¢˜ï¼Œå¹¶æå‡ºäº†ç›¸åº”çš„æ¶æ„å’Œæ•°æ®é›†é€‰æ‹©æ¥è§£å†³æ­¤é—®é¢˜ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜æå‡ºäº†ä¸€ç§æ–°é¢–çš„è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹çš„æ”¹è¿›ï¼Œä»¥ç¨³å®šå’Œå¢å¼ºè¿™äº›èƒ½åŠ›ã€‚é€šè¿‡åœ¨æ¨¡æ‹Ÿå’ŒçœŸå®ç¡¬ä»¶ä¸Šè¿›è¡Œçš„å®éªŒï¼Œæˆ‘ä»¬è¯æ˜äº†è¯¥æ–¹æ³•åœ¨å¤„ç†è¶…å‡ºåˆ†å¸ƒè¾¹ç•Œæ¡ä»¶å’Œé¿éšœä»»åŠ¡ä¸­çš„æœ‰æ•ˆæ€§ï¼Œæ˜¾è‘—ä¼˜äºåŸºçº¿æ–¹æ³•ï¼Œèƒ½å¤Ÿé¿å¼€å››å€äºä»¥å¾€çš„éšœç¢ç‰©ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šæœ¬æ–‡æ—¨åœ¨è§£å†³ç°æœ‰è½¨è¿¹è§„åˆ’æ–¹æ³•åœ¨ç¼ºä¹å®Œæ•´è½¨è¿¹æ—¶æ— æ³•è¿›è¡Œæœ‰æ•ˆæ‹¼æ¥çš„é—®é¢˜ã€‚ç°æœ‰æ–¹æ³•åœ¨é¢å¯¹å¤æ‚çš„ç¯å¢ƒå’Œè¾¹ç•Œæ¡ä»¶æ—¶ï¼Œå¾€å¾€æ— æ³•ç”Ÿæˆæœ‰æ•ˆçš„è½¨è¿¹ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡æå‡ºé€šè¿‡æ”¹è¿›æ¨¡å‹æ¶æ„å’Œæ•°æ®é›†é€‰æ‹©ï¼Œç»“åˆæ–°çš„è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ï¼Œæ¥å¢å¼ºç”Ÿæˆæ¨¡å‹çš„è½¨è¿¹æ‹¼æ¥èƒ½åŠ›ã€‚è¿™ç§è®¾è®¡æ—¨åœ¨æé«˜æ¨¡å‹åœ¨å¤æ‚ç¯å¢ƒä¸­çš„é€‚åº”æ€§å’Œç¨³å®šæ€§ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šæ•´ä½“æ¶æ„åŒ…æ‹¬æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹è®­ç»ƒå’Œæ¨ç†ä¸‰ä¸ªä¸»è¦æ¨¡å—ã€‚åœ¨æ•°æ®é¢„å¤„ç†é˜¶æ®µï¼Œé€‰æ‹©é€‚å½“çš„æ•°æ®é›†ä»¥æ¶µç›–å¤šæ ·çš„è½¨è¿¹ï¼›åœ¨æ¨¡å‹è®­ç»ƒé˜¶æ®µï¼Œé‡‡ç”¨æ”¹è¿›çš„æŸå¤±å‡½æ•°å’Œç½‘ç»œç»“æ„ï¼›åœ¨æ¨ç†é˜¶æ®µï¼Œç»“åˆæµæ¨¡å‹è¿›è¡Œè½¨è¿¹ç”Ÿæˆå’Œæ‹¼æ¥ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°åœ¨äºæå‡ºäº†ä¸€ç§æ–°çš„è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ï¼Œèƒ½å¤Ÿæœ‰æ•ˆå¤„ç†è¶…å‡ºè®­ç»ƒé›†åˆ†å¸ƒçš„æƒ…å†µï¼Œå¹¶å®ç°æ›´å¤æ‚çš„è½¨è¿¹æ‹¼æ¥ã€‚è¿™ä¸ç°æœ‰æ–¹æ³•çš„æœ¬è´¨åŒºåˆ«åœ¨äºå…¶å¯¹è½¨è¿¹ç”Ÿæˆçš„çµæ´»æ€§å’Œé€‚åº”æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨æ¨¡å‹è®¾è®¡ä¸­ï¼Œé‡‡ç”¨äº†ç‰¹å®šçš„æŸå¤±å‡½æ•°ä»¥å¹³è¡¡ç”Ÿæˆè½¨è¿¹çš„è´¨é‡å’Œå¤šæ ·æ€§ï¼ŒåŒæ—¶åœ¨ç½‘ç»œç»“æ„ä¸Šå¼•å…¥äº†æµæ¨¡å‹ä»¥å¢å¼ºç”Ÿæˆèƒ½åŠ›ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœæ˜¾ç¤ºï¼Œæ‰€ææ–¹æ³•åœ¨é¿éšœä»»åŠ¡ä¸­èƒ½å¤Ÿæœ‰æ•ˆå¤„ç†å››å€äºä»¥å¾€çš„éšœç¢ç‰©ï¼Œä¸”åœ¨ç”Ÿæˆè®¡åˆ’æ—¶è¡¨ç°å‡ºè‰²ï¼Œæ˜¾è‘—ä¼˜äºåŸºçº¿æ–¹æ³•ï¼Œå±•ç¤ºäº†åœ¨å¤æ‚ç¯å¢ƒä¸‹çš„å¼ºå¤§èƒ½åŠ›ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶çš„æ½œåœ¨åº”ç”¨é¢†åŸŸåŒ…æ‹¬æœºå™¨äººæ“ä½œã€è‡ªåŠ¨é©¾é©¶å’Œæ— äººæœºå¯¼èˆªç­‰åœºæ™¯ã€‚é€šè¿‡æé«˜è½¨è¿¹è§„åˆ’çš„çµæ´»æ€§å’Œç¨³å®šæ€§ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿåœ¨å¤æ‚ç¯å¢ƒä¸­å®ç°æ›´å®‰å…¨å’Œé«˜æ•ˆçš„è·¯å¾„è§„åˆ’ï¼Œå…·æœ‰é‡è¦çš„å®é™…ä»·å€¼å’Œå¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Generative models have shown great promise as trajectory planners, given their affinity to modeling complex distributions and guidable inference process. Previous works have successfully applied these in the context of robotic manipulation but perform poorly when the required solution does not exist as a complete trajectory within the training set. We identify that this is a result of being unable to plan via stitching, and subsequently address the architectural and dataset choices needed to remedy this. On top of this, we propose a novel addition to the training and inference procedures to both stabilize and enhance these capabilities. We demonstrate the efficacy of our approach by generating plans with out of distribution boundary conditions and performing obstacle avoidance on the Franka Panda in simulation and on real hardware. In both of these tasks our method performs significantly better than the baselines and is able to avoid obstacles up to four times as large.

