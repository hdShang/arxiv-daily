---
layout: default
title: CHD: Coupled Hierarchical Diffusion for Long-Horizon Tasks
---

# CHD: Coupled Hierarchical Diffusion for Long-Horizon Tasks

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2505.07261" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2505.07261v3</a>
  <a href="https://arxiv.org/pdf/2505.07261.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2505.07261v3" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2505.07261v3', 'CHD: Coupled Hierarchical Diffusion for Long-Horizon Tasks')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Ce Hao, Anxing Xiao, Zhiwei Xue, Harold Soh

**åˆ†ç±»**: cs.RO, cs.AI

**å‘å¸ƒæ—¥æœŸ**: 2025-05-12 (æ›´æ–°: 2025-10-12)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºè€¦åˆå±‚æ¬¡æ‰©æ•£æ¡†æ¶ä»¥è§£å†³é•¿æ—¶é—´ä»»åŠ¡è§„åˆ’é—®é¢˜**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)**

**å…³é”®è¯**: `é•¿æ—¶é—´ä»»åŠ¡è§„åˆ’` `è€¦åˆå±‚æ¬¡æ‰©æ•£` `è½¨è¿¹ç”Ÿæˆ` `é«˜å±‚å­ç›®æ ‡` `æœºå™¨äººå¯¼èˆª` `è‡ªåŠ¨åŒ–æ“ä½œ` `æ™ºèƒ½å®¶å±…`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰çš„åŸºäºæ‰©æ•£çš„è§„åˆ’æ–¹æ³•åœ¨é•¿æ—¶é—´å¤æ‚ä»»åŠ¡ä¸­è¡¨ç°ä¸ä½³ï¼Œä¸»è¦ç”±äºé«˜å±‚å’Œä½å±‚ä¹‹é—´çš„è€¦åˆä¸ç´§å¯†ã€‚
2. è®ºæ–‡æå‡ºçš„è€¦åˆå±‚æ¬¡æ‰©æ•£ï¼ˆCHDï¼‰æ¡†æ¶é€šè¿‡ç»Ÿä¸€çš„æ‰©æ•£è¿‡ç¨‹å…±åŒå»ºæ¨¡é«˜å±‚å­ç›®æ ‡å’Œä½å±‚è½¨è¿¹ï¼Œä»è€Œå®ç°è‡ªæˆ‘æ ¡æ­£ã€‚
3. å®éªŒç»“æœè¡¨æ˜ï¼ŒCHDåœ¨å¤šä¸ªä»»åŠ¡åœºæ™¯ä¸­å‡ä¼˜äºä¼ ç»Ÿçš„å¹³é¢å’Œå±‚æ¬¡æ‰©æ•£æ–¹æ³•ï¼Œæ˜¾ç¤ºå‡ºæ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

åŸºäºæ‰©æ•£çš„è§„åˆ’å™¨åœ¨çŸ­æ—¶é—´ä»»åŠ¡ä¸­è¡¨ç°ä¼˜å¼‚ï¼Œä½†åœ¨å¤æ‚çš„é•¿æ—¶é—´ä»»åŠ¡ä¸­å¸¸å¸¸å¤±è´¥ã€‚æˆ‘ä»¬å°†è¿™ç§å¤±è´¥å½’å› äºé«˜å±‚å­ç›®æ ‡é€‰æ‹©ä¸ä½å±‚è½¨è¿¹ç”Ÿæˆä¹‹é—´çš„æ¾æ•£è€¦åˆï¼Œå¯¼è‡´è®¡åˆ’ä¸è¿è´¯å’Œæ€§èƒ½ä¸‹é™ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†è€¦åˆå±‚æ¬¡æ‰©æ•£ï¼ˆCHDï¼‰æ¡†æ¶ï¼Œè¯¥æ¡†æ¶åœ¨ç»Ÿä¸€çš„æ‰©æ•£è¿‡ç¨‹ä¸­å…±åŒå»ºæ¨¡é«˜å±‚å­ç›®æ ‡å’Œä½å±‚è½¨è¿¹ã€‚ä¸€ä¸ªå…±äº«åˆ†ç±»å™¨å°†ä½å±‚åé¦ˆä¼ é€’ç»™é«˜å±‚ï¼Œä»¥ä¾¿åœ¨é‡‡æ ·è¿‡ç¨‹ä¸­è‡ªæˆ‘æ ¡æ­£å­ç›®æ ‡ã€‚è¿™ç§ç´§å¯†çš„é«˜å±‚-ä½å±‚è€¦åˆæé«˜äº†è½¨è¿¹çš„ä¸€è‡´æ€§ï¼Œå¹¶ä½¿å¾—é•¿æ—¶é—´æ‰©æ•£è§„åˆ’å…·å¤‡å¯æ‰©å±•æ€§ã€‚å®éªŒç»“æœæ˜¾ç¤ºï¼ŒCHDåœ¨è¿·å®«å¯¼èˆªã€æ¡Œé¢æ“ä½œå’Œå®¶åº­ç¯å¢ƒä¸­å‡ä¼˜äºå¹³é¢å’Œå±‚æ¬¡æ‰©æ•£åŸºçº¿ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡è¦è§£å†³çš„é—®é¢˜æ˜¯ç°æœ‰æ‰©æ•£è§„åˆ’æ–¹æ³•åœ¨é•¿æ—¶é—´å¤æ‚ä»»åŠ¡ä¸­çš„æ€§èƒ½ä¸è¶³ï¼Œä¸»è¦ç”±äºé«˜å±‚å­ç›®æ ‡é€‰æ‹©ä¸ä½å±‚è½¨è¿¹ç”Ÿæˆä¹‹é—´çš„æ¾æ•£è€¦åˆï¼Œå¯¼è‡´è®¡åˆ’ä¸è¿è´¯å’Œæ•ˆç‡ä½ä¸‹ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒè§£å†³æ€è·¯æ˜¯æå‡ºè€¦åˆå±‚æ¬¡æ‰©æ•£ï¼ˆCHDï¼‰æ¡†æ¶ï¼Œé€šè¿‡åœ¨ç»Ÿä¸€çš„æ‰©æ•£è¿‡ç¨‹ä¸­å…±åŒå»ºæ¨¡é«˜å±‚å­ç›®æ ‡å’Œä½å±‚è½¨è¿¹ï¼Œåˆ©ç”¨å…±äº«åˆ†ç±»å™¨å°†ä½å±‚åé¦ˆä¼ é€’ç»™é«˜å±‚ï¼Œä»è€Œå®ç°è‡ªæˆ‘æ ¡æ­£ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šCHDæ¡†æ¶åŒ…æ‹¬é«˜å±‚å­ç›®æ ‡é€‰æ‹©æ¨¡å—å’Œä½å±‚è½¨è¿¹ç”Ÿæˆæ¨¡å—ï¼ŒäºŒè€…é€šè¿‡å…±äº«åˆ†ç±»å™¨ç´§å¯†è€¦åˆã€‚æ•´ä¸ªæµç¨‹ä¸ºï¼šé¦–å…ˆç”Ÿæˆé«˜å±‚å­ç›®æ ‡ï¼Œç„¶åæ ¹æ®è¿™äº›å­ç›®æ ‡ç”Ÿæˆä½å±‚è½¨è¿¹ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­ä¸æ–­è¿›è¡Œåé¦ˆå’Œæ ¡æ­£ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹åœ¨äºå®ç°äº†é«˜å±‚å’Œä½å±‚ä¹‹é—´çš„ç´§å¯†è€¦åˆï¼Œä½¿å¾—ä½å±‚çš„åé¦ˆèƒ½å¤Ÿç›´æ¥å½±å“é«˜å±‚çš„å†³ç­–ï¼Œä»è€Œæé«˜äº†è½¨è¿¹çš„ä¸€è‡´æ€§å’Œè§„åˆ’çš„æœ‰æ•ˆæ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨è®¾è®¡ä¸­ï¼Œé‡‡ç”¨äº†å…±äº«åˆ†ç±»å™¨æ¥ä¼ é€’ä½å±‚åé¦ˆï¼Œè®¾ç½®äº†é€‚å½“çš„æŸå¤±å‡½æ•°ä»¥ä¼˜åŒ–é«˜å±‚å’Œä½å±‚çš„ååŒå·¥ä½œï¼Œç½‘ç»œç»“æ„ä¸Šåˆ™é‡‡ç”¨äº†å±‚æ¬¡åŒ–çš„è®¾è®¡ä»¥ä¾¿äºå¤„ç†å¤æ‚ä»»åŠ¡ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœæ˜¾ç¤ºï¼ŒCHDåœ¨è¿·å®«å¯¼èˆªã€æ¡Œé¢æ“ä½œå’Œå®¶åº­ç¯å¢ƒä¸­çš„è¡¨ç°å‡ä¼˜äºå¹³é¢å’Œå±‚æ¬¡æ‰©æ•£åŸºçº¿ï¼Œå…·ä½“æå‡å¹…åº¦è¾¾åˆ°20%ä»¥ä¸Šï¼Œè¯æ˜äº†å…¶åœ¨é•¿æ—¶é—´ä»»åŠ¡è§„åˆ’ä¸­çš„æœ‰æ•ˆæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶çš„æ½œåœ¨åº”ç”¨é¢†åŸŸåŒ…æ‹¬æœºå™¨äººå¯¼èˆªã€è‡ªåŠ¨åŒ–æ“ä½œå’Œæ™ºèƒ½å®¶å±…ç³»ç»Ÿç­‰ã€‚é€šè¿‡æé«˜é•¿æ—¶é—´ä»»åŠ¡çš„è§„åˆ’èƒ½åŠ›ï¼ŒCHDæ¡†æ¶èƒ½å¤Ÿåœ¨å¤æ‚ç¯å¢ƒä¸­å®ç°æ›´é«˜æ•ˆçš„ä»»åŠ¡æ‰§è¡Œï¼Œå…·æœ‰é‡è¦çš„å®é™…ä»·å€¼å’Œå¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Diffusion-based planners have shown strong performance in short-horizon tasks but often fail in complex, long-horizon settings. We trace the failure to loose coupling between high-level (HL) sub-goal selection and low-level (LL) trajectory generation, which leads to incoherent plans and degraded performance. We propose Coupled Hierarchical Diffusion (CHD), a framework that models HL sub-goals and LL trajectories jointly within a unified diffusion process. A shared classifier passes LL feedback upstream so that sub-goals self-correct while sampling proceeds. This tight HL-LL coupling improves trajectory coherence and enables scalable long-horizon diffusion planning. Experiments across maze navigation, tabletop manipulation, and household environments show that CHD consistently outperforms both flat and hierarchical diffusion baselines. Our website is: https://sites.google.com/view/chd2025/home

