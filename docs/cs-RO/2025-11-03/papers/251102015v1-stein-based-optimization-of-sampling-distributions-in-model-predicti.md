---
layout: default
title: Stein-based Optimization of Sampling Distributions in Model Predictive Path Integral Control
---

# Stein-based Optimization of Sampling Distributions in Model Predictive Path Integral Control

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2511.02015" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2511.02015v1</a>
  <a href="https://arxiv.org/pdf/2511.02015.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2511.02015v1" data-paper-url="__CURRENT_PAGE__" onclick="toggleFavorite(this, '2511.02015v1', 'Stein-based Optimization of Sampling Distributions in Model Predictive Path Integral Control')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Jace Aldrich, Odest Chadwicke Jenkins

**åˆ†ç±»**: cs.RO

**å‘å¸ƒæ—¥æœŸ**: 2025-11-03

**å¤‡æ³¨**: 8 pages, 6 figures

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºSteinå˜åˆ†æ¢¯åº¦ä¸‹é™çš„MPPIæ§åˆ¶ï¼Œä¼˜åŒ–é‡‡æ ·åˆ†å¸ƒä»¥æå‡è½¨è¿¹è§„åˆ’æ€§èƒ½ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)**

**å…³é”®è¯**: `æ¨¡å‹é¢„æµ‹æ§åˆ¶` `è·¯å¾„ç§¯åˆ†æ§åˆ¶` `Steinå˜åˆ†æ¢¯åº¦ä¸‹é™` `é‡‡æ ·ä¼˜åŒ–` `æœºå™¨äººæ§åˆ¶`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ä¼ ç»ŸMPPIä¾èµ–éšæœºé‡‡æ ·ï¼Œæ˜“å¯¼è‡´æ ·æœ¬åŒ®ä¹ï¼Œæ— æ³•å……åˆ†æ¢ç´¢è½¨è¿¹ç©ºé—´ï¼Œå½±å“æ§åˆ¶æ€§èƒ½ã€‚
2. è®ºæ–‡æå‡ºSOPPIï¼Œç»“åˆSVGDåŠ¨æ€æ›´æ–°å™ªå£°åˆ†å¸ƒï¼Œä¼˜åŒ–é‡‡æ ·è¿‡ç¨‹ï¼Œæå‡è½¨è¿¹è¡¨ç¤ºè´¨é‡ã€‚
3. å®éªŒè¡¨æ˜ï¼ŒSOPPIåœ¨å€’ç«‹æ‘†å’ŒåŒè¶³è¡Œèµ°ç­‰ä»»åŠ¡ä¸­ï¼Œæ€§èƒ½ä¼˜äºæ ‡å‡†MPPIï¼Œä¸”é™ä½äº†ç²’å­æ•°é‡éœ€æ±‚ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°é¢–çš„åŸºäºæ¨¡å‹é¢„æµ‹è·¯å¾„ç§¯åˆ†ï¼ˆMPPIï¼‰æ§åˆ¶æ–¹æ³•ï¼Œè¯¥æ–¹æ³•é€šè¿‡Steinå˜åˆ†æ¢¯åº¦ä¸‹é™ï¼ˆSVGDï¼‰ä¼˜åŒ–é‡‡æ ·ç”Ÿæˆï¼Œä½¿å…¶æ›´æ¥è¿‘æœ€ä¼˜è½¨è¿¹ã€‚ä¼ ç»Ÿçš„MPPIä¾èµ–äºéšæœºé‡‡æ ·çš„è½¨è¿¹ï¼Œé€šå¸¸æ˜¯é«˜æ–¯åˆ†å¸ƒã€‚è¿™å¯èƒ½å¯¼è‡´æ ·æœ¬åŒ®ä¹ï¼Œå¯¹å¯èƒ½çš„è½¨è¿¹ç©ºé—´è¡¨ç¤ºä¸è¶³ï¼Œå¹¶äº§ç”Ÿæ¬¡ä¼˜ç»“æœã€‚é€šè¿‡åœ¨MPPIç¯å¢ƒæ­¥éª¤ä¹‹é—´å¼•å…¥SVGDæ›´æ–°ï¼Œæˆ‘ä»¬æå‡ºäº†Steinä¼˜åŒ–è·¯å¾„ç§¯åˆ†æ¨ç†ï¼ˆSOPPIï¼‰ï¼Œè¿™æ˜¯ä¸€ç§MPPI/SVGDç®—æ³•ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ›´æ–°å™ªå£°åˆ†å¸ƒï¼Œä»¥å¡‘é€ æ›´ä¼˜çš„è¡¨ç¤ºï¼Œè€Œä¸ä¼šè¿‡åº¦å¢åŠ è®¡ç®—éœ€æ±‚ã€‚æˆ‘ä»¬é€šè¿‡ä»å€’ç«‹æ‘†åˆ°äºŒç»´åŒè¶³è¡Œèµ°ä»»åŠ¡çš„ç³»ç»Ÿæ¼”ç¤ºäº†æˆ‘ä»¬æ–¹æ³•çš„æœ‰æ•ˆæ€§ï¼Œè¡¨æ˜åœ¨å„ç§è¶…å‚æ•°ä¸‹ï¼Œæ€§èƒ½ä¼˜äºæ ‡å‡†MPPIï¼Œå¹¶è¯æ˜äº†åœ¨è¾ƒä½ç²’å­æ•°ä¸‹çš„å¯è¡Œæ€§ã€‚æˆ‘ä»¬è®¨è®ºäº†è¿™ç§MPPI/SVGDæ–¹æ³•å¯¹æ›´é«˜è‡ªç”±åº¦ç³»ç»Ÿçš„é€‚ç”¨æ€§ï¼Œä»¥åŠå…¶å¯¹æœ€å…ˆè¿›çš„å¯å¾®æ¨¡æ‹Ÿå™¨çš„æ–°å‘å±•çš„æ½œåŠ›ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³æ¨¡å‹é¢„æµ‹è·¯å¾„ç§¯åˆ†æ§åˆ¶ï¼ˆMPPIï¼‰ä¸­ï¼Œç”±äºä¾èµ–éšæœºé‡‡æ ·å¯¼è‡´æ ·æœ¬åŒ®ä¹ï¼Œè½¨è¿¹ç©ºé—´æ¢ç´¢ä¸è¶³ï¼Œæœ€ç»ˆå½±å“æ§åˆ¶æ€§èƒ½çš„é—®é¢˜ã€‚ç°æœ‰MPPIæ–¹æ³•é€šå¸¸ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒè¿›è¡Œé‡‡æ ·ï¼Œéš¾ä»¥é€‚åº”å¤æ‚ç¯å¢ƒå’Œä»»åŠ¡ï¼Œå¯¼è‡´æ¬¡ä¼˜çš„æ§åˆ¶ç»“æœã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨Steinå˜åˆ†æ¢¯åº¦ä¸‹é™ï¼ˆSVGDï¼‰æ¥ä¼˜åŒ–MPPIä¸­çš„é‡‡æ ·åˆ†å¸ƒã€‚SVGDé€šè¿‡è¿­ä»£åœ°æ›´æ–°é‡‡æ ·ç²’å­ï¼Œä½¿å…¶é€¼è¿‘ç›®æ ‡åˆ†å¸ƒï¼Œä»è€Œæ›´æœ‰æ•ˆåœ°æ¢ç´¢è½¨è¿¹ç©ºé—´ï¼Œæé«˜æ§åˆ¶æ€§èƒ½ã€‚é€šè¿‡åœ¨MPPIçš„è¿­ä»£è¿‡ç¨‹ä¸­å¼•å…¥SVGDï¼Œå¯ä»¥åŠ¨æ€åœ°è°ƒæ•´é‡‡æ ·åˆ†å¸ƒï¼Œä½¿å…¶æ›´å¥½åœ°é€‚åº”å½“å‰çš„çŠ¶æ€å’Œç¯å¢ƒã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šSOPPIç®—æ³•çš„æ•´ä½“æ¡†æ¶æ˜¯åœ¨æ ‡å‡†çš„MPPIæ§åˆ¶å¾ªç¯ä¸­ï¼Œåœ¨ç¯å¢ƒæ­¥éª¤ä¹‹é—´æ’å…¥SVGDæ›´æ–°æ­¥éª¤ã€‚å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š1) ä½¿ç”¨å½“å‰çš„é‡‡æ ·åˆ†å¸ƒç”Ÿæˆä¸€ç»„è½¨è¿¹æ ·æœ¬ï¼›2) æ ¹æ®MPPIçš„æˆæœ¬å‡½æ•°å¯¹è¿™äº›è½¨è¿¹è¿›è¡Œè¯„ä¼°ï¼›3) ä½¿ç”¨SVGDç®—æ³•ï¼Œæ ¹æ®æˆæœ¬å‡½æ•°çš„æ¢¯åº¦ä¿¡æ¯ï¼Œæ›´æ–°é‡‡æ ·åˆ†å¸ƒï¼›4) ä½¿ç”¨æ›´æ–°åçš„é‡‡æ ·åˆ†å¸ƒï¼Œé‡å¤æ­¥éª¤1-3ï¼Œç›´åˆ°è¾¾åˆ°æ§åˆ¶ç›®æ ‡ã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºå°†SVGDå¼•å…¥åˆ°MPPIæ§åˆ¶ä¸­ï¼Œå®ç°äº†é‡‡æ ·åˆ†å¸ƒçš„åŠ¨æ€ä¼˜åŒ–ã€‚ä¸ä¼ ç»Ÿçš„MPPIæ–¹æ³•ç›¸æ¯”ï¼ŒSOPPIèƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°æ¢ç´¢è½¨è¿¹ç©ºé—´ï¼Œæé«˜æ§åˆ¶æ€§èƒ½ï¼Œå¹¶ä¸”å¯ä»¥åœ¨è¾ƒä½çš„ç²’å­æ•°é‡ä¸‹å®ç°è¾ƒå¥½çš„æ•ˆæœã€‚æ­¤å¤–ï¼Œè¯¥æ–¹æ³•å…·æœ‰è¾ƒå¼ºçš„é€šç”¨æ€§ï¼Œå¯ä»¥åº”ç”¨äºå„ç§ä¸åŒçš„æ§åˆ¶ä»»åŠ¡ã€‚

**å…³é”®è®¾è®¡**ï¼šSOPPIç®—æ³•çš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) SVGDçš„æ ¸å‡½æ•°é€‰æ‹©ï¼Œè®ºæ–‡å¯èƒ½é‡‡ç”¨äº†å¸¸ç”¨çš„é«˜æ–¯æ ¸å‡½æ•°ï¼›2) SVGDçš„æ­¥é•¿é€‰æ‹©ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„ä»»åŠ¡è¿›è¡Œè°ƒæ•´ï¼›3) MPPIçš„æˆæœ¬å‡½æ•°è®¾è®¡ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„æ§åˆ¶ç›®æ ‡è¿›è¡Œè®¾è®¡ï¼›4) SVGDæ›´æ–°é¢‘ç‡ï¼Œéœ€è¦åœ¨è®¡ç®—å¤æ‚åº¦å’Œä¼˜åŒ–æ•ˆæœä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼ŒSOPPIåœ¨å€’ç«‹æ‘†å’ŒäºŒç»´åŒè¶³è¡Œèµ°ä»»åŠ¡ä¸­ï¼Œæ€§èƒ½ä¼˜äºæ ‡å‡†MPPIã€‚å…·ä½“è€Œè¨€ï¼ŒSOPPIèƒ½å¤Ÿæ›´å¿«åœ°ç¨³å®šå€’ç«‹æ‘†ï¼Œå¹¶å®ç°æ›´ç¨³å®šçš„åŒè¶³è¡Œèµ°ã€‚æ­¤å¤–ï¼ŒSOPPIåœ¨è¾ƒä½çš„ç²’å­æ•°é‡ä¸‹ä¹Ÿèƒ½å–å¾—è¾ƒå¥½çš„æ•ˆæœï¼Œé™ä½äº†è®¡ç®—æˆæœ¬ã€‚åœ¨ç›¸åŒçš„è®¡ç®—èµ„æºä¸‹ï¼ŒSOPPIèƒ½å¤Ÿæ¢ç´¢æ›´ä¼˜çš„è½¨è¿¹ï¼Œä»è€Œæé«˜æ§åˆ¶æ€§èƒ½ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºæœºå™¨äººè¿åŠ¨è§„åˆ’ã€è‡ªåŠ¨é©¾é©¶ã€æ— äººæœºæ§åˆ¶ç­‰é¢†åŸŸã€‚é€šè¿‡ä¼˜åŒ–é‡‡æ ·åˆ†å¸ƒï¼Œå¯ä»¥æé«˜æ§åˆ¶ç³»ç»Ÿçš„é²æ£’æ€§å’Œæ•ˆç‡ï¼Œä½¿å…¶èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”å¤æ‚ç¯å¢ƒå’Œä»»åŠ¡éœ€æ±‚ã€‚æœªæ¥ï¼Œè¯¥æ–¹æ³•æœ‰æœ›åº”ç”¨äºé«˜è‡ªç”±åº¦æœºå™¨äººå’Œå¤æ‚åœ°å½¢çš„è¿åŠ¨æ§åˆ¶ï¼Œä»¥åŠå¼ºåŒ–å­¦ä¹ ä¸­çš„ç­–ç•¥ä¼˜åŒ–ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> This paper presents a novel method for Model Predictive Path Integral (MPPI) control that optimizes sample generation towards an optimal trajectory through Stein Variational Gradient Descent (SVGD). MPPI is traditionally reliant on randomly sampled trajectories, often by a Gaussian distribution. The result can lead to sample deprivation, under-representing the space of possible trajectories, and yield suboptimal results. Through introducing SVGD updates in between MPPI environment steps, we present Stein-Optimized Path-Integral Inference (SOPPI), an MPPI/SVGD algorithm that can dynamically update noise distributions at runtime to shape a more optimal representation without an excessive increase in computational requirements. We demonstrate the efficacy of our method systems ranging from a Cart-Pole to a two-dimensional bipedal walking task, indicating improved performance above standard MPPI across a range of hyper-parameters and demonstrate feasibility at lower particle counts. We discuss the applicability of this MPPI/SVGD method to higher degree-of-freedom systems, as well as its potential to new developments in state-of-the-art differentiable simulators.

