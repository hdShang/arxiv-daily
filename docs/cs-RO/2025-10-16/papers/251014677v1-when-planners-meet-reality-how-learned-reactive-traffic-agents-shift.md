---
layout: default
title: When Planners Meet Reality: How Learned, Reactive Traffic Agents Shift nuPlan Benchmarks
---

# When Planners Meet Reality: How Learned, Reactive Traffic Agents Shift nuPlan Benchmarks

<div class="paper-toolbar">
  <div class="toolbar-left">
    <a href="https://arxiv.org/abs/2510.14677" target="_blank" class="toolbar-btn">arXiv: 2510.14677v1</a>
    <a href="https://arxiv.org/pdf/2510.14677.pdf" target="_blank" class="toolbar-btn">PDF</a>
  </div>
  <div class="toolbar-right">
    <button class="toolbar-btn favorite-btn" data-arxiv-id="2510.14677v1" 
            onclick="toggleFavorite(this, '2510.14677v1', 'When Planners Meet Reality: How Learned, Reactive Traffic Agents Shift nuPlan Benchmarks')" title="æ”¶è—">
      â˜† æ”¶è—
    </button>
    <button class="toolbar-btn share-btn" onclick="copyLink()" title="å¤åˆ¶é“¾æ¥">
      ğŸ”— åˆ†äº«
    </button>
  </div>
</div>


**ä½œè€…**: Steffen Hagedorn, Luka Donkov, Aron Distelzweig, Alexandru P. Condurache

**åˆ†ç±»**: cs.RO, cs.AI, cs.LG, cs.MA

**å‘å¸ƒæ—¥æœŸ**: 2025-10-16

**ğŸ”— ä»£ç /é¡¹ç›®**: [GITHUB](https://github.com/shgd95/InteractiveClosedLoop)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**å¼•å…¥SMARTæ™ºèƒ½ä½“ï¼Œæå‡nuPlanè‡ªåŠ¨é©¾é©¶è§„åˆ’å™¨è¯„ä¼°çš„çœŸå®æ€§å’Œå¯é æ€§**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)**

**å…³é”®è¯**: `è‡ªåŠ¨é©¾é©¶` `è§„åˆ’å™¨è¯„ä¼°` `äº¤é€šä»¿çœŸ` `æ™ºèƒ½äº¤é€šæ™ºèƒ½ä½“` `é—­ç¯ä»¿çœŸ`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰nuPlanè¯„ä¼°ä¾èµ–çš„IDMäº¤é€šæ™ºèƒ½ä½“è¿‡äºç®€å•ï¼Œæ— æ³•çœŸå®åæ˜ å¤æ‚äº¤é€šäº¤äº’ï¼Œå¯¼è‡´è§„åˆ’å™¨è¯„ä¼°å­˜åœ¨åå·®ã€‚
2. é€šè¿‡é›†æˆå…ˆè¿›çš„SMARTæ™ºèƒ½ä½“åˆ°nuPlanï¼Œè®ºæ–‡æ—¨åœ¨æä¾›æ›´çœŸå®çš„é—­ç¯ä»¿çœŸç¯å¢ƒï¼Œä»è€Œæ›´å‡†ç¡®åœ°è¯„ä¼°è‡ªåŠ¨é©¾é©¶è§„åˆ’å™¨ã€‚
3. å®éªŒè¡¨æ˜ï¼Œä½¿ç”¨SMARTæ™ºèƒ½ä½“è¯„ä¼°åï¼Œå¤šæ•°è§„åˆ’å™¨æ€§èƒ½ä¸‹é™ï¼Œä½†åœ¨äº¤äº’åœºæ™¯ä¸­è¡¨ç°å‡ºæ¯”é¢„æœŸæ›´å¥½çš„æ€§èƒ½ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

åœ¨é—­ç¯ä»¿çœŸä¸­è¯„ä¼°è‡ªåŠ¨é©¾é©¶è§„åˆ’å™¨æ—¶ï¼Œé€šå¸¸ä½¿ç”¨åŸºäºè§„åˆ™çš„äº¤é€šæ™ºèƒ½ä½“ã€‚è¿™äº›æ™ºèƒ½ä½“çš„è¡Œä¸ºè¿‡äºç®€å•å’Œè¢«åŠ¨ï¼Œå¯èƒ½æ©ç›–è§„åˆ’å™¨çš„ç¼ºé™·å¹¶å¯¼è‡´è¯„ä¼°ç»“æœäº§ç”Ÿåå·®ã€‚ä¾‹å¦‚ï¼Œå¹¿æ³›ä½¿ç”¨çš„IDMæ™ºèƒ½ä½“åªèƒ½è·Ÿéšå‰è½¦ï¼Œæ— æ³•å¯¹ç›¸é‚»è½¦é“çš„è½¦è¾†åšå‡ºååº”ï¼Œä»è€Œé™åˆ¶äº†å¯¹å¤æ‚äº¤äº’èƒ½åŠ›çš„æµ‹è¯•ã€‚æœ¬æ–‡é€šè¿‡å°†æœ€å…ˆè¿›çš„æ™ºèƒ½äº¤é€šæ™ºèƒ½ä½“æ¨¡å‹SMARTé›†æˆåˆ°nuPlanä¸­æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™æ˜¯é¦–æ¬¡åœ¨æ›´çœŸå®çš„æ¡ä»¶ä¸‹è¯„ä¼°è§„åˆ’å™¨ï¼Œå¹¶é‡åŒ–ç¼©å°ä»¿çœŸä¸ç°å®å·®è·åç»“è®ºçš„å˜åŒ–ã€‚åˆ†ææ¶µç›–äº†14ä¸ªæœ€æ–°çš„è§„åˆ’å™¨å’Œå·²å»ºç«‹çš„åŸºçº¿ï¼Œç»“æœè¡¨æ˜ï¼ŒåŸºäºIDMçš„ä»¿çœŸä¼šé«˜ä¼°è§„åˆ’æ€§èƒ½ï¼šå‡ ä¹æ‰€æœ‰åˆ†æ•°éƒ½æœ‰æ‰€ä¸‹é™ã€‚ç›¸åï¼Œè®¸å¤šè§„åˆ’å™¨çš„äº¤äº’æ€§èƒ½ä¼˜äºä¹‹å‰çš„å‡è®¾ï¼Œç”šè‡³åœ¨å¤šè½¦é“ã€äº¤äº’å¯†é›†çš„åœºæ™¯ï¼ˆå¦‚å˜é“æˆ–è½¬å¼¯ï¼‰ä¸­æœ‰æ‰€æ”¹å–„ã€‚åœ¨é—­ç¯ä¸­è®­ç»ƒçš„æ–¹æ³•è¡¨ç°å‡ºæœ€å¥½å’Œæœ€ç¨³å®šçš„é©¾é©¶æ€§èƒ½ã€‚ç„¶è€Œï¼Œå½“åœ¨å¢å¼ºçš„æç«¯åœºæ™¯ä¸­è¾¾åˆ°æé™æ—¶ï¼Œæ‰€æœ‰å­¦ä¹ åˆ°çš„è§„åˆ’å™¨éƒ½ä¼šçªç„¶é€€åŒ–ï¼Œè€ŒåŸºäºè§„åˆ™çš„è§„åˆ’å™¨åˆ™ä¿æŒåˆç†çš„è¡Œä¸ºã€‚åŸºäºè¿™äº›ç»“æœï¼Œå»ºè®®å°†SMARTååº”å¼ä»¿çœŸä½œä¸ºnuPlanä¸­æ–°çš„æ ‡å‡†é—­ç¯åŸºå‡†ï¼Œå¹¶å‘å¸ƒSMARTæ™ºèƒ½ä½“ä½œä¸ºIDMçš„ç›´æ¥æ›¿ä»£å“ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šç°æœ‰è‡ªåŠ¨é©¾é©¶è§„åˆ’å™¨åœ¨nuPlanç­‰ä»¿çœŸå¹³å°ä¸Šçš„è¯„ä¼°ï¼Œä¾èµ–äºåŸºäºè§„åˆ™çš„äº¤é€šæ™ºèƒ½ä½“ï¼ˆå¦‚IDMï¼‰ã€‚è¿™äº›æ™ºèƒ½ä½“è¡Œä¸ºç®€å•ï¼Œç¼ºä¹çœŸå®äº¤é€šåœºæ™¯ä¸­çš„äº¤äº’æ€§å’Œååº”æ€§ï¼Œå¯¼è‡´è§„åˆ’å™¨åœ¨ä»¿çœŸç¯å¢ƒä¸­çš„è¡¨ç°å¯èƒ½è¢«é«˜ä¼°ï¼Œæ— æ³•å‡†ç¡®åæ˜ å…¶åœ¨çœŸå®ä¸–ç•Œä¸­çš„æ€§èƒ½ã€‚å°¤å…¶æ˜¯åœ¨éœ€è¦å¤æ‚äº¤äº’çš„åœºæ™¯ï¼ˆå¦‚å˜é“ã€è¶…è½¦ï¼‰ä¸­ï¼ŒIDMæ™ºèƒ½ä½“çš„å±€é™æ€§æ›´åŠ æ˜æ˜¾ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯ä½¿ç”¨æ›´å…ˆè¿›ã€æ›´çœŸå®çš„äº¤é€šæ™ºèƒ½ä½“æ¨¡å‹SMARTï¼Œæ›¿ä»£nuPlanä¸­åŸæœ‰çš„IDMæ™ºèƒ½ä½“ã€‚SMARTæ™ºèƒ½ä½“èƒ½å¤Ÿæ¨¡æ‹Ÿæ›´å¤æ‚çš„äº¤é€šè¡Œä¸ºï¼ŒåŒ…æ‹¬å¯¹å‘¨å›´è½¦è¾†çš„ååº”ã€è½¦é“ä¿æŒã€å˜é“ç­‰ï¼Œä»è€Œæä¾›æ›´æ¥è¿‘çœŸå®ä¸–ç•Œçš„ä»¿çœŸç¯å¢ƒã€‚é€šè¿‡åœ¨è¿™ç§æ›´çœŸå®çš„ä»¿çœŸç¯å¢ƒä¸­è¯„ä¼°è‡ªåŠ¨é©¾é©¶è§„åˆ’å™¨ï¼Œå¯ä»¥æ›´å‡†ç¡®åœ°äº†è§£å…¶æ€§èƒ½ï¼Œå¹¶å‘ç°æ½œåœ¨çš„é—®é¢˜ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥ç ”ç©¶çš„ä¸»è¦æŠ€æœ¯æ¡†æ¶åŒ…æ‹¬ï¼š1) å°†é¢„è®­ç»ƒçš„SMARTæ™ºèƒ½ä½“æ¨¡å‹é›†æˆåˆ°nuPlanä»¿çœŸå¹³å°ä¸­ï¼›2) ä½¿ç”¨é›†æˆäº†SMARTæ™ºèƒ½ä½“çš„nuPlanç¯å¢ƒï¼Œå¯¹14ä¸ªè‡ªåŠ¨é©¾é©¶è§„åˆ’å™¨è¿›è¡Œé—­ç¯è¯„ä¼°ï¼›3) å¯¹æ¯”ä½¿ç”¨SMARTæ™ºèƒ½ä½“å’ŒIDMæ™ºèƒ½ä½“è¯„ä¼°çš„ç»“æœï¼Œåˆ†æè§„åˆ’å™¨æ€§èƒ½çš„å˜åŒ–ã€‚æ•´ä½“æµç¨‹æ˜¯ä»ä»¿çœŸç¯å¢ƒæ”¹é€ åˆ°è§„åˆ’å™¨æ€§èƒ½è¯„ä¼°ï¼Œæœ€ç»ˆå¾—å‡ºç»“è®ºã€‚

**å…³é”®åˆ›æ–°**ï¼šè¯¥è®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºï¼š1) é¦–æ¬¡å°†å…ˆè¿›çš„SMARTæ™ºèƒ½ä½“æ¨¡å‹é›†æˆåˆ°nuPlanä»¿çœŸå¹³å°ä¸­ï¼Œæ˜¾è‘—æå‡äº†ä»¿çœŸç¯å¢ƒçš„çœŸå®æ€§ï¼›2) é€šè¿‡å¯¹æ¯”ä½¿ç”¨SMARTå’ŒIDMæ™ºèƒ½ä½“çš„è¯„ä¼°ç»“æœï¼Œé‡åŒ–äº†ä»¿çœŸç¯å¢ƒçœŸå®æ€§å¯¹è§„åˆ’å™¨æ€§èƒ½è¯„ä¼°çš„å½±å“ï¼Œæ­ç¤ºäº†IDMæ™ºèƒ½ä½“å¯èƒ½å¯¼è‡´çš„æ€§èƒ½é«˜ä¼°ï¼›3) æå‡ºäº†ä½¿ç”¨SMARTååº”å¼ä»¿çœŸä½œä¸ºnuPlanä¸­æ–°çš„æ ‡å‡†é—­ç¯åŸºå‡†çš„å»ºè®®ã€‚

**å…³é”®è®¾è®¡**ï¼šSMARTæ™ºèƒ½ä½“æœ¬èº«æ˜¯ä¸€ä¸ªé¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œè®ºæ–‡ä¸»è¦å…³æ³¨å¦‚ä½•å°†å…¶æœ‰æ•ˆåœ°é›†æˆåˆ°nuPlanä»¿çœŸç¯å¢ƒä¸­ã€‚å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ç¡®ä¿SMARTæ™ºèƒ½ä½“ä¸nuPlançš„æ¥å£å…¼å®¹ï¼Œèƒ½å¤Ÿæ¥æ”¶nuPlanæä¾›çš„ç¯å¢ƒä¿¡æ¯ï¼Œå¹¶è¾“å‡ºæ™ºèƒ½ä½“çš„è¡Œä¸ºå†³ç­–ï¼›2) è®¾è®¡åˆç†çš„è¯„ä¼°æŒ‡æ ‡ï¼Œä»¥é‡åŒ–è§„åˆ’å™¨åœ¨ä¸åŒä»¿çœŸç¯å¢ƒä¸‹çš„æ€§èƒ½è¡¨ç°ï¼Œä¾‹å¦‚å®‰å…¨æ€§ã€èˆ’é€‚æ€§ã€æ•ˆç‡ç­‰ï¼›3) é€šè¿‡è°ƒæ•´SMARTæ™ºèƒ½ä½“çš„å‚æ•°ï¼Œä½¿å…¶èƒ½å¤Ÿæ¨¡æ‹Ÿä¸åŒç±»å‹çš„é©¾é©¶è¡Œä¸ºï¼Œä¾‹å¦‚æ¿€è¿›å‹ã€ä¿å®ˆå‹ç­‰ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œä½¿ç”¨SMARTæ™ºèƒ½ä½“è¯„ä¼°åï¼Œå¤§å¤šæ•°è§„åˆ’å™¨çš„æ€§èƒ½æŒ‡æ ‡éƒ½æœ‰æ‰€ä¸‹é™ï¼Œè¿™è¡¨æ˜åŸºäºIDMçš„ä»¿çœŸç¯å¢ƒä¼šé«˜ä¼°è§„åˆ’å™¨çš„æ€§èƒ½ã€‚ç„¶è€Œï¼Œä¸€äº›è§„åˆ’å™¨åœ¨å¤šè½¦é“äº¤äº’åœºæ™¯ï¼ˆå¦‚å˜é“ï¼‰ä¸­çš„è¡¨ç°åè€Œæœ‰æ‰€æå‡ï¼Œè¯´æ˜è¿™äº›è§„åˆ’å™¨åœ¨å¤„ç†å¤æ‚äº¤äº’æ–¹é¢å…·æœ‰æ½œåŠ›ã€‚åœ¨æç«¯åœºæ™¯ä¸‹ï¼ŒåŸºäºå­¦ä¹ çš„è§„åˆ’å™¨æ€§èƒ½ä¼šçªç„¶ä¸‹é™ï¼Œè€ŒåŸºäºè§„åˆ™çš„è§„åˆ’å™¨åˆ™èƒ½ä¿æŒåŸºæœ¬è¡Œä¸ºã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºè‡ªåŠ¨é©¾é©¶ç³»ç»Ÿçš„å¼€å‘å’Œæµ‹è¯•ï¼Œé€šè¿‡æ›´çœŸå®çš„ä»¿çœŸç¯å¢ƒï¼Œå¯ä»¥æ›´æœ‰æ•ˆåœ°è¯„ä¼°å’Œæ”¹è¿›è‡ªåŠ¨é©¾é©¶è§„åˆ’å™¨çš„æ€§èƒ½ï¼Œé™ä½å®é™…é“è·¯æµ‹è¯•çš„é£é™©å’Œæˆæœ¬ã€‚æ­¤å¤–ï¼Œè¯¥ç ”ç©¶ä¹Ÿä¸ºå…¶ä»–ä»¿çœŸå¹³å°çš„äº¤é€šæ™ºèƒ½ä½“å»ºæ¨¡æä¾›äº†å‚è€ƒï¼Œæœ‰åŠ©äºæå‡è‡ªåŠ¨é©¾é©¶ä»¿çœŸæŠ€æœ¯çš„æ•´ä½“æ°´å¹³ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Planner evaluation in closed-loop simulation often uses rule-based traffic agents, whose simplistic and passive behavior can hide planner deficiencies and bias rankings. Widely used IDM agents simply follow a lead vehicle and cannot react to vehicles in adjacent lanes, hindering tests of complex interaction capabilities. We address this issue by integrating the state-of-the-art learned traffic agent model SMART into nuPlan. Thus, we are the first to evaluate planners under more realistic conditions and quantify how conclusions shift when narrowing the sim-to-real gap. Our analysis covers 14 recent planners and established baselines and shows that IDM-based simulation overestimates planning performance: nearly all scores deteriorate. In contrast, many planners interact better than previously assumed and even improve in multi-lane, interaction-heavy scenarios like lane changes or turns. Methods trained in closed-loop demonstrate the best and most stable driving performance. However, when reaching their limits in augmented edge-case scenarios, all learned planners degrade abruptly, whereas rule-based planners maintain reasonable basic behavior. Based on our results, we suggest SMART-reactive simulation as a new standard closed-loop benchmark in nuPlan and release the SMART agents as a drop-in alternative to IDM at https://github.com/shgd95/InteractiveClosedLoop.

