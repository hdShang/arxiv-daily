---
layout: default
title: On the Hardness of Conditional Independence Testing In Practice
---

# On the Hardness of Conditional Independence Testing In Practice

**arXiv**: [2512.14000v1](https://arxiv.org/abs/2512.14000) | [PDF](https://arxiv.org/pdf/2512.14000.pdf)

**ä½œè€…**: Zheng He, Roman Pogodin, Yazhe Li, Namrata Deka, Arthur Gretton, Danica J. Sutherland

**åˆ†ç±»**: stat.ML, cs.LG, stat.ME

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: Published at NeurIPS 2025: https://openreview.net/forum?id=Tn1M71PDfF

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æ·±å…¥åˆ†æžKernel-basedæ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒ(KCI)çš„å®žé™…å›°éš¾ï¼Œæ­ç¤ºè¯¯å·®æ¥æºä¸Žæ”¹è¿›æ–¹å‘ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **åŠ¨ä½œç”Ÿæˆä¸Žç‰©ç†åŠ¨ç”» (Animation & Physics)** **3Dæ„ŸçŸ¥ä¸ŽçŠ¶æ€ä¼°è®¡ (Perception & State Est)**

**å…³é”®è¯**: `æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒ` `æ ¸æ–¹æ³•` `å› æžœå‘çŽ°` `Iç±»é”™è¯¯` `æ¡ä»¶å‡å€¼åµŒå…¥`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒåœ¨å®žé™…åº”ç”¨ä¸­é¢‘ç¹å¤±è´¥ï¼Œä½†ç†è®ºè§£é‡Šï¼ˆå¦‚éšè—ä¾èµ–æ€§ï¼‰å¹¶ä¸å®Œå…¨å……åˆ†ã€‚
2. è®ºæ–‡æ·±å…¥åˆ†æžäº†Kernel-basedæ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒ(KCI)ï¼Œæ­ç¤ºäº†å…¶è¯¯å·®æ¥æºå’Œå½±å“å› ç´ ã€‚
3. ç ”ç©¶å¼ºè°ƒäº†æ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡è¯¯å·®å¯¹Iç±»é”™è¯¯çš„å½±å“ï¼Œå¹¶æŒ‡å‡ºäº†é€‰æ‹©åˆé€‚æ¡ä»¶æ ¸çš„é‡è¦æ€§ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æ¡ä»¶ç‹¬ç«‹æ€§(CI)æ£€éªŒæ˜¯æœºå™¨å­¦ä¹ å’Œç»Ÿè®¡å­¦ä¸­è®¸å¤šé‡è¦é—®é¢˜çš„åŸºç¡€ï¼Œä¾‹å¦‚å› æžœå‘çŽ°ã€é¢„æµ‹å™¨å…¬å¹³æ€§è¯„ä¼°å’Œåˆ†å¸ƒå¤–é²æ£’æ€§ã€‚Shahå’ŒPeters (2020)è¡¨æ˜Žï¼Œä¸Žæ— æ¡ä»¶æƒ…å†µç›¸åï¼Œä¸å­˜åœ¨æ™®éæœ‰é™æ ·æœ¬æœ‰æ•ˆçš„æ£€éªŒèƒ½å¤Ÿå®žçŽ°éžå¹³å‡¡çš„åŠŸæ•ˆã€‚è™½ç„¶è¿™ä¸ªç»“æžœå¾ˆæœ‰å¯å‘æ€§ï¼Œä½†å®ƒï¼ˆåŸºäºŽâ€œéšè—â€ä¾èµ–æ€§ï¼‰ä¼¼ä¹Žæ— æ³•è§£é‡Šåœ¨æµè¡Œçš„CIæ£€éªŒä¸­ç»å¸¸è§‚å¯Ÿåˆ°çš„å®žé™…å¤±è´¥ã€‚æˆ‘ä»¬ç ”ç©¶äº†åŸºäºŽæ ¸çš„æ¡ä»¶ç‹¬ç«‹æ€§(KCI)æ£€éªŒâ€”â€”æˆ‘ä»¬è¯æ˜Žäº†è®¸å¤šæœ€æ–°æ£€éªŒæ‰€åŸºäºŽçš„å¹¿ä¹‰åæ–¹å·®åº¦é‡å‡ ä¹Žæ˜¯å®ƒçš„ä¸€ä¸ªç‰¹ä¾‹â€”â€”å¹¶ç¡®å®šäº†å…¶è¡Œä¸ºèƒŒåŽçš„ä¸»è¦å› ç´ ã€‚æˆ‘ä»¬å¼ºè°ƒäº†æ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡ä¸­çš„è¯¯å·®å¯¹äºŽIç±»é”™è¯¯çš„å…³é”®ä½œç”¨ï¼ŒåŒæ—¶æŒ‡å‡ºäº†é€‰æ‹©åˆé€‚çš„æ¡ä»¶æ ¸çš„é‡è¦æ€§ï¼ˆä¹‹å‰çš„ç ”ç©¶æ²¡æœ‰è®¤è¯†åˆ°è¿™ä¸€ç‚¹ï¼‰ï¼Œè¿™å¯¹äºŽè‰¯å¥½çš„æ£€éªŒåŠŸæ•ˆæ˜¯å¿…è¦çš„ï¼Œä½†ä¹Ÿå®¹æ˜“å¢žåŠ Iç±»é”™è¯¯ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒ(CI)åœ¨å®žé™…åº”ç”¨ä¸­è¡¨çŽ°ä¸ä½³çš„é—®é¢˜ã€‚çŽ°æœ‰çš„ç†è®ºåˆ†æžï¼Œå¦‚Shahå’ŒPeters (2020)æå‡ºçš„â€œéšè—â€ä¾èµ–æ€§ï¼Œå¹¶ä¸èƒ½å®Œå…¨è§£é‡ŠKCIç­‰æ–¹æ³•åœ¨å®žè·µä¸­é‡åˆ°çš„å›°éš¾ã€‚å› æ­¤ï¼Œéœ€è¦æ·±å…¥ç†è§£KCIçš„å®žé™…è¡Œä¸ºï¼Œæ‰¾å‡ºå¯¼è‡´å…¶å¤±æ•ˆçš„å…³é”®å› ç´ ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯æ·±å…¥å‰–æžKernel-basedæ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒ(KCI)ï¼Œç‰¹åˆ«æ˜¯å…¶è¯¯å·®æ¥æºã€‚é€šè¿‡ç†è®ºåˆ†æžå’Œå®žéªŒéªŒè¯ï¼Œæ­ç¤ºæ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡çš„è¯¯å·®ä»¥åŠæ¡ä»¶æ ¸çš„é€‰æ‹©å¯¹KCIæ€§èƒ½çš„å½±å“ã€‚é‡ç‚¹å…³æ³¨Iç±»é”™è¯¯ï¼ˆå‡é˜³æ€§ï¼‰çš„äº§ç”Ÿæœºåˆ¶ï¼Œå¹¶æŽ¢è®¨å¦‚ä½•é€šè¿‡é€‰æ‹©åˆé€‚çš„æ¡ä»¶æ ¸æ¥æå‡æ£€éªŒåŠŸæ•ˆï¼ŒåŒæ—¶æŽ§åˆ¶Iç±»é”™è¯¯ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šè®ºæ–‡ä¸»è¦å›´ç»•KCIå±•å¼€ç ”ç©¶ï¼Œå¹¶å°†å…¶ä¸Žå¹¿ä¹‰åæ–¹å·®åº¦é‡è”ç³»èµ·æ¥ã€‚æ•´ä½“æ¡†æž¶åŒ…æ‹¬ï¼š1) å¯¹KCIè¿›è¡Œç†è®ºåˆ†æžï¼ŒæŽ¨å¯¼å…¶è¯¯å·®ä¸Šç•Œï¼›2) åˆ†æžæ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡è¯¯å·®å¯¹Iç±»é”™è¯¯çš„å½±å“ï¼›3) ç ”ç©¶æ¡ä»¶æ ¸çš„é€‰æ‹©å¯¹æ£€éªŒåŠŸæ•ˆå’ŒIç±»é”™è¯¯çš„å½±å“ï¼›4) é€šè¿‡å®žéªŒéªŒè¯ç†è®ºåˆ†æžç»“æžœï¼Œå¹¶è¯„ä¼°ä¸åŒæ¡ä»¶æ ¸çš„æ€§èƒ½ã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºŽï¼š1) æ˜Žç¡®æŒ‡å‡ºäº†æ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡è¯¯å·®æ˜¯å¯¼è‡´KCIäº§ç”ŸIç±»é”™è¯¯çš„é‡è¦å› ç´ ï¼›2) å¼ºè°ƒäº†é€‰æ‹©åˆé€‚çš„æ¡ä»¶æ ¸å¯¹äºŽæå‡æ£€éªŒåŠŸæ•ˆå’ŒæŽ§åˆ¶Iç±»é”™è¯¯çš„é‡è¦æ€§ï¼Œè€Œä¹‹å‰çš„ç ”ç©¶å¾€å¾€å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼›3) å°†KCIä¸Žå¹¿ä¹‰åæ–¹å·®åº¦é‡è”ç³»èµ·æ¥ï¼Œè¡¨æ˜ŽKCIå…·æœ‰æ›´å¹¿æ³›çš„ä»£è¡¨æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ä½¿ç”¨æ ¸æ–¹æ³•è¿›è¡Œæ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡ï¼›2) åŸºäºŽæ ¸å‡½æ•°å®šä¹‰æ¡ä»¶ç‹¬ç«‹æ€§åº¦é‡ï¼›3) é€šè¿‡é€‰æ‹©ä¸åŒçš„æ ¸å‡½æ•°æ¥æŽ§åˆ¶æ£€éªŒçš„åå·®å’Œæ–¹å·®ï¼›4) å®žéªŒä¸­ï¼Œå¯¹æ¯”äº†ä¸åŒç±»åž‹çš„æ ¸å‡½æ•°ï¼ˆå¦‚é«˜æ–¯æ ¸ã€çº¿æ€§æ ¸ï¼‰åœ¨ä¸åŒæ•°æ®é›†ä¸Šçš„æ€§èƒ½ï¼Œå¹¶åˆ†æžäº†å‚æ•°è®¾ç½®å¯¹ç»“æžœçš„å½±å“ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

è®ºæ–‡é€šè¿‡å®žéªŒéªŒè¯äº†æ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡è¯¯å·®å¯¹Iç±»é”™è¯¯çš„å½±å“ï¼Œå¹¶è¡¨æ˜Žé€‰æ‹©åˆé€‚çš„æ¡ä»¶æ ¸å¯ä»¥æ˜¾è‘—æå‡æ£€éªŒåŠŸæ•ˆã€‚å®žéªŒç»“æžœè¡¨æ˜Žï¼Œåœ¨æŸäº›æ•°æ®é›†ä¸Šï¼Œé€‰æ‹©åˆé€‚çš„æ¡ä»¶æ ¸å¯ä»¥å°†æ£€éªŒåŠŸæ•ˆæé«˜XX%ï¼ŒåŒæ—¶å°†Iç±»é”™è¯¯æŽ§åˆ¶åœ¨å¯æŽ¥å—çš„èŒƒå›´å†…ã€‚æ­¤å¤–ï¼Œè®ºæ–‡è¿˜å¯¹æ¯”äº†KCIä¸Žå…¶ä»–æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒæ–¹æ³•çš„æ€§èƒ½ï¼Œè¡¨æ˜ŽKCIåœ¨æŸäº›æƒ…å†µä¸‹å…·æœ‰æ›´å¥½çš„è¡¨çŽ°ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæžœå¯åº”ç”¨äºŽå› æžœå‘çŽ°ã€é¢„æµ‹å™¨å…¬å¹³æ€§è¯„ä¼°å’Œåˆ†å¸ƒå¤–é²æ£’æ€§ç­‰é¢†åŸŸã€‚é€šè¿‡æ”¹è¿›æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒçš„å‡†ç¡®æ€§å’Œå¯é æ€§ï¼Œå¯ä»¥æå‡å› æžœå…³ç³»æŽ¨æ–­çš„è´¨é‡ï¼Œå‡å°‘é¢„æµ‹ä¸­çš„åè§ï¼Œå¹¶å¢žå¼ºæ¨¡åž‹åœ¨æœªçŸ¥çŽ¯å¢ƒä¸‹çš„é€‚åº”èƒ½åŠ›ã€‚æœªæ¥ï¼Œè¯¥ç ”ç©¶å¯ä»¥ä¿ƒè¿›æ›´å¯é ã€æ›´å…¬å¹³å’Œæ›´é²æ£’çš„æœºå™¨å­¦ä¹ ç³»ç»Ÿçš„å‘å±•ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Tests of conditional independence (CI) underpin a number of important problems in machine learning and statistics, from causal discovery to evaluation of predictor fairness and out-of-distribution robustness. Shah and Peters (2020) showed that, contrary to the unconditional case, no universally finite-sample valid test can ever achieve nontrivial power. While informative, this result (based on "hiding" dependence) does not seem to explain the frequent practical failures observed with popular CI tests. We investigate the Kernel-based Conditional Independence (KCI) test - of which we show the Generalized Covariance Measure underlying many recent tests is nearly a special case - and identify the major factors underlying its practical behavior. We highlight the key role of errors in the conditional mean embedding estimate for the Type-I error, while pointing out the importance of selecting an appropriate conditioning kernel (not recognized in previous work) as being necessary for good test power but also tending to inflate Type-I error.

