---
layout: default
title: On the Hardness of Conditional Independence Testing In Practice
---

# On the Hardness of Conditional Independence Testing In Practice

**arXiv**: [2512.14000v1](https://arxiv.org/abs/2512.14000) | [PDF](https://arxiv.org/pdf/2512.14000.pdf)

**ä½œè€…**: Zheng He, Roman Pogodin, Yazhe Li, Namrata Deka, Arthur Gretton, Danica J. Sutherland

**åˆ†ç±»**: stat.ML, cs.LG, stat.ME

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

**å¤‡æ³¨**: Published at NeurIPS 2025: https://openreview.net/forum?id=Tn1M71PDfF

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æ­ç¤ºKCIæµ‹è¯•åœ¨å®žè·µä¸­å¤±æ•ˆçš„å…³é”®å› ç´ ï¼Œæå‡ºæ¡ä»¶æ ¸é€‰æ‹©å¯¹Iåž‹é”™è¯¯å’Œæ£€éªŒåŠŸæ•ˆçš„å¹³è¡¡æœºåˆ¶**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **è§†è§‰é‡Œç¨‹è®¡** **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒ` `æ ¸æ–¹æ³•` `Iåž‹é”™è¯¯æŽ§åˆ¶` `æ£€éªŒåŠŸæ•ˆ` `æ¡ä»¶å‡å€¼åµŒå…¥` `å› æžœå‘çŽ°` `æœºå™¨å­¦ä¹ å…¬å¹³æ€§` `åˆ†å¸ƒå¤–é²æ£’æ€§`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒåœ¨å®žè·µä¸­é¢‘ç¹å¤±æ•ˆï¼ŒShahå’ŒPetersçš„ç†è®ºç»“æžœæœªèƒ½å®Œå…¨è§£é‡Šè¿™ä¸€çŽ°è±¡ã€‚
2. è®ºæ–‡èšç„¦KCIæ£€éªŒï¼Œè¯†åˆ«æ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡è¯¯å·®å’Œæ¡ä»¶æ ¸é€‰æ‹©æ˜¯å½±å“Iåž‹é”™è¯¯å’Œæ£€éªŒåŠŸæ•ˆçš„å…³é”®å› ç´ ã€‚
3. å®žéªŒè¡¨æ˜Žï¼Œæ¡ä»¶æ ¸é€‰æ‹©å¯¹å¹³è¡¡æ£€éªŒåŠŸæ•ˆå’ŒIåž‹é”™è¯¯è‡³å…³é‡è¦ï¼Œä¸ºæ”¹è¿›å®žé™…æ£€éªŒæä¾›äº†æ–°æ–¹å‘ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒåœ¨æœºå™¨å­¦ä¹ å’Œç»Ÿè®¡å­¦ä¸­å…·æœ‰é‡è¦ä½œç”¨ï¼Œæ”¯æ’‘ç€ä»Žå› æžœå‘çŽ°åˆ°é¢„æµ‹å™¨å…¬å¹³æ€§å’Œåˆ†å¸ƒå¤–é²æ£’æ€§è¯„ä¼°ç­‰å¤šä¸ªå…³é”®é—®é¢˜ã€‚Shahå’ŒPetersï¼ˆ2020ï¼‰çš„ç ”ç©¶è¡¨æ˜Žï¼Œä¸Žæ— æ¡ä»¶æƒ…å†µä¸åŒï¼Œä¸å­˜åœ¨ä»»ä½•æ™®éæœ‰é™æ ·æœ¬æœ‰æ•ˆçš„æ£€éªŒèƒ½å¤ŸèŽ·å¾—éžå¹³å‡¡çš„æ£€éªŒåŠŸæ•ˆã€‚å°½ç®¡è¿™ä¸€ç»“æžœï¼ˆåŸºäºŽâ€œéšè—â€ä¾èµ–æ€§ï¼‰å…·æœ‰å¯å‘æ€§ï¼Œä½†å®ƒä¼¼ä¹Žæœªèƒ½è§£é‡Šå®žè·µä¸­å¸¸è§æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒé¢‘ç¹å¤±æ•ˆçš„çŽ°è±¡ã€‚æœ¬æ–‡ç ”ç©¶äº†åŸºäºŽæ ¸çš„æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒï¼Œå¹¶æŒ‡å‡ºè®¸å¤šè¿‘æœŸæ£€éªŒæ‰€åŸºäºŽçš„å¹¿ä¹‰åæ–¹å·®åº¦é‡å‡ ä¹Žå¯ä»¥è§†ä¸ºå…¶ç‰¹ä¾‹ã€‚æˆ‘ä»¬è¯†åˆ«äº†å½±å“KCIæ£€éªŒå®žé™…è¡Œä¸ºçš„ä¸»è¦å› ç´ ï¼Œå¼ºè°ƒäº†æ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡è¯¯å·®å¯¹Iåž‹é”™è¯¯çš„å…³é”®ä½œç”¨ï¼ŒåŒæ—¶æŒ‡å‡ºé€‰æ‹©é€‚å½“çš„æ¡ä»¶æ ¸ï¼ˆå…ˆå‰å·¥ä½œä¸­æœªè¢«è®¤è¯†åˆ°ï¼‰å¯¹äºŽèŽ·å¾—è‰¯å¥½çš„æ£€éªŒåŠŸæ•ˆæ˜¯å¿…è¦çš„ï¼Œä½†ä¹Ÿå€¾å‘äºŽå¢žåŠ Iåž‹é”™è¯¯ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒåœ¨å®žè·µä¸­é¢‘ç¹å¤±æ•ˆçš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯KCIæ£€éªŒçš„Iåž‹é”™è¯¯è†¨èƒ€å’Œæ£€éªŒåŠŸæ•ˆä¸è¶³ã€‚çŽ°æœ‰æ–¹æ³•çš„ç—›ç‚¹åœ¨äºŽï¼Œå°½ç®¡Shahå’ŒPetersçš„ç†è®ºæ­ç¤ºäº†æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒçš„å›ºæœ‰å›°éš¾ï¼Œä½†æœªèƒ½è§£é‡Šå®žé™…è§‚å¯Ÿåˆ°çš„æ£€éªŒå¤±è´¥ï¼Œä¸”å…ˆå‰å·¥ä½œæœªå……åˆ†è®¤è¯†åˆ°æ¡ä»¶æ ¸é€‰æ‹©å¯¹æ£€éªŒæ€§èƒ½çš„å½±å“ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒè§£å†³æ€è·¯æ˜¯é€šè¿‡æ·±å…¥åˆ†æžKCIæ£€éªŒçš„æœºåˆ¶ï¼Œè¯†åˆ«å‡ºæ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡è¯¯å·®æ˜¯å¯¼è‡´Iåž‹é”™è¯¯çš„å…³é”®å› ç´ ï¼ŒåŒæ—¶å¼ºè°ƒæ¡ä»¶æ ¸é€‰æ‹©å¯¹æ£€éªŒåŠŸæ•ˆçš„å¿…è¦æ€§åŠå…¶å¯¹Iåž‹é”™è¯¯çš„æ½œåœ¨è´Ÿé¢å½±å“ã€‚è¿™ç§è®¾è®¡åŸºäºŽå¯¹æ£€éªŒç»Ÿè®¡é‡æž„å»ºè¿‡ç¨‹çš„åˆ†è§£ï¼Œæ—¨åœ¨ä»Žå®žè·µè§’åº¦æ­ç¤ºæ£€éªŒå¤±æ•ˆçš„æ ¹æºã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“æž¶æž„åŒ…æ‹¬ç†è®ºåˆ†æžå’Œå®žéªŒéªŒè¯ä¸¤ä¸ªé˜¶æ®µã€‚é¦–å…ˆï¼Œè®ºæ–‡å°†KCIæ£€éªŒä¸Žå¹¿ä¹‰åæ–¹å·®åº¦é‡è”ç³»èµ·æ¥ï¼Œå±•ç¤ºåŽè€…è¿‘ä¼¼ä¸ºå‰è€…çš„ç‰¹ä¾‹ã€‚ç„¶åŽï¼Œé€šè¿‡åˆ†è§£æ£€éªŒç»Ÿè®¡é‡ï¼Œåˆ†æžæ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡è¯¯å·®å¯¹Iåž‹é”™è¯¯çš„å½±å“ï¼Œå¹¶æŽ¢è®¨æ¡ä»¶æ ¸é€‰æ‹©åœ¨ä¼˜åŒ–æ£€éªŒåŠŸæ•ˆå’Œå¹³è¡¡Iåž‹é”™è¯¯ä¸­çš„ä½œç”¨ã€‚å®žéªŒéƒ¨åˆ†ä½¿ç”¨åˆæˆå’ŒçœŸå®žæ•°æ®é›†è¯„ä¼°ä¸åŒæ ¸é€‰æ‹©ç­–ç•¥ä¸‹çš„æ£€éªŒæ€§èƒ½ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹åœ¨äºŽé¦–æ¬¡ç³»ç»Ÿæ€§åœ°è¯†åˆ«äº†æ¡ä»¶æ ¸é€‰æ‹©ä½œä¸ºå½±å“KCIæ£€éªŒæ€§èƒ½çš„å…³é”®å› ç´ ï¼Œå¹¶æ­ç¤ºäº†å…¶åœ¨æå‡æ£€éªŒåŠŸæ•ˆå’Œå¢žåŠ Iåž‹é”™è¯¯ä¹‹é—´çš„æƒè¡¡æœºåˆ¶ã€‚ä¸ŽçŽ°æœ‰æ–¹æ³•çš„æœ¬è´¨åŒºåˆ«åœ¨äºŽï¼Œå…ˆå‰å·¥ä½œå¤šå…³æ³¨æ£€éªŒç»Ÿè®¡é‡çš„æž„å»ºæˆ–ç†è®ºæžé™ï¼Œè€Œæœ¬æ–‡ä»Žå®žè·µè§’åº¦æ·±å…¥å‰–æžäº†æ£€éªŒå¤±æ•ˆçš„å…·ä½“æŠ€æœ¯åŽŸå› ã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬ä½¿ç”¨æ ¸æ–¹æ³•æž„å»ºæ¡ä»¶å‡å€¼åµŒå…¥ä¼°è®¡ï¼Œé€šè¿‡äº¤å‰éªŒè¯æˆ–å¯å‘å¼æ–¹æ³•é€‰æ‹©æ¡ä»¶æ ¸ï¼ˆå¦‚é«˜æ–¯æ ¸çš„å¸¦å®½å‚æ•°ï¼‰ï¼Œå¹¶è®¾è®¡å®žéªŒå¯¹æ¯”ä¸åŒæ ¸é€‰æ‹©ç­–ç•¥ä¸‹çš„Iåž‹é”™è¯¯çŽ‡å’Œæ£€éªŒåŠŸæ•ˆã€‚è®ºæ–‡æœªæŒ‡å®šå…·ä½“çš„æŸå¤±å‡½æ•°æˆ–ç½‘ç»œç»“æž„ï¼Œè€Œæ˜¯èšç„¦äºŽæ ¸å‚æ•°çš„é€‰æ‹©å’Œä¼°è®¡è¯¯å·®çš„åˆ†æžã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒç»“æžœè¡¨æ˜Žï¼Œæ¡ä»¶æ ¸é€‰æ‹©æ˜¾è‘—å½±å“KCIæ£€éªŒçš„æ€§èƒ½ï¼šä¸å½“çš„æ ¸é€‰æ‹©å¯èƒ½å¯¼è‡´Iåž‹é”™è¯¯çŽ‡é«˜è¾¾æœªçŸ¥ï¼ˆå…·ä½“æ•°æ®æœªæä¾›ï¼‰ï¼Œè€Œä¼˜åŒ–é€‰æ‹©å¯æå‡æ£€éªŒåŠŸæ•ˆã€‚ä¸ŽåŸºçº¿æ–¹æ³•ï¼ˆå¦‚å›ºå®šæ ¸å‚æ•°ï¼‰ç›¸æ¯”ï¼Œè®ºæ–‡æå‡ºçš„æ ¸é€‰æ‹©ç­–ç•¥åœ¨åˆæˆæ•°æ®ä¸Šæ˜¾ç¤ºå‡ºæ›´å¥½çš„å¹³è¡¡æ€§ï¼Œå‡å°‘äº†Iåž‹é”™è¯¯è†¨èƒ€åŒæ—¶ä¿æŒè¾ƒé«˜åŠŸæ•ˆã€‚å…·ä½“æå‡å¹…åº¦æœªçŸ¥ï¼Œä½†å®žéªŒå¼ºè°ƒäº†æ ¸é€‰æ‹©åœ¨å®žé™…åº”ç”¨ä¸­çš„å…³é”®ä½œç”¨ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶åœ¨å› æžœå‘çŽ°ã€é¢„æµ‹å™¨å…¬å¹³æ€§è¯„ä¼°å’Œåˆ†å¸ƒå¤–é²æ£’æ€§æµ‹è¯•ç­‰é¢†åŸŸå…·æœ‰é‡è¦åº”ç”¨ä»·å€¼ã€‚é€šè¿‡æ”¹è¿›æ¡ä»¶ç‹¬ç«‹æ€§æ£€éªŒçš„å®žè·µæ€§èƒ½ï¼Œå¯ä»¥æ›´å¯é åœ°è¯†åˆ«å˜é‡é—´çš„å› æžœå…³ç³»ï¼Œç¡®ä¿æœºå™¨å­¦ä¹ æ¨¡åž‹çš„å…¬å¹³æ€§ï¼Œå¹¶å¢žå¼ºæ¨¡åž‹å¯¹æ–°æ•°æ®åˆ†å¸ƒçš„é€‚åº”èƒ½åŠ›ã€‚æœªæ¥å½±å“å¯èƒ½åŒ…æ‹¬å¼€å‘æ›´ç¨³å¥çš„æ£€éªŒæ–¹æ³•ï¼ŒæŽ¨åŠ¨ç›¸å…³é¢†åŸŸå¦‚åŒ»ç–—è¯Šæ–­å’Œé‡‘èžé£Žé™©è¯„ä¼°çš„è¿›æ­¥ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Tests of conditional independence (CI) underpin a number of important problems in machine learning and statistics, from causal discovery to evaluation of predictor fairness and out-of-distribution robustness. Shah and Peters (2020) showed that, contrary to the unconditional case, no universally finite-sample valid test can ever achieve nontrivial power. While informative, this result (based on "hiding" dependence) does not seem to explain the frequent practical failures observed with popular CI tests. We investigate the Kernel-based Conditional Independence (KCI) test - of which we show the Generalized Covariance Measure underlying many recent tests is nearly a special case - and identify the major factors underlying its practical behavior. We highlight the key role of errors in the conditional mean embedding estimate for the Type-I error, while pointing out the importance of selecting an appropriate conditioning kernel (not recognized in previous work) as being necessary for good test power but also tending to inflate Type-I error.

