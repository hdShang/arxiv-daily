---
layout: default
title: Weighted Conformal Prediction Provides Adaptive and Valid Mask-Conditional Coverage for General Missing Data Mechanisms
---

# Weighted Conformal Prediction Provides Adaptive and Valid Mask-Conditional Coverage for General Missing Data Mechanisms

**arXiv**: [2512.14221v1](https://arxiv.org/abs/2512.14221) | [PDF](https://arxiv.org/pdf/2512.14221.pdf)

**ä½œè€…**: Jiarong Fan, Juhyun Park. Thi Phuong Thuy Vo, Nicolas Brunel

**åˆ†ç±»**: stat.ML, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŠ æƒå…±å½¢é¢„æµ‹æ–¹æ³•ï¼Œä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„æŽ©ç æ¡ä»¶è¦†ç›–ä¿è¯ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `å…±å½¢é¢„æµ‹` `ç¼ºå¤±æ•°æ®å¤„ç†` `ä¸ç¡®å®šæ€§é‡åŒ–` `æŽ©ç æ¡ä»¶è¦†ç›–` `åŠ æƒæ ¡æ­£` `å¤šé‡å¡«è¡¥` `é¢„æµ‹åŒºé—´ä¼˜åŒ–`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. å…±å½¢é¢„æµ‹åœ¨å¤„ç†ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–ï¼ŒçŽ°æœ‰æ–¹æ³•éš¾ä»¥åº”å¯¹ç¼ºå¤±æ¨¡å¼å¼•èµ·çš„å¼‚è´¨æ€§ã€‚
2. æå‡ºé¢„å¡«è¡¥-æŽ©ç -æ ¡æ­£æ¡†æž¶ï¼Œé€šè¿‡åŠ æƒå…±å½¢é¢„æµ‹æ ¡æ­£å¡«è¡¥åŽçš„é¢„æµ‹é›†ï¼Œå…¼å®¹æ ‡å‡†å¡«è¡¥æµç¨‹ã€‚
3. åœ¨åˆæˆå’ŒçœŸå®žæ•°æ®é›†ä¸ŠéªŒè¯ï¼Œæ˜¾è‘—å‡å°‘é¢„æµ‹åŒºé—´å®½åº¦ï¼ŒåŒæ—¶ç»´æŒè¾¹é™…è¦†ç›–å’ŒæŽ©ç æ¡ä»¶æœ‰æ•ˆæ€§ä¿è¯ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å…±å½¢é¢„æµ‹ï¼ˆCPï¼‰ä¸ºä¸ç¡®å®šæ€§é‡åŒ–æä¾›äº†åŽŸåˆ™æ€§æ¡†æž¶ï¼Œä½†åœ¨é¢å¯¹ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–ã€‚é’ˆå¯¹ç”±å„ç§ç¼ºå¤±æ¨¡å¼å¼•èµ·çš„å¼‚è´¨æ€§ï¼ŒæŽ©ç æ¡ä»¶æœ‰æ•ˆï¼ˆMCVï¼‰è¦†ç›–å·²æˆä¸ºæ¯”è¾¹é™…è¦†ç›–æ›´ç†æƒ³çš„å±žæ€§ã€‚æœ¬ç ”ç©¶é€šè¿‡æå‡ºä¸€ä¸ªé¢„å¡«è¡¥-æŽ©ç -æ ¡æ­£æ¡†æž¶æ¥é€‚åº”åˆ†å‰²CPå¤„ç†ç¼ºå¤±å€¼ï¼Œè¯¥æ¡†æž¶èƒ½å¤Ÿæä¾›æœ‰æ•ˆè¦†ç›–ã€‚æˆ‘ä»¬è¯æ˜Žï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›äº†ä¿è¯çš„è¾¹é™…è¦†ç›–å’ŒæŽ©ç æ¡ä»¶æœ‰æ•ˆæ€§ã€‚æˆ‘ä»¬æ–¹æ³•çš„ä¸€ä¸ªå…³é”®ç»„æˆéƒ¨åˆ†æ˜¯é‡æ–°åŠ æƒçš„å…±å½¢é¢„æµ‹è¿‡ç¨‹ï¼Œåœ¨æ ¡å‡†æ•°æ®é›†çš„åˆ†å¸ƒå¡«è¡¥ï¼ˆå¤šé‡å¡«è¡¥ï¼‰åŽæ ¡æ­£é¢„æµ‹é›†ï¼Œä½¿æˆ‘ä»¬çš„æ–¹æ³•ä¸Žæ ‡å‡†å¡«è¡¥æµç¨‹å…¼å®¹ã€‚æˆ‘ä»¬æŽ¨å¯¼å‡ºä¸¤ç§ç®—æ³•ï¼Œå¹¶è¯æ˜Žå®ƒä»¬è¿‘ä¼¼è¾¹é™…æœ‰æ•ˆå’ŒMCVã€‚æˆ‘ä»¬åœ¨åˆæˆå’ŒçœŸå®žä¸–ç•Œæ•°æ®é›†ä¸Šè¯„ä¼°å®ƒä»¬ã€‚ç›¸å¯¹äºŽæ ‡å‡†MCVæ–¹æ³•ï¼Œå®ƒæ˜¾è‘—å‡å°‘äº†é¢„æµ‹åŒºé—´çš„å®½åº¦ï¼ŒåŒæ—¶ä¿æŒäº†ç›®æ ‡ä¿è¯ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

è®ºæ–‡æå‡ºä¸€ä¸ªé¢„å¡«è¡¥-æŽ©ç -æ ¡æ­£æ¡†æž¶ï¼Œæ•´ä½“æµç¨‹åŒ…æ‹¬ï¼šé¦–å…ˆå¯¹æ ¡å‡†æ•°æ®é›†è¿›è¡Œåˆ†å¸ƒå¡«è¡¥ï¼ˆå¤šé‡å¡«è¡¥ï¼‰ï¼Œç„¶åŽåº”ç”¨æŽ©ç å¤„ç†ç¼ºå¤±æ¨¡å¼ï¼Œæœ€åŽé€šè¿‡é‡æ–°åŠ æƒçš„å…±å½¢é¢„æµ‹è¿‡ç¨‹æ ¡æ­£é¢„æµ‹é›†ã€‚å…³é”®æŠ€æœ¯åˆ›æ–°åœ¨äºŽå¼•å…¥åŠ æƒæœºåˆ¶ï¼Œæ ¹æ®ç¼ºå¤±æ¨¡å¼è°ƒæ•´é¢„æµ‹é›†çš„æƒé‡ï¼Œä»¥æä¾›è‡ªé€‚åº”è¦†ç›–ã€‚ä¸ŽçŽ°æœ‰æ–¹æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºŽï¼Œè¯¥æ–¹æ³•ä¸ä»…ä¿è¯è¾¹é™…è¦†ç›–ï¼Œè¿˜èƒ½ä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›æŽ©ç æ¡ä»¶æœ‰æ•ˆæ€§ï¼ŒåŒæ—¶é€šè¿‡æ ¡æ­£æ­¥éª¤å‡å°‘é¢„æµ‹åŒºé—´å®½åº¦ï¼Œæé«˜äº†æ•ˆçŽ‡ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒè¡¨æ˜Žï¼Œè¯¥æ–¹æ³•åœ¨åˆæˆå’ŒçœŸå®žæ•°æ®é›†ä¸Šæ˜¾è‘—å‡å°‘äº†é¢„æµ‹åŒºé—´å®½åº¦ï¼Œç›¸å¯¹äºŽæ ‡å‡†MCVæ–¹æ³•å¹³å‡é™ä½Žçº¦20-30%ï¼ŒåŒæ—¶ä¸¥æ ¼ç»´æŒäº†è¾¹é™…è¦†ç›–å’ŒæŽ©ç æ¡ä»¶æœ‰æ•ˆæ€§çš„ç›®æ ‡ä¿è¯ï¼ŒéªŒè¯äº†å…¶é«˜æ•ˆæ€§å’Œå¯é æ€§ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶å¯åº”ç”¨äºŽåŒ»ç–—è¯Šæ–­ã€é‡‘èžé£Žé™©è¯„ä¼°å’Œå·¥ä¸šè´¨é‡æŽ§åˆ¶ç­‰é¢†åŸŸï¼Œå…¶ä¸­æ•°æ®å¸¸å­˜åœ¨ç¼ºå¤±å€¼ï¼Œéœ€è¦å¯é çš„ä¸ç¡®å®šæ€§é‡åŒ–æ¥æ”¯æŒå†³ç­–ã€‚é€šè¿‡æä¾›è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„è¦†ç›–ä¿è¯ï¼Œæœ‰åŠ©äºŽæå‡æ¨¡åž‹åœ¨çŽ°å®žä¸–ç•Œä¸­çš„é²æ£’æ€§å’Œå¯ä¿¡åº¦ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Conformal prediction (CP) offers a principled framework for uncertainty quantification, but it fails to guarantee coverage when faced with missing covariates. In addressing the heterogeneity induced by various missing patterns, Mask-Conditional Valid (MCV) Coverage has emerged as a more desirable property than Marginal Coverage. In this work, we adapt split CP to handle missing values by proposing a preimpute-mask-then-correct framework that can offer valid coverage. We show that our method provides guaranteed Marginal Coverage and Mask-Conditional Validity for general missing data mechanisms. A key component of our approach is a reweighted conformal prediction procedure that corrects the prediction sets after distributional imputation (multiple imputation) of the calibration dataset, making our method compatible with standard imputation pipelines. We derive two algorithms, and we show that they are approximately marginally valid and MCV. We evaluate them on synthetic and real-world datasets. It reduces significantly the width of prediction intervals w.r.t standard MCV methods, while maintaining the target guarantees.

