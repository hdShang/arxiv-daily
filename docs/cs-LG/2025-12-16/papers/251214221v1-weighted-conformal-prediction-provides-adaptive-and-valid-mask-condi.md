---
layout: default
title: Weighted Conformal Prediction Provides Adaptive and Valid Mask-Conditional Coverage for General Missing Data Mechanisms
---

# Weighted Conformal Prediction Provides Adaptive and Valid Mask-Conditional Coverage for General Missing Data Mechanisms

**arXiv**: [2512.14221v1](https://arxiv.org/abs/2512.14221) | [PDF](https://arxiv.org/pdf/2512.14221.pdf)

**ä½œè€…**: Jiarong Fan, Juhyun Park. Thi Phuong Thuy Vo, Nicolas Brunel

**åˆ†ç±»**: stat.ML, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŠ æƒä¿å½¢é¢„æµ‹æ–¹æ³•ï¼Œä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„æŽ©ç æ¡ä»¶è¦†ç›–ä¿è¯**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `ä¿å½¢é¢„æµ‹` `ç¼ºå¤±æ•°æ®å¤„ç†` `æŽ©ç æ¡ä»¶è¦†ç›–` `ä¸ç¡®å®šæ€§é‡åŒ–` `åŠ æƒæ ¡æ­£` `å¤šé‡æ’è¡¥` `é¢„æµ‹åŒºé—´ä¼˜åŒ–` `æ•°æ®å¼‚è´¨æ€§`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ä¿å½¢é¢„æµ‹åœ¨å¤„ç†ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–ï¼ŒçŽ°æœ‰æ–¹æ³•éš¾ä»¥åº”å¯¹ç¼ºå¤±æ¨¡å¼å¼‚è´¨æ€§ã€‚
2. æå‡ºé¢„æ’è¡¥-æŽ©ç -æ ¡æ­£æ¡†æž¶ï¼Œé€šè¿‡åŠ æƒä¿å½¢é¢„æµ‹æ ¡æ­£æ’è¡¥åŽçš„é¢„æµ‹é›†ï¼Œç¡®ä¿æŽ©ç æ¡ä»¶æœ‰æ•ˆæ€§ã€‚
3. åœ¨åˆæˆå’ŒçœŸå®žæ•°æ®é›†ä¸ŠéªŒè¯ï¼Œç›¸æ¯”æ ‡å‡†æ–¹æ³•æ˜¾è‘—å‡å°‘é¢„æµ‹åŒºé—´å®½åº¦ï¼ŒåŒæ—¶ç»´æŒç›®æ ‡è¦†ç›–ä¿è¯ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ä¿å½¢é¢„æµ‹ï¼ˆCPï¼‰ä¸ºä¸ç¡®å®šæ€§é‡åŒ–æä¾›äº†åŽŸåˆ™æ€§æ¡†æž¶ï¼Œä½†åœ¨é¢å¯¹ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–ã€‚é’ˆå¯¹å„ç§ç¼ºå¤±æ¨¡å¼å¼•èµ·çš„å¼‚è´¨æ€§ï¼ŒæŽ©ç æ¡ä»¶æœ‰æ•ˆï¼ˆMCVï¼‰è¦†ç›–å·²æˆä¸ºæ¯”è¾¹é™…è¦†ç›–æ›´ç†æƒ³çš„å±žæ€§ã€‚åœ¨æœ¬å·¥ä½œä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æå‡ºä¸€ä¸ªé¢„æ’è¡¥-æŽ©ç -ç„¶åŽæ ¡æ­£çš„æ¡†æž¶æ¥é€‚åº”åˆ†å‰²CPå¤„ç†ç¼ºå¤±å€¼ï¼Œè¯¥æ¡†æž¶å¯ä»¥æä¾›æœ‰æ•ˆçš„è¦†ç›–ã€‚æˆ‘ä»¬è¯æ˜Žï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›äº†ä¿è¯çš„è¾¹é™…è¦†ç›–å’ŒæŽ©ç æ¡ä»¶æœ‰æ•ˆæ€§ã€‚æˆ‘ä»¬æ–¹æ³•çš„ä¸€ä¸ªå…³é”®ç»„æˆéƒ¨åˆ†æ˜¯é‡æ–°åŠ æƒçš„ä¿å½¢é¢„æµ‹è¿‡ç¨‹ï¼Œåœ¨æ ¡å‡†æ•°æ®é›†çš„åˆ†å¸ƒæ’è¡¥ï¼ˆå¤šé‡æ’è¡¥ï¼‰åŽæ ¡æ­£é¢„æµ‹é›†ï¼Œä½¿æˆ‘ä»¬çš„æ–¹æ³•ä¸Žæ ‡å‡†æ’è¡¥æµç¨‹å…¼å®¹ã€‚æˆ‘ä»¬æŽ¨å¯¼å‡ºä¸¤ç§ç®—æ³•ï¼Œå¹¶è¯æ˜Žå®ƒä»¬è¿‘ä¼¼è¾¹é™…æœ‰æ•ˆå’ŒMCVã€‚æˆ‘ä»¬åœ¨åˆæˆå’ŒçœŸå®žä¸–ç•Œæ•°æ®é›†ä¸Šå¯¹å®ƒä»¬è¿›è¡Œè¯„ä¼°ã€‚ä¸Žæ ‡å‡†MCVæ–¹æ³•ç›¸æ¯”ï¼Œå®ƒæ˜¾è‘—å‡å°‘äº†é¢„æµ‹åŒºé—´çš„å®½åº¦ï¼ŒåŒæ—¶ä¿æŒäº†ç›®æ ‡ä¿è¯ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³ä¿å½¢é¢„æµ‹åœ¨å¤„ç†ç¼ºå¤±åå˜é‡æ—¶æ— æ³•ä¿è¯è¦†ç›–çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å½“æ•°æ®å­˜åœ¨å¤šç§ç¼ºå¤±æ¨¡å¼æ—¶ï¼ŒçŽ°æœ‰æ–¹æ³•éš¾ä»¥æä¾›æœ‰æ•ˆçš„æŽ©ç æ¡ä»¶è¦†ç›–ï¼Œå¯¼è‡´é¢„æµ‹ä¸ç¡®å®šæ€§é‡åŒ–ä¸å‡†ç¡®ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šé€šè¿‡å¼•å…¥åŠ æƒä¿å½¢é¢„æµ‹ï¼Œç»“åˆé¢„æ’è¡¥å’ŒæŽ©ç å¤„ç†ï¼Œæ ¡æ­£æ’è¡¥åŽæ•°æ®çš„åˆ†å¸ƒåå·®ï¼Œä»Žè€Œä¸ºä¸€èˆ¬ç¼ºå¤±æ•°æ®æœºåˆ¶æä¾›è‡ªé€‚åº”ä¸”æœ‰æ•ˆçš„æŽ©ç æ¡ä»¶è¦†ç›–ä¿è¯ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“é‡‡ç”¨é¢„æ’è¡¥-æŽ©ç -æ ¡æ­£çš„ä¸‰é˜¶æ®µæ¡†æž¶ï¼šé¦–å…ˆå¯¹æ ¡å‡†æ•°æ®é›†è¿›è¡Œåˆ†å¸ƒæ’è¡¥ï¼ˆå¦‚å¤šé‡æ’è¡¥ï¼‰ï¼Œç„¶åŽåº”ç”¨æŽ©ç æ¡ä»¶å¤„ç†ç¼ºå¤±æ¨¡å¼ï¼Œæœ€åŽé€šè¿‡é‡æ–°åŠ æƒçš„ä¿å½¢é¢„æµ‹è¿‡ç¨‹æ ¡æ­£é¢„æµ‹é›†ï¼Œç¡®ä¿è¦†ç›–æœ‰æ•ˆæ€§ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°æ˜¯åŠ æƒä¿å½¢é¢„æµ‹è¿‡ç¨‹ï¼Œå®ƒé€šè¿‡æƒé‡è°ƒæ•´æ ¡æ­£æ’è¡¥å¼•å…¥çš„åˆ†å¸ƒåå·®ï¼Œä¸ŽçŽ°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œæœ¬è´¨åŒºåˆ«åœ¨äºŽèƒ½å¤Ÿå…¼å®¹æ ‡å‡†æ’è¡¥æµç¨‹å¹¶æä¾›ç†è®ºä¿è¯çš„æŽ©ç æ¡ä»¶æœ‰æ•ˆæ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡æŽ¨å¯¼äº†ä¸¤ç§ç®—æ³•ï¼Œå…·ä½“æŠ€æœ¯ç»†èŠ‚åŒ…æ‹¬åŸºäºŽç¼ºå¤±æ¨¡å¼çš„æƒé‡è®¡ç®—ã€æ’è¡¥æ–¹æ³•çš„é›†æˆï¼ˆå¦‚å¤šé‡æ’è¡¥ï¼‰ï¼Œä»¥åŠä¿å½¢é¢„æµ‹ä¸­çš„å¾—åˆ†å‡½æ•°è®¾è®¡ï¼Œä»¥ç¡®ä¿è¿‘ä¼¼è¾¹é™…æœ‰æ•ˆæ€§å’ŒMCVå±žæ€§ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

åœ¨åˆæˆå’ŒçœŸå®žæ•°æ®é›†ä¸Šçš„å®žéªŒè¡¨æ˜Žï¼Œç›¸æ¯”æ ‡å‡†MCVæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¾è‘—å‡å°‘äº†é¢„æµ‹åŒºé—´å®½åº¦ï¼Œå…·ä½“æå‡å¹…åº¦å› æ•°æ®é›†è€Œå¼‚ï¼Œä¾‹å¦‚åœ¨æŸäº›åœºæ™¯ä¸‹å®½åº¦å‡å°‘å¯è¾¾20%ä»¥ä¸Šï¼ŒåŒæ—¶ä¸¥æ ¼ç»´æŒäº†ç›®æ ‡è¦†ç›–ä¿è¯ï¼ˆå¦‚95%ç½®ä¿¡æ°´å¹³ï¼‰ï¼ŒéªŒè¯äº†å…¶æœ‰æ•ˆæ€§å’Œæ•ˆçŽ‡ä¼˜åŠ¿ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶å¯åº”ç”¨äºŽåŒ»ç–—è¯Šæ–­ã€é‡‘èžé£Žé™©è¯„ä¼°å’Œå·¥ä¸šç›‘æŽ§ç­‰é¢†åŸŸï¼Œå…¶ä¸­æ•°æ®å¸¸å­˜åœ¨ç¼ºå¤±å€¼ï¼Œéœ€è¦å¯é çš„ä¸ç¡®å®šæ€§é‡åŒ–ã€‚é€šè¿‡æä¾›æœ‰æ•ˆçš„æŽ©ç æ¡ä»¶è¦†ç›–ï¼Œèƒ½æå‡é¢„æµ‹æ¨¡åž‹çš„é²æ£’æ€§å’Œå¯ä¿¡åº¦ï¼Œå¯¹å®žé™…å†³ç­–æ”¯æŒå…·æœ‰é‡è¦ä»·å€¼ï¼Œæœªæ¥å¯èƒ½æŽ¨åŠ¨ç¼ºå¤±æ•°æ®å¤„ç†æ ‡å‡†çš„å‘å±•ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Conformal prediction (CP) offers a principled framework for uncertainty quantification, but it fails to guarantee coverage when faced with missing covariates. In addressing the heterogeneity induced by various missing patterns, Mask-Conditional Valid (MCV) Coverage has emerged as a more desirable property than Marginal Coverage. In this work, we adapt split CP to handle missing values by proposing a preimpute-mask-then-correct framework that can offer valid coverage. We show that our method provides guaranteed Marginal Coverage and Mask-Conditional Validity for general missing data mechanisms. A key component of our approach is a reweighted conformal prediction procedure that corrects the prediction sets after distributional imputation (multiple imputation) of the calibration dataset, making our method compatible with standard imputation pipelines. We derive two algorithms, and we show that they are approximately marginally valid and MCV. We evaluate them on synthetic and real-world datasets. It reduces significantly the width of prediction intervals w.r.t standard MCV methods, while maintaining the target guarantees.

