---
layout: default
title: LLmFPCA-detect: LLM-powered Multivariate Functional PCA for Anomaly Detection in Sparse Longitudinal Texts
---

# LLmFPCA-detect: LLM-powered Multivariate Functional PCA for Anomaly Detection in Sparse Longitudinal Texts

**arXiv**: [2512.14604v1](https://arxiv.org/abs/2512.14604) | [PDF](https://arxiv.org/pdf/2512.14604.pdf)

**ä½œè€…**: Prasanjit Dubey, Aritra Guha, Zhengyi Zhou, Qiong Wu, Xiaoming Huo, Paromita Dubey

**åˆ†ç±»**: stat.ML, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºLLmFPCA-detectæ¡†æž¶ï¼Œç»“åˆLLMæ–‡æœ¬åµŒå…¥ä¸Žç¨€ç–å¤šå…ƒå‡½æ•°ä¸»æˆåˆ†åˆ†æžï¼Œè§£å†³ç¨€ç–çºµå‘æ–‡æœ¬æ•°æ®çš„å¼‚å¸¸æ£€æµ‹é—®é¢˜ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **å¼ºåŒ–å­¦ä¹ **

**å…³é”®è¯**: `ç¨€ç–çºµå‘æ–‡æœ¬æ•°æ®` `å¼‚å¸¸æ£€æµ‹` `å¤§åž‹è¯­è¨€æ¨¡åž‹` `å‡½æ•°æ•°æ®åˆ†æž` `å¤šå…ƒå‡½æ•°ä¸»æˆåˆ†åˆ†æž` `æ–‡æœ¬åµŒå…¥` `æ— ç›‘ç£å­¦ä¹ ` `æ—¶é—´åºåˆ—åˆ†æž`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç¨€ç–çºµå‘æ–‡æœ¬æ•°æ®ï¼ˆå¦‚å®¢æˆ·è¯„è®ºã€åŒ»ç–—è®°å½•ï¼‰ç¼ºä¹ä¸“é—¨åˆ†æžæ–¹æ³•ï¼ŒçŽ°æœ‰æ–¹æ³•éš¾ä»¥å¤„ç†å…¶å™ªå£°ã€å¼‚è´¨æ€§å’Œå¼‚å¸¸é—®é¢˜ã€‚
2. æå‡ºLLmFPCA-detectæ¡†æž¶ï¼Œç»“åˆLLMæ–‡æœ¬åµŒå…¥ä¸Žå‡½æ•°æ•°æ®åˆ†æžï¼Œé€šè¿‡ç¨€ç–å¤šå…ƒå‡½æ•°ä¸»æˆåˆ†åˆ†æžæ¢å¤ç¾¤ä½“ç‰¹å¾å¹¶æ£€æµ‹å¼‚å¸¸ã€‚
3. åœ¨äºšé©¬é€Šè¯„è®ºå’Œç»´åŸºç™¾ç§‘è¯„è®ºæ•°æ®é›†ä¸Šå®žéªŒï¼ŒLLmFPCA-detectä¼˜äºŽåŸºçº¿æ–¹æ³•ï¼Œæå‡é¢„æµ‹æ€§èƒ½å¹¶å±•ç¤ºè·¨é¢†åŸŸç¨³å®šæ€§ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

ç¨€ç–çºµå‘ï¼ˆSLï¼‰æ–‡æœ¬æ•°æ®å‡ºçŽ°åœ¨ä¸ªä½“éšæ—¶é—´é‡å¤ç”Ÿæˆæ–‡æœ¬çš„åœºæ™¯ä¸­ï¼ˆå¦‚å®¢æˆ·è¯„è®ºã€å¶å°”çš„ç¤¾äº¤åª’ä½“å¸–å­ã€è·¨æ¬¡å°±è¯Šçš„ç”µå­ç—…åŽ†ï¼‰ï¼Œä½†è§‚æµ‹é¢‘çŽ‡å’Œæ—¶é—´åœ¨ä¸åŒä¸ªä½“é—´å­˜åœ¨å·®å¼‚ã€‚è¿™äº›å¤æ‚çš„æ–‡æœ¬æ•°æ®é›†å…·æœ‰å·¨å¤§æ½œåŠ›ï¼Œå¯ä¸ºæœªæ¥æ”¿ç­–å’Œé’ˆå¯¹æ€§æŽ¨èæä¾›ä¿¡æ¯ã€‚ç„¶è€Œï¼Œç”±äºŽSLæ–‡æœ¬æ•°æ®ç¼ºä¹ä¸“é—¨æ–¹æ³•ï¼Œä¸”å…·æœ‰å™ªå£°ã€å¼‚è´¨æ€§å’Œæ˜“å‡ºçŽ°å¼‚å¸¸çš„ç‰¹ç‚¹ï¼Œæ£€æµ‹å’ŒæŽ¨æ–­å…³é”®æ¨¡å¼å…·æœ‰æŒ‘æˆ˜æ€§ã€‚æˆ‘ä»¬å¼•å…¥äº†LLmFPCA-detectï¼Œè¿™æ˜¯ä¸€ä¸ªçµæ´»çš„æ¡†æž¶ï¼Œå°†åŸºäºŽLLMçš„æ–‡æœ¬åµŒå…¥ä¸Žå‡½æ•°æ•°æ®åˆ†æžç›¸ç»“åˆï¼Œä»¥æ£€æµ‹å¤§åž‹SLæ–‡æœ¬æ•°æ®é›†ä¸­çš„èšç±»å¹¶æŽ¨æ–­å¼‚å¸¸ã€‚é¦–å…ˆï¼ŒLLmFPCA-detectä½¿ç”¨LLMæç¤ºå°†æ¯æ®µæ–‡æœ¬åµŒå…¥åˆ°ç‰¹å®šåº”ç”¨çš„æ•°å€¼ç©ºé—´ä¸­ã€‚åœ¨æ•°å€¼ç©ºé—´ä¸­è¿›è¡Œçš„ç¨€ç–å¤šå…ƒå‡½æ•°ä¸»æˆåˆ†åˆ†æžï¼ˆmFPCAï¼‰æ˜¯æ¢å¤ä¸»è¦ç¾¤ä½“ç‰¹å¾çš„æ ¸å¿ƒå·¥å…·ï¼Œå¹¶äº§ç”Ÿä¸ªä½“çº§åˆ†æ•°ï¼Œè¿™äº›åˆ†æ•°ä¸ŽåŸºçº¿é™æ€åå˜é‡ä¸€èµ·ï¼Œä¿ƒè¿›æ•°æ®åˆ†å‰²ã€æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹å’ŒæŽ¨æ–­ï¼Œå¹¶æ”¯æŒå…¶ä»–ä¸‹æ¸¸ä»»åŠ¡ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬åˆ©ç”¨LLMåœ¨LLmFPCA-detectå‘çŽ°çš„æ•°æ®æ®µå’Œå¼‚å¸¸æŒ‡å¯¼ä¸‹è¿›è¡ŒåŠ¨æ€å…³é”®è¯åˆ†æžï¼Œå¹¶å±•ç¤ºLLmFPCA-detectäº§ç”Ÿçš„èšç±»ç‰¹å®šå‡½æ•°ä¸»æˆåˆ†åˆ†æ•°ä½œä¸ºçŽ°æœ‰æµç¨‹ä¸­çš„ç‰¹å¾ï¼Œæœ‰åŠ©äºŽæå‡é¢„æµ‹æ€§èƒ½ã€‚æˆ‘ä»¬é€šè¿‡å®žéªŒæ”¯æŒLLmFPCA-detectçš„ç¨³å®šæ€§ï¼Œå¹¶ä½¿ç”¨å…¬å…±æ•°æ®é›†ï¼ˆäºšé©¬é€Šå®¢æˆ·è¯„è®ºè½¨è¿¹å’Œç»´åŸºç™¾ç§‘è®¨è®ºé¡µè¯„è®ºæµï¼‰åœ¨ä¸¤ä¸ªä¸åŒåº”ç”¨ä¸­è¯„ä¼°å®ƒï¼Œå±•ç¤ºäº†è·¨é¢†åŸŸçš„å®žç”¨æ€§å¹¶ä¼˜äºŽæœ€å…ˆè¿›çš„åŸºçº¿æ–¹æ³•ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³ç¨€ç–çºµå‘ï¼ˆSLï¼‰æ–‡æœ¬æ•°æ®ä¸­çš„å¼‚å¸¸æ£€æµ‹å’Œæ¨¡å¼æŽ¨æ–­é—®é¢˜ã€‚çŽ°æœ‰æ–¹æ³•ç¼ºä¹ä¸“é—¨å¤„ç†SLæ–‡æœ¬æ•°æ®çš„å·¥å…·ï¼Œè¿™äº›æ•°æ®å…·æœ‰è§‚æµ‹é¢‘çŽ‡å’Œæ—¶é—´ä¸è§„å¾‹ã€å™ªå£°å¤§ã€å¼‚è´¨æ€§å¼ºã€æ˜“å‡ºçŽ°å¼‚å¸¸ç­‰ç‰¹ç‚¹ï¼Œå¯¼è‡´ä¼ ç»Ÿæ–‡æœ¬åˆ†æžæˆ–ç»Ÿè®¡æ–¹æ³•æ•ˆæžœæœ‰é™ï¼Œéš¾ä»¥æœ‰æ•ˆæå–å…³é”®æ¨¡å¼å’Œè¯†åˆ«å¼‚å¸¸ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯å°†å¤§åž‹è¯­è¨€æ¨¡åž‹ï¼ˆLLMï¼‰çš„æ–‡æœ¬åµŒå…¥èƒ½åŠ›ä¸Žå‡½æ•°æ•°æ®åˆ†æžï¼ˆFDAï¼‰ç›¸ç»“åˆï¼Œåˆ©ç”¨LLMå°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å€¼è¡¨ç¤ºï¼Œå†é€šè¿‡ç¨€ç–å¤šå…ƒå‡½æ•°ä¸»æˆåˆ†åˆ†æžï¼ˆmFPCAï¼‰åœ¨å‡½æ•°ç©ºé—´ä¸­å»ºæ¨¡æ—¶é—´åŠ¨æ€ï¼Œä»Žè€Œæ¢å¤ç¾¤ä½“ç‰¹å¾ã€æ£€æµ‹èšç±»å’Œå¼‚å¸¸ã€‚è¿™ç§è®¾è®¡èƒ½å¤ŸåŒæ—¶å¤„ç†æ–‡æœ¬çš„è¯­ä¹‰ä¿¡æ¯å’Œæ—¶é—´åºåˆ—çš„ç¨€ç–æ€§ï¼Œå…‹æœå•ä¸€æ–¹æ³•çš„å±€é™æ€§ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“æ¡†æž¶åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼šé¦–å…ˆï¼Œä½¿ç”¨LLMæç¤ºå°†æ¯ä¸ªæ–‡æœ¬ç‰‡æ®µåµŒå…¥åˆ°ç‰¹å®šåº”ç”¨çš„æ•°å€¼ç©ºé—´ä¸­ï¼Œç”Ÿæˆæ–‡æœ¬å‘é‡ï¼›å…¶æ¬¡ï¼Œåœ¨æ•°å€¼ç©ºé—´ä¸Šåº”ç”¨ç¨€ç–mFPCAï¼Œä»Žç¨€ç–æ—¶é—´ç‚¹æ•°æ®ä¸­ä¼°è®¡å‡½æ•°ä¸»æˆåˆ†ï¼Œæ¢å¤ä¸»è¦ç¾¤ä½“ç‰¹å¾å¹¶è®¡ç®—ä¸ªä½“çº§åˆ†æ•°ï¼›æœ€åŽï¼Œç»“åˆåŸºçº¿é™æ€åå˜é‡ï¼Œè¿›è¡Œæ•°æ®åˆ†å‰²ã€æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹å’ŒæŽ¨æ–­ï¼Œå¹¶æ”¯æŒä¸‹æ¸¸ä»»åŠ¡å¦‚åŠ¨æ€å…³é”®è¯åˆ†æžå’Œé¢„æµ‹æ€§èƒ½æå‡ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°æ˜¯é¦–æ¬¡å°†LLMæ–‡æœ¬åµŒå…¥ä¸Žç¨€ç–mFPCAç»“åˆç”¨äºŽSLæ–‡æœ¬æ•°æ®åˆ†æžï¼Œå®žçŽ°äº†æ–‡æœ¬è¯­ä¹‰ä¸Žæ—¶é—´åŠ¨æ€çš„è”åˆå»ºæ¨¡ã€‚ä¸ŽçŽ°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œæœ¬è´¨åŒºåˆ«åœ¨äºŽå®ƒä¸“é—¨é’ˆå¯¹SLæ–‡æœ¬æ•°æ®çš„ç¨€ç–æ€§å’Œå¼‚è´¨æ€§è®¾è®¡ï¼Œé¿å…äº†ä¼ ç»Ÿæ–¹æ³•å¯¹å¯†é›†æˆ–è§„åˆ™æ—¶é—´åºåˆ—çš„ä¾èµ–ï¼ŒåŒæ—¶åˆ©ç”¨LLMçš„é€šç”¨è¯­ä¹‰ç†è§£èƒ½åŠ›å¢žå¼ºç‰¹å¾æå–ã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬ä½¿ç”¨LLMæç¤ºè¿›è¡Œæ–‡æœ¬åµŒå…¥ï¼Œå…·ä½“æç¤ºå†…å®¹æœªçŸ¥ï¼Œä½†æ—¨åœ¨ç”Ÿæˆåº”ç”¨ç‰¹å®šçš„æ•°å€¼è¡¨ç¤ºï¼›ç¨€ç–mFPCAéƒ¨åˆ†æ¶‰åŠå‡½æ•°ä¸»æˆåˆ†ä¼°è®¡ï¼Œå¤„ç†ä¸è§„åˆ™æ—¶é—´ç‚¹æ•°æ®ï¼Œå¯èƒ½åŸºäºŽåŸºå‡½æ•°å±•å¼€æˆ–åæ–¹å·®å¹³æ»‘æŠ€æœ¯ï¼›å¼‚å¸¸æ£€æµ‹åŸºäºŽä¸ªä½“çº§åˆ†æ•°å’Œåå˜é‡ï¼Œé‡‡ç”¨æ— ç›‘ç£æ–¹æ³•å¦‚èšç±»æˆ–ç¦»ç¾¤ç‚¹æ£€æµ‹ï¼›åŠ¨æ€å…³é”®è¯åˆ†æžåˆ©ç”¨LLMåœ¨æ•°æ®æ®µæŒ‡å¯¼ä¸‹ç”Ÿæˆè§£é‡Šæ€§å…³é”®è¯ã€‚å…·ä½“å‚æ•°è®¾ç½®å’ŒæŸå¤±å‡½æ•°æœªåœ¨æ‘˜è¦ä¸­è¯¦ç»†è¯´æ˜Žï¼Œéœ€å‚è€ƒè®ºæ–‡å…¨æ–‡ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

åœ¨äºšé©¬é€Šå®¢æˆ·è¯„è®ºæ•°æ®é›†å’Œç»´åŸºç™¾ç§‘è®¨è®ºé¡µè¯„è®ºæµä¸Šçš„å®žéªŒè¡¨æ˜Žï¼ŒLLmFPCA-detectä¼˜äºŽæœ€å…ˆè¿›çš„åŸºçº¿æ–¹æ³•ï¼Œå…·ä½“æ€§èƒ½æ•°æ®æœªçŸ¥ï¼Œä½†æ‘˜è¦æåˆ°å®ƒæå‡äº†é¢„æµ‹æ€§èƒ½ã€‚æ¡†æž¶å±•ç¤ºäº†è·¨é¢†åŸŸçš„ç¨³å®šæ€§å’Œå®žç”¨æ€§ï¼Œé€šè¿‡èšç±»ç‰¹å®šå‡½æ•°ä¸»æˆåˆ†åˆ†æ•°ä½œä¸ºç‰¹å¾ï¼Œæœ‰æ•ˆå¢žå¼ºäº†çŽ°æœ‰ä¸‹æ¸¸ä»»åŠ¡çš„æ€§èƒ½ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶åœ¨å®¢æˆ·è¯„è®ºåˆ†æžã€ç¤¾äº¤åª’ä½“ç›‘æŽ§ã€ç”µå­ç—…åŽ†æŒ–æŽ˜ç­‰é¢†åŸŸå…·æœ‰å¹¿æ³›åº”ç”¨ä»·å€¼ã€‚ä¾‹å¦‚ï¼Œä¼ä¸šå¯åŸºäºŽå®¢æˆ·è¯„è®ºè½¨è¿¹æ£€æµ‹å¼‚å¸¸åé¦ˆä»¥æ”¹è¿›äº§å“ï¼ŒåŒ»ç–—æœºæž„å¯ä»Žç¨€ç–å°±è¯Šè®°å½•ä¸­è¯†åˆ«æ‚£è€…å¼‚å¸¸æ¨¡å¼ä»¥è¾…åŠ©è¯Šæ–­ã€‚æœªæ¥å¯èƒ½æ‰©å±•åˆ°æ›´å¤šçºµå‘æ–‡æœ¬åœºæ™¯ï¼Œå¦‚æ•™è‚²è¯„ä¼°æˆ–æ”¿ç­–åˆ†æžï¼Œæå‡æ•°æ®é©±åŠ¨çš„å†³ç­–èƒ½åŠ›ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Sparse longitudinal (SL) textual data arises when individuals generate text repeatedly over time (e.g., customer reviews, occasional social media posts, electronic medical records across visits), but the frequency and timing of observations vary across individuals. These complex textual data sets have immense potential to inform future policy and targeted recommendations. However, because SL text data lack dedicated methods and are noisy, heterogeneous, and prone to anomalies, detecting and inferring key patterns is challenging. We introduce LLmFPCA-detect, a flexible framework that pairs LLM-based text embeddings with functional data analysis to detect clusters and infer anomalies in large SL text datasets. First, LLmFPCA-detect embeds each piece of text into an application-specific numeric space using LLM prompts. Sparse multivariate functional principal component analysis (mFPCA) conducted in the numeric space forms the workhorse to recover primary population characteristics, and produces subject-level scores which, together with baseline static covariates, facilitate data segmentation, unsupervised anomaly detection and inference, and enable other downstream tasks. In particular, we leverage LLMs to perform dynamic keyword profiling guided by the data segments and anomalies discovered by LLmFPCA-detect, and we show that cluster-specific functional PC scores from LLmFPCA-detect, used as features in existing pipelines, help boost prediction performance. We support the stability of LLmFPCA-detect with experiments and evaluate it on two different applications using public datasets, Amazon customer-review trajectories, and Wikipedia talk-page comment streams, demonstrating utility across domains and outperforming state-of-the-art baselines.

