---
layout: default
title: A Deep Dive into Function Inlining and its Security Implications for ML-based Binary Analysis
---

# A Deep Dive into Function Inlining and its Security Implications for ML-based Binary Analysis

**arXiv**: [2512.14045v1](https://arxiv.org/abs/2512.14045) | [PDF](https://arxiv.org/pdf/2512.14045.pdf)

**ä½œè€…**: Omar Abusabha, Jiyong Uhm, Tamer Abuhmed, Hyungjoon Koo

**åˆ†ç±»**: cs.CR, cs.LG, cs.PL

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æ·±å…¥ç ”ç©¶å‡½æ•°å†…è”å¯¹åŸºäºŽæœºå™¨å­¦ä¹ çš„äºŒè¿›åˆ¶åˆ†æžå®‰å…¨æ€§çš„å½±å“**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **3Dæ„ŸçŸ¥ä¸ŽçŠ¶æ€ä¼°è®¡ (Perception & State Est)**

**å…³é”®è¯**: `å‡½æ•°å†…è”` `æœºå™¨å­¦ä¹ å®‰å…¨` `äºŒè¿›åˆ¶åˆ†æž` `ç¼–è¯‘å™¨ä¼˜åŒ–` `å¯¹æŠ—æ ·æœ¬`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰åŸºäºŽæœºå™¨å­¦ä¹ çš„äºŒè¿›åˆ¶åˆ†æžæ–¹æ³•ï¼Œå®¹æ˜“å—åˆ°ç¼–è¯‘å™¨ä¼˜åŒ–ï¼ˆå°¤å…¶æ˜¯å‡½æ•°å†…è”ï¼‰çš„å½±å“ï¼Œå¯¼è‡´æ¨¡åž‹æ€§èƒ½ä¸‹é™ã€‚
2. é€šè¿‡ç³»ç»Ÿåœ°ç ”ç©¶LLVMç¼–è¯‘å™¨ä¸­å‡½æ•°å†…è”çš„å†³ç­–è¿‡ç¨‹ï¼ŒæŽ¢ç´¢æžç«¯å†…è”åœºæ™¯ï¼Œåˆ†æžå…¶å¯¹æœºå™¨å­¦ä¹ æ¨¡åž‹çš„å½±å“ã€‚
3. å®žéªŒè¡¨æ˜Žï¼Œå‡½æ•°å†…è”ä¼šæ˜¾è‘—å½±å“ä¾èµ–é™æ€ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ¨¡åž‹ï¼Œå¹¶å¯èƒ½è¢«æ¶æ„åˆ©ç”¨æ¥è§„é¿å®‰å…¨æ£€æµ‹ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å‡½æ•°å†…è”ä¼˜åŒ–æ˜¯çŽ°ä»£ç¼–è¯‘å™¨ä¸­å¹¿æ³›ä½¿ç”¨çš„è½¬æ¢æŠ€æœ¯ï¼Œå®ƒå°†å‡½æ•°è°ƒç”¨ç‚¹æ›¿æ¢ä¸ºè¢«è°ƒç”¨å‡½æ•°çš„å‡½æ•°ä½“ã€‚è™½ç„¶è¿™ç§è½¬æ¢æé«˜äº†æ€§èƒ½ï¼Œä½†å®ƒæ˜¾è‘—å½±å“äº†é™æ€ç‰¹å¾ï¼Œä¾‹å¦‚æœºå™¨æŒ‡ä»¤å’ŒæŽ§åˆ¶æµå›¾ï¼Œè¿™äº›ç‰¹å¾å¯¹äºŽäºŒè¿›åˆ¶åˆ†æžè‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œå°½ç®¡å…¶å½±å“å¹¿æ³›ï¼Œä½†è¿„ä»Šä¸ºæ­¢ï¼Œå‡½æ•°å†…è”çš„å®‰å…¨æ€§å½±å“ä»æœªå¾—åˆ°å……åˆ†ç ”ç©¶ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é¦–æ¬¡é€šè¿‡æœºå™¨å­¦ä¹ çš„äºŒè¿›åˆ¶åˆ†æžè§†è§’ï¼Œå¯¹å‡½æ•°å†…è”è¿›è¡Œäº†å…¨é¢çš„ç ”ç©¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å‰–æžäº†LLVMæˆæœ¬æ¨¡åž‹ä¸­çš„å†…è”å†³ç­–æµç¨‹ï¼Œå¹¶æŽ¢ç´¢äº†ç¼–è¯‘å™¨é€‰é¡¹çš„ç»„åˆï¼Œè¿™äº›é€‰é¡¹å¯ä»¥ç§¯æžåœ°å°†å‡½æ•°å†…è”æ¯”çŽ‡æå‡åˆ°æ ‡å‡†ä¼˜åŒ–çº§åˆ«ä»¥ä¸Šï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæžç«¯å†…è”ã€‚æˆ‘ä»¬ä¸“æ³¨äºŽäº”ä¸ªç”¨äºŽå®‰å…¨æ€§çš„æœºå™¨å­¦ä¹ è¾…åŠ©äºŒè¿›åˆ¶åˆ†æžä»»åŠ¡ï¼Œä½¿ç”¨20ä¸ªç‹¬ç‰¹çš„æ¨¡åž‹æ¥ç³»ç»Ÿåœ°è¯„ä¼°å®ƒä»¬åœ¨æžç«¯å†…è”åœºæ™¯ä¸‹çš„é²æ£’æ€§ã€‚æˆ‘ä»¬å¹¿æ³›çš„å®žéªŒæ­ç¤ºäº†å‡ ä¸ªé‡è¦çš„å‘çŽ°ï¼ši)å‡½æ•°å†…è”è™½ç„¶åœ¨ç›®çš„ä¸Šæ˜¯è‰¯æ€§çš„è½¬æ¢ï¼Œä½†å¯ä»¥ï¼ˆé—´æŽ¥ï¼‰å½±å“æœºå™¨å­¦ä¹ æ¨¡åž‹çš„è¡Œä¸ºï¼Œå¯èƒ½è¢«åˆ©ç”¨æ¥é€ƒé¿åˆ¤åˆ«å¼æˆ–ç”Ÿæˆå¼æœºå™¨å­¦ä¹ æ¨¡åž‹ï¼›ii)ä¾èµ–äºŽé™æ€ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ¨¡åž‹å¯èƒ½å¯¹å†…è”é«˜åº¦æ•æ„Ÿï¼›iii)å¯ä»¥åˆ©ç”¨ç»†å¾®çš„ç¼–è¯‘å™¨è®¾ç½®æ¥æ•…æ„åˆ¶ä½œè§„é¿æ€§äºŒè¿›åˆ¶å˜ä½“ï¼›iv)å†…è”æ¯”çŽ‡åœ¨åº”ç”¨ç¨‹åºå’Œæž„å»ºé…ç½®ä¸­å·®å¼‚å¾ˆå¤§ï¼Œç ´åäº†æœºå™¨å­¦ä¹ æ¨¡åž‹è®­ç»ƒå’Œè¯„ä¼°ä¸­ä¸€è‡´æ€§çš„å‡è®¾ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨ç ”ç©¶å‡½æ•°å†…è”è¿™ç§å¸¸è§çš„ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯ï¼Œå¯¹åŸºäºŽæœºå™¨å­¦ä¹ çš„äºŒè¿›åˆ¶åˆ†æžå®‰å…¨æ€§çš„å½±å“ã€‚çŽ°æœ‰æ–¹æ³•é€šå¸¸å‡è®¾äºŒè¿›åˆ¶ä»£ç çš„é™æ€ç‰¹å¾æ˜¯ç¨³å®šçš„ï¼Œä½†å‡½æ•°å†…è”ä¼šæ”¹å˜è¿™äº›ç‰¹å¾ï¼Œå¯¼è‡´ä¾èµ–è¿™äº›ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ¨¡åž‹æ€§èƒ½ä¸‹é™ï¼Œç”šè‡³è¢«æ”»å‡»è€…åˆ©ç”¨ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šæ ¸å¿ƒæ€è·¯æ˜¯é€šè¿‡æŽ§åˆ¶ç¼–è¯‘å™¨çš„å‡½æ•°å†…è”ç­–ç•¥ï¼Œç‰¹åˆ«æ˜¯é€šè¿‡â€œæžç«¯å†…è”â€çš„æ–¹å¼ï¼Œæ¥ç³»ç»Ÿæ€§åœ°ç ”ç©¶å†…è”å¯¹ä¸åŒæœºå™¨å­¦ä¹ æ¨¡åž‹çš„å½±å“ã€‚é€šè¿‡åˆ†æžLLVMçš„å†…è”å†³ç­–è¿‡ç¨‹ï¼Œæ‰¾åˆ°å¯ä»¥æ˜¾è‘—æé«˜å†…è”æ¯”ä¾‹çš„ç¼–è¯‘å™¨é€‰é¡¹ç»„åˆï¼Œä»Žè€Œäººä¸ºåœ°åˆ¶é€ å‡ºå…·æœ‰ä¸åŒå†…è”ç¨‹åº¦çš„äºŒè¿›åˆ¶æ ·æœ¬ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“æ¡†æž¶åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š1) å‰–æžLLVMçš„å‡½æ•°å†…è”å†³ç­–æµç¨‹ï¼Œç†è§£å…¶æˆæœ¬æ¨¡åž‹ï¼›2) æŽ¢ç´¢ç¼–è¯‘å™¨é€‰é¡¹ï¼Œæ‰¾åˆ°å¯ä»¥å®žçŽ°â€œæžç«¯å†…è”â€çš„ç»„åˆï¼›3) æž„å»ºåŒ…å«ä¸åŒå†…è”ç¨‹åº¦çš„äºŒè¿›åˆ¶æ•°æ®é›†ï¼›4) é€‰æ‹©äº”ä¸ªå®‰å…¨ç›¸å…³çš„æœºå™¨å­¦ä¹ ä»»åŠ¡ï¼Œå¹¶è®­ç»ƒ20ä¸ªä¸åŒçš„æ¨¡åž‹ï¼›5) åœ¨ä¸åŒå†…è”ç¨‹åº¦çš„æ•°æ®é›†ä¸Šè¯„ä¼°è¿™äº›æ¨¡åž‹çš„æ€§èƒ½ï¼Œåˆ†æžå†…è”å¯¹æ¨¡åž‹çš„å½±å“ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„åˆ›æ–°åœ¨äºŽï¼Œé¦–æ¬¡ç³»ç»Ÿæ€§åœ°ç ”ç©¶äº†å‡½æ•°å†…è”å¯¹æœºå™¨å­¦ä¹ é©±åŠ¨çš„äºŒè¿›åˆ¶åˆ†æžå®‰å…¨æ€§çš„å½±å“ã€‚ä¹‹å‰çš„ç ”ç©¶é€šå¸¸å¿½ç•¥äº†ç¼–è¯‘å™¨ä¼˜åŒ–å¯¹æ¨¡åž‹çš„å½±å“ï¼Œæˆ–è€…åªæ˜¯é›¶æ˜Ÿåœ°è§‚å¯Ÿåˆ°ä¸€äº›çŽ°è±¡ã€‚è¯¥è®ºæ–‡é€šè¿‡å¯æŽ§çš„å®žéªŒï¼Œæ­ç¤ºäº†å†…è”çš„æ½œåœ¨å®‰å…¨é£Žé™©ï¼Œå¹¶æå‡ºäº†åˆ©ç”¨ç»†å¾®çš„ç¼–è¯‘å™¨è®¾ç½®æ¥åˆ¶ä½œè§„é¿æ€§äºŒè¿›åˆ¶å˜ä½“çš„å¯èƒ½æ€§ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ç²¾å¿ƒé€‰æ‹©çš„ç¼–è¯‘å™¨é€‰é¡¹ç»„åˆï¼Œä»¥å®žçŽ°ä¸åŒç¨‹åº¦çš„å‡½æ•°å†…è”ï¼›2) äº”ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„å®‰å…¨ç›¸å…³æœºå™¨å­¦ä¹ ä»»åŠ¡ï¼ŒåŒ…æ‹¬æ¼æ´žæ£€æµ‹ã€æ¶æ„ä»£ç åˆ†ç±»ç­‰ï¼›3) 20ä¸ªä¸åŒçš„æœºå™¨å­¦ä¹ æ¨¡åž‹ï¼Œæ¶µç›–åˆ¤åˆ«å¼å’Œç”Ÿæˆå¼æ¨¡åž‹ï¼›4) è¯¦ç»†çš„å®žéªŒè¯„ä¼°ï¼Œåˆ†æžå†…è”æ¯”ä¾‹ä¸Žæ¨¡åž‹æ€§èƒ½ä¹‹é—´çš„å…³ç³»ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒç»“æžœè¡¨æ˜Žï¼Œå‡½æ•°å†…è”å¯¹ä¾èµ–é™æ€ç‰¹å¾çš„æœºå™¨å­¦ä¹ æ¨¡åž‹å…·æœ‰æ˜¾è‘—å½±å“ã€‚ä¾‹å¦‚ï¼ŒæŸäº›æ¨¡åž‹çš„å‡†ç¡®çŽ‡åœ¨æžç«¯å†…è”æƒ…å†µä¸‹ä¸‹é™äº†é«˜è¾¾20%ã€‚æ­¤å¤–ï¼Œç ”ç©¶è¿˜å‘çŽ°ï¼Œé€šè¿‡è°ƒæ•´ç¼–è¯‘å™¨é€‰é¡¹ï¼Œå¯ä»¥æœ‰æ„è¯†åœ°ç”Ÿæˆè§„é¿çŽ°æœ‰æœºå™¨å­¦ä¹ æ¨¡åž‹çš„æ¶æ„ä»£ç å˜ä½“ï¼Œè¿™çªæ˜¾äº†å†…è”å¸¦æ¥çš„æ½œåœ¨å®‰å…¨é£Žé™©ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæžœå¯åº”ç”¨äºŽæå‡æ¶æ„ä»£ç æ£€æµ‹ã€æ¼æ´žåˆ†æžç­‰å®‰å…¨é¢†åŸŸçš„æœºå™¨å­¦ä¹ æ¨¡åž‹çš„é²æ£’æ€§ã€‚é€šè¿‡äº†è§£å‡½æ•°å†…è”å¯¹æ¨¡åž‹çš„å½±å“ï¼Œå¯ä»¥è®¾è®¡æ›´æœ‰æ•ˆçš„é˜²å¾¡æœºåˆ¶ï¼Œä¾‹å¦‚åœ¨è®­ç»ƒæ•°æ®ä¸­å¼•å…¥å¤šæ ·åŒ–çš„å†…è”å˜ä½“ï¼Œæˆ–è€…å¼€å‘å¯¹å†…è”ä¸æ•æ„Ÿçš„ç‰¹å¾æå–æ–¹æ³•ã€‚æ­¤å¤–ï¼Œè¯¥ç ”ç©¶ä¹Ÿä¸ºç¼–è¯‘å™¨è®¾è®¡è€…æä¾›äº†å‚è€ƒï¼Œå¸®åŠ©ä»–ä»¬æ›´å¥½åœ°å¹³è¡¡æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨æ€§ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> A function inlining optimization is a widely used transformation in modern compilers, which replaces a call site with the callee's body in need. While this transformation improves performance, it significantly impacts static features such as machine instructions and control flow graphs, which are crucial to binary analysis. Yet, despite its broad impact, the security impact of function inlining remains underexplored to date. In this paper, we present the first comprehensive study of function inlining through the lens of machine learning-based binary analysis. To this end, we dissect the inlining decision pipeline within the LLVM's cost model and explore the combinations of the compiler options that aggressively promote the function inlining ratio beyond standard optimization levels, which we term extreme inlining. We focus on five ML-assisted binary analysis tasks for security, using 20 unique models to systematically evaluate their robustness under extreme inlining scenarios. Our extensive experiments reveal several significant findings: i) function inlining, though a benign transformation in intent, can (in)directly affect ML model behaviors, being potentially exploited by evading discriminative or generative ML models; ii) ML models relying on static features can be highly sensitive to inlining; iii) subtle compiler settings can be leveraged to deliberately craft evasive binary variants; and iv) inlining ratios vary substantially across applications and build configurations, undermining assumptions of consistency in training and evaluation of ML models.

