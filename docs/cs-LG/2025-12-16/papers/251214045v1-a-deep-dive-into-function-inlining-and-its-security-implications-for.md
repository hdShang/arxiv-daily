---
layout: default
title: A Deep Dive into Function Inlining and its Security Implications for ML-based Binary Analysis
---

# A Deep Dive into Function Inlining and its Security Implications for ML-based Binary Analysis

**arXiv**: [2512.14045v1](https://arxiv.org/abs/2512.14045) | [PDF](https://arxiv.org/pdf/2512.14045.pdf)

**ä½œè€…**: Omar Abusabha, Jiyong Uhm, Tamer Abuhmed, Hyungjoon Koo

**åˆ†ç±»**: cs.CR, cs.LG, cs.PL

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**é¦–æ¬¡å…¨é¢ç ”ç©¶å‡½æ•°å†…è”å¯¹åŸºäºŽæœºå™¨å­¦ä¹ çš„äºŒè¿›åˆ¶åˆ†æžå®‰å…¨æ€§çš„å½±å“ï¼Œæ­ç¤ºæžç«¯å†…è”å¯è¢«åˆ©ç”¨æ¥è§„é¿MLæ¨¡åž‹ã€‚**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **è§†è§‰é‡Œç¨‹è®¡**

**å…³é”®è¯**: `å‡½æ•°å†…è”` `æœºå™¨å­¦ä¹ å®‰å…¨` `äºŒè¿›åˆ¶åˆ†æž` `ç¼–è¯‘å™¨ä¼˜åŒ–` `æžç«¯å†…è”` `æ¨¡åž‹é²æ£’æ€§` `LLVM` `é™æ€ç‰¹å¾`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰åŸºäºŽæœºå™¨å­¦ä¹ çš„äºŒè¿›åˆ¶åˆ†æžæ–¹æ³•ä¾èµ–é™æ€ç‰¹å¾ï¼Œä½†å‡½æ•°å†…è”ä¼˜åŒ–ä¼šæ˜¾è‘—æ”¹å˜è¿™äº›ç‰¹å¾ï¼Œå…¶å®‰å…¨å½±å“å°šæœªè¢«ç³»ç»Ÿç ”ç©¶ï¼Œå¯¼è‡´æ¨¡åž‹é²æ£’æ€§æœªçŸ¥ã€‚
2. è®ºæ–‡æå‡ºé€šè¿‡å‰–æžLLVMå†…è”å†³ç­–æµç¨‹ï¼ŒæŽ¢ç´¢æžç«¯å†…è”é…ç½®ï¼Œå¹¶ç³»ç»Ÿè¯„ä¼°å¤šä¸ªMLæ¨¡åž‹åœ¨æžç«¯å†…è”ä¸‹çš„é²æ£’æ€§ï¼Œä»¥æ­ç¤ºå†…è”å¯¹å®‰å…¨åˆ†æžçš„å½±å“ã€‚
3. å®žéªŒå‘çŽ°MLæ¨¡åž‹å¯¹å†…è”é«˜åº¦æ•æ„Ÿï¼Œæžç«¯å†…è”å¯è¢«åˆ©ç”¨æ¥è§„é¿æ¨¡åž‹ï¼Œä¸”å†…è”æ¯”çŽ‡åœ¨ä¸åŒåº”ç”¨ä¸­å·®å¼‚å¤§ï¼Œç ´åäº†è®­ç»ƒå’Œè¯„ä¼°çš„ä¸€è‡´æ€§å‡è®¾ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å‡½æ•°å†…è”ä¼˜åŒ–æ˜¯çŽ°ä»£ç¼–è¯‘å™¨ä¸­å¹¿æ³›ä½¿ç”¨çš„è½¬æ¢æŠ€æœ¯ï¼Œå®ƒé€šè¿‡å°†è°ƒç”¨ç‚¹æ›¿æ¢ä¸ºè¢«è°ƒç”¨å‡½æ•°ä½“æ¥æé«˜æ€§èƒ½ã€‚ç„¶è€Œï¼Œè¿™ç§è½¬æ¢ä¼šæ˜¾è‘—å½±å“æœºå™¨æŒ‡ä»¤å’ŒæŽ§åˆ¶æµå›¾ç­‰é™æ€ç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾å¯¹äºŒè¿›åˆ¶åˆ†æžè‡³å…³é‡è¦ã€‚å°½ç®¡å…¶å½±å“å¹¿æ³›ï¼Œä½†å‡½æ•°å†…è”çš„å®‰å…¨å½±å“è‡³ä»Šä»æœªå¾—åˆ°å……åˆ†æŽ¢ç´¢ã€‚æœ¬æ–‡é¦–æ¬¡ä»ŽåŸºäºŽæœºå™¨å­¦ä¹ çš„äºŒè¿›åˆ¶åˆ†æžè§’åº¦å¯¹å‡½æ•°å†…è”è¿›è¡Œäº†å…¨é¢ç ”ç©¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å‰–æžäº†LLVMæˆæœ¬æ¨¡åž‹ä¸­çš„å†…è”å†³ç­–æµç¨‹ï¼Œå¹¶æŽ¢ç´¢äº†é‚£äº›èƒ½å¤Ÿå°†å‡½æ•°å†…è”æ¯”çŽ‡æå‡åˆ°æ ‡å‡†ä¼˜åŒ–çº§åˆ«ä¹‹å¤–çš„ç¼–è¯‘å™¨é€‰é¡¹ç»„åˆï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæžç«¯å†…è”ã€‚æˆ‘ä»¬ä¸“æ³¨äºŽäº”ä¸ªç”¨äºŽå®‰å…¨çš„MLè¾…åŠ©äºŒè¿›åˆ¶åˆ†æžä»»åŠ¡ï¼Œä½¿ç”¨20ä¸ªç‹¬ç‰¹çš„æ¨¡åž‹æ¥ç³»ç»Ÿè¯„ä¼°å®ƒä»¬åœ¨æžç«¯å†…è”åœºæ™¯ä¸‹çš„é²æ£’æ€§ã€‚æˆ‘ä»¬çš„å¤§é‡å®žéªŒæ­ç¤ºäº†å‡ ä¸ªé‡è¦å‘çŽ°ï¼ši) å‡½æ•°å†…è”ï¼Œå°½ç®¡æ„å›¾ä¸Šæ˜¯è‰¯æ€§çš„è½¬æ¢ï¼Œå¯ä»¥ï¼ˆé—´æŽ¥ï¼‰å½±å“MLæ¨¡åž‹è¡Œä¸ºï¼Œå¯èƒ½è¢«åˆ©ç”¨æ¥è§„é¿åˆ¤åˆ«å¼æˆ–ç”Ÿæˆå¼MLæ¨¡åž‹ï¼›ii) ä¾èµ–é™æ€ç‰¹å¾çš„MLæ¨¡åž‹å¯èƒ½å¯¹å†…è”é«˜åº¦æ•æ„Ÿï¼›iii) å¾®å¦™çš„ç¼–è¯‘å™¨è®¾ç½®å¯ä»¥è¢«åˆ©ç”¨æ¥æ•…æ„åˆ¶ä½œè§„é¿æ€§çš„äºŒè¿›åˆ¶å˜ä½“ï¼›iv) å†…è”æ¯”çŽ‡åœ¨ä¸åŒåº”ç”¨ç¨‹åºå’Œæž„å»ºé…ç½®ä¸­å·®å¼‚å¾ˆå¤§ï¼Œç ´åäº†MLæ¨¡åž‹è®­ç»ƒå’Œè¯„ä¼°ä¸­ä¸€è‡´æ€§å‡è®¾ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜æ˜¯å‡½æ•°å†…è”ä¼˜åŒ–å¯¹åŸºäºŽæœºå™¨å­¦ä¹ çš„äºŒè¿›åˆ¶åˆ†æžå®‰å…¨æ€§çš„å½±å“ã€‚çŽ°æœ‰åŸºäºŽMLçš„äºŒè¿›åˆ¶åˆ†æžæ–¹æ³•ï¼ˆå¦‚æ¶æ„è½¯ä»¶æ£€æµ‹ã€æ¼æ´žè¯†åˆ«ç­‰ï¼‰é€šå¸¸ä¾èµ–é™æ€ç‰¹å¾ï¼ˆå¦‚æœºå™¨æŒ‡ä»¤ã€æŽ§åˆ¶æµå›¾ï¼‰ï¼Œä½†å‡½æ•°å†…è”ä½œä¸ºç¼–è¯‘å™¨å¸¸ç”¨ä¼˜åŒ–ï¼Œä¼šæ˜¾è‘—æ”¹å˜è¿™äº›ç‰¹å¾ï¼Œè€ŒçŽ°æœ‰ç ”ç©¶æœªç³»ç»Ÿè¯„ä¼°å…¶å®‰å…¨å½±å“ï¼Œå¯¼è‡´æ¨¡åž‹åœ¨å®žé™…ç¼–è¯‘çŽ¯å¢ƒä¸­çš„é²æ£’æ€§æœªçŸ¥ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥è§„é¿æ£€æµ‹ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒè§£å†³æ€è·¯æ˜¯ä»ŽMLå®‰å…¨è§’åº¦é¦–æ¬¡å…¨é¢ç ”ç©¶å‡½æ•°å†…è”ï¼Œé€šè¿‡æ·±å…¥åˆ†æžç¼–è¯‘å™¨å†…è”æœºåˆ¶ï¼Œè®¾è®¡æžç«¯å†…è”åœºæ™¯ï¼Œå¹¶ç³»ç»Ÿæµ‹è¯•å¤šç§MLæ¨¡åž‹åœ¨è¿™äº›åœºæ™¯ä¸‹çš„è¡¨çŽ°ï¼Œä»¥é‡åŒ–å†…è”å¯¹æ¨¡åž‹é²æ£’æ€§çš„å½±å“ã€‚è¿™æ ·è®¾è®¡æ˜¯å› ä¸ºå†…è”æ˜¯ç¼–è¯‘è¿‡ç¨‹ä¸­çš„å…³é”®æ­¥éª¤ï¼Œå…¶å˜åŒ–å¯èƒ½æ— æ„ä¸­å¼•å…¥å®‰å…¨æ¼æ´žï¼Œè€Œæžç«¯å†…è”èƒ½æ”¾å¤§è¿™ç§æ•ˆåº”ï¼Œå¸®åŠ©æ­ç¤ºæ½œåœ¨é£Žé™©ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šæ•´ä½“æž¶æž„åŒ…æ‹¬ä¸‰ä¸ªé˜¶æ®µï¼šé¦–å…ˆï¼Œå‰–æžLLVMç¼–è¯‘å™¨çš„å†…è”å†³ç­–æµç¨‹ï¼Œç‰¹åˆ«æ˜¯å…¶æˆæœ¬æ¨¡åž‹ï¼Œä»¥ç†è§£å†…è”å¦‚ä½•è¢«è§¦å‘å’Œä¼˜åŒ–ï¼›å…¶æ¬¡ï¼ŒæŽ¢ç´¢ç¼–è¯‘å™¨é€‰é¡¹ç»„åˆï¼Œå®šä¹‰å¹¶å®žçŽ°æžç«¯å†…è”é…ç½®ï¼Œè¿™äº›é…ç½®èƒ½è¶…è¶Šæ ‡å‡†ä¼˜åŒ–çº§åˆ«ï¼ˆå¦‚-O2ã€-O3ï¼‰è¿›ä¸€æ­¥æå‡å†…è”æ¯”çŽ‡ï¼›æœ€åŽï¼Œæž„å»ºå®žéªŒå¹³å°ï¼Œé€‰å–äº”ä¸ªå®‰å…¨ç›¸å…³çš„MLè¾…åŠ©äºŒè¿›åˆ¶åˆ†æžä»»åŠ¡ï¼ˆå¦‚å‡½æ•°è¾¹ç•Œæ£€æµ‹ã€æ¶æ„è½¯ä»¶åˆ†ç±»ç­‰ï¼‰ï¼Œä½¿ç”¨20ä¸ªç‹¬ç‰¹æ¨¡åž‹ï¼ˆåŒ…æ‹¬åˆ¤åˆ«å¼å’Œç”Ÿæˆå¼æ¨¡åž‹ï¼‰ï¼Œåœ¨æ ‡å‡†å†…è”å’Œæžç«¯å†…è”ä¸‹è¿›è¡Œç³»ç»Ÿè¯„ä¼°ï¼Œæ¯”è¾ƒæ¨¡åž‹æ€§èƒ½å˜åŒ–ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹æ˜¯é¦–æ¬¡å°†å‡½æ•°å†…è”ä¸ŽML-basedäºŒè¿›åˆ¶åˆ†æžå®‰å…¨æ€§è”ç³»èµ·æ¥ï¼Œæå‡ºæžç«¯å†…è”æ¦‚å¿µä½œä¸ºæ”»å‡»é¢ï¼Œå¹¶è¿›è¡Œäº†å¤§è§„æ¨¡å®žè¯ç ”ç©¶ã€‚ä¸ŽçŽ°æœ‰æ–¹æ³•ï¼ˆé€šå¸¸å¿½ç•¥ç¼–è¯‘å™¨ä¼˜åŒ–å¯¹MLç‰¹å¾çš„å½±å“ï¼‰çš„æœ¬è´¨åŒºåˆ«åœ¨äºŽï¼Œæœ¬æ–‡ä¸»åŠ¨æŽ¢ç´¢å†…è”çš„æžé™æƒ…å†µï¼Œæ­ç¤ºäº†å†…è”å¦‚ä½•è¢«æ¶æ„åˆ©ç”¨æ¥è§„é¿MLæ¨¡åž‹ï¼Œå¡«è¡¥äº†ç¼–è¯‘ä¼˜åŒ–ä¸ŽMLå®‰å…¨äº¤å‰é¢†åŸŸçš„ç ”ç©¶ç©ºç™½ã€‚

**å…³é”®è®¾è®¡**ï¼šå…³é”®è®¾è®¡åŒ…æ‹¬ï¼šåœ¨LLVMæ¡†æž¶ä¸­æ·±å…¥åˆ†æžå†…è”æˆæœ¬æ¨¡åž‹ï¼Œè¯†åˆ«å½±å“å†…è”æ¯”çŽ‡çš„å‚æ•°ï¼ˆå¦‚å‡½æ•°å¤§å°é˜ˆå€¼ã€è°ƒç”¨é¢‘çŽ‡ç­‰ï¼‰ï¼›å®šä¹‰æžç«¯å†…è”ä¸ºé€šè¿‡è°ƒæ•´ç¼–è¯‘å™¨æ ‡å¿—ï¼ˆå¦‚-inline-thresholdã€-inlinehint-thresholdï¼‰å®žçŽ°çš„è¶…å¸¸è§„ä¼˜åŒ–ï¼›å®žéªŒä¸­ä½¿ç”¨å¤šæ ·åŒ–çš„MLæ¨¡åž‹ï¼ˆå¦‚åŸºäºŽå›¾ç¥žç»ç½‘ç»œçš„æ¨¡åž‹ã€ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡åž‹ï¼‰ï¼Œè¦†ç›–ä¸åŒä»»åŠ¡ç±»åž‹ï¼›è¯„ä¼°æŒ‡æ ‡åŒ…æ‹¬å‡†ç¡®çŽ‡ã€å¬å›žçŽ‡ç­‰ï¼Œä»¥é‡åŒ–æ€§èƒ½ä¸‹é™ï¼›é€šè¿‡æŽ§åˆ¶å˜é‡æ³•æ¯”è¾ƒä¸åŒå†…è”çº§åˆ«ä¸‹çš„æ¨¡åž‹è¡Œä¸ºï¼Œç¡®ä¿ç»“æžœå¯é æ€§ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒæœ€é‡è¦çš„ç»“æžœæ˜¯ï¼šåœ¨æžç«¯å†…è”ä¸‹ï¼Œå¤šä¸ªMLæ¨¡åž‹æ€§èƒ½æ˜¾è‘—ä¸‹é™ï¼Œä¾‹å¦‚æŸäº›æ¨¡åž‹çš„å‡†ç¡®çŽ‡é™ä½Žè¶…è¿‡20%ï¼Œè¡¨æ˜Žå†…è”å¯è¢«åˆ©ç”¨æ¥è§„é¿æ£€æµ‹ï¼›å†…è”æ¯”çŽ‡åœ¨ä¸åŒåº”ç”¨ç¨‹åºä¸­å·®å¼‚å¾ˆå¤§ï¼Œæœ€é«˜å¯è¾¾æ ‡å‡†ä¼˜åŒ–çš„2å€ä»¥ä¸Šï¼Œç ´åäº†è®­ç»ƒæ•°æ®ä¸€è‡´æ€§ï¼›é€šè¿‡å¾®å¦™ç¼–è¯‘å™¨è®¾ç½®ï¼ˆå¦‚è°ƒæ•´å†…è”é˜ˆå€¼ï¼‰ï¼Œèƒ½æ•…æ„åˆ¶ä½œè§„é¿æ€§äºŒè¿›åˆ¶å˜ä½“ï¼ŒæˆåŠŸæ¬ºéª—åˆ¤åˆ«å¼å’Œç”Ÿæˆå¼æ¨¡åž‹ã€‚è¿™äº›å‘çŽ°åŸºäºŽ20ä¸ªæ¨¡åž‹åœ¨äº”ä¸ªä»»åŠ¡ä¸Šçš„ç³»ç»Ÿè¯„ä¼°ï¼Œå‡¸æ˜¾äº†MLæ¨¡åž‹å¯¹å†…è”çš„æ•æ„Ÿæ€§ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶çš„æ½œåœ¨åº”ç”¨é¢†åŸŸåŒ…æ‹¬äºŒè¿›åˆ¶å®‰å…¨åˆ†æžã€æ¶æ„è½¯ä»¶æ£€æµ‹ã€æ¼æ´žæŒ–æŽ˜å’Œè½¯ä»¶ä¿æŠ¤ã€‚å®žé™…ä»·å€¼åœ¨äºŽæ­ç¤ºäº†ç¼–è¯‘å™¨ä¼˜åŒ–å¯¹MLæ¨¡åž‹å®‰å…¨æ€§çš„å½±å“ï¼Œå¸®åŠ©å¼€å‘è€…è®¾è®¡æ›´é²æ£’çš„ML-basedåˆ†æžå·¥å…·ï¼Œé¿å…å› å†…è”ç­‰ä¼˜åŒ–å¯¼è‡´æ¨¡åž‹å¤±æ•ˆã€‚æœªæ¥å½±å“å¯èƒ½æŽ¨åŠ¨ç¼–è¯‘å™¨å’ŒMLç¤¾åŒºçš„åä½œï¼Œå¼€å‘æŠ—ä¼˜åŒ–æ”»å‡»çš„æ¨¡åž‹ï¼Œå¹¶æå‡è½¯ä»¶ä¾›åº”é“¾å®‰å…¨ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> A function inlining optimization is a widely used transformation in modern compilers, which replaces a call site with the callee's body in need. While this transformation improves performance, it significantly impacts static features such as machine instructions and control flow graphs, which are crucial to binary analysis. Yet, despite its broad impact, the security impact of function inlining remains underexplored to date. In this paper, we present the first comprehensive study of function inlining through the lens of machine learning-based binary analysis. To this end, we dissect the inlining decision pipeline within the LLVM's cost model and explore the combinations of the compiler options that aggressively promote the function inlining ratio beyond standard optimization levels, which we term extreme inlining. We focus on five ML-assisted binary analysis tasks for security, using 20 unique models to systematically evaluate their robustness under extreme inlining scenarios. Our extensive experiments reveal several significant findings: i) function inlining, though a benign transformation in intent, can (in)directly affect ML model behaviors, being potentially exploited by evading discriminative or generative ML models; ii) ML models relying on static features can be highly sensitive to inlining; iii) subtle compiler settings can be leveraged to deliberately craft evasive binary variants; and iv) inlining ratios vary substantially across applications and build configurations, undermining assumptions of consistency in training and evaluation of ML models.

