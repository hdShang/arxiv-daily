---
layout: default
title: Maximum Mean Discrepancy with Unequal Sample Sizes via Generalized U-Statistics
---

# Maximum Mean Discrepancy with Unequal Sample Sizes via Generalized U-Statistics

**arXiv**: [2512.13997v1](https://arxiv.org/abs/2512.13997) | [PDF](https://arxiv.org/pdf/2512.13997.pdf)

**ä½œè€…**: Aaron Wei, Milad Jalali, Danica J. Sutherland

**åˆ†ç±»**: stat.ML, cs.LG, math.ST, stat.ME

**å‘å¸ƒæ—¥æœŸ**: 2025-12-16

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**é€šè¿‡å¹¿ä¹‰U-ç»Ÿè®¡é‡è§£å†³éžç­‰æ ·æœ¬é‡MMDçš„åˆ†å¸ƒè¡¨å¾ä¸Žæ£€éªŒä¼˜åŒ–é—®é¢˜**

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **åŠ¨ä½œç”Ÿæˆä¸Žç‰©ç†åŠ¨ç”» (Animation & Physics)** **3Dæ„ŸçŸ¥ä¸ŽçŠ¶æ€ä¼°è®¡ (Perception & State Est)**

**å…³é”®è¯**: `æœ€å¤§å‡å€¼å·®å¼‚` `åŒæ ·æœ¬æ£€éªŒ` `å¹¿ä¹‰U-ç»Ÿè®¡é‡` `éžç­‰æ ·æœ¬é‡` `æ¸è¿‘åˆ†å¸ƒ` `æ ¸æ–¹æ³•` `å‡è®¾æ£€éªŒ`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. çŽ°æœ‰åŸºäºŽMMDçš„åŒæ ·æœ¬æ£€éªŒæ–¹æ³•é€šå¸¸å‡è®¾æ ·æœ¬é‡ç›¸ç­‰ï¼Œé™åˆ¶äº†å…¶åœ¨å®žé™…åœºæ™¯ä¸­çš„åº”ç”¨ï¼Œé™ä½Žäº†æ£€éªŒæ•ˆåŠ›ã€‚
2. æœ¬æ–‡é€šè¿‡æ‰©å±•å¹¿ä¹‰U-ç»Ÿè®¡é‡ç†è®ºï¼ŒæŽ¨å¯¼äº†éžç­‰æ ·æœ¬é‡ä¸‹MMDä¼°è®¡å™¨çš„æ¸è¿‘åˆ†å¸ƒï¼Œå¹¶æå‡ºäº†æ–°çš„æ£€éªŒæ•ˆåŠ›ä¼˜åŒ–å‡†åˆ™ã€‚
3. è¯¥æ–¹æ³•ä¿ç•™äº†æ‰€æœ‰å¯ç”¨æ•°æ®ï¼Œæé«˜äº†æ£€éªŒçš„å‡†ç¡®æ€§å’Œé€‚ç”¨æ€§ï¼Œå¹¶æ­ç¤ºäº†MMDä¼°è®¡å™¨æ–¹å·®çš„ä¸€äº›æœ‰è¶£æ€§è´¨ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

çŽ°æœ‰çš„åŒæ ·æœ¬æ£€éªŒæŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯é‚£äº›åŸºäºŽæœ€å¤§å‡å€¼å·®å¼‚ï¼ˆMMDï¼‰æ ¸é€‰æ‹©çš„æ–¹æ³•ï¼Œé€šå¸¸å‡è®¾ä¸¤ä¸ªåˆ†å¸ƒçš„æ ·æœ¬é‡ç›¸ç­‰ã€‚åœ¨å®žè·µä¸­åº”ç”¨è¿™äº›æ–¹æ³•å¯èƒ½éœ€è¦ä¸¢å¼ƒæœ‰ä»·å€¼çš„æ•°æ®ï¼Œä¸å¿…è¦åœ°é™ä½Žæ£€éªŒæ•ˆåŠ›ã€‚æœ¬æ–‡é€šè¿‡æ‰©å±•å¹¿ä¹‰U-ç»Ÿè®¡é‡çš„ç†è®ºå¹¶å°†å…¶åº”ç”¨äºŽå¸¸ç”¨çš„MMDä¼°è®¡å™¨ï¼Œè§£å†³äº†è¿™ä¸€é•¿æœŸå­˜åœ¨çš„é™åˆ¶ï¼Œä»Žè€Œå¯¹éžç­‰æ ·æœ¬é‡ï¼ˆç‰¹åˆ«æ˜¯è¶…å‡ºå…ˆå‰éƒ¨åˆ†ç»“æžœæ‰€éœ€çš„æ¯”ä¾‹èŒƒå›´ï¼‰çš„MMDä¼°è®¡å™¨çš„æ¸è¿‘åˆ†å¸ƒè¿›è¡Œäº†æ–°çš„è¡¨å¾ã€‚è¿™ç§æŽ¨å¹¿è¿˜ä¸ºä¼˜åŒ–éžç­‰æ ·æœ¬é‡MMDæ£€éªŒçš„æ•ˆåŠ›æä¾›äº†ä¸€ä¸ªæ–°çš„æ ‡å‡†ã€‚æˆ‘ä»¬çš„æ–¹æ³•ä¿ç•™äº†æ‰€æœ‰å¯ç”¨çš„æ•°æ®ï¼Œä»Žè€Œæé«˜äº†æ£€éªŒçš„å‡†ç¡®æ€§å’Œåœ¨å®žé™…çŽ¯å¢ƒä¸­çš„é€‚ç”¨æ€§ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ç»™å‡ºäº†æ›´æ¸…æ™°çš„MMDä¼°è®¡å™¨æ–¹å·®çš„è¡¨å¾ï¼Œæ­ç¤ºäº†ä¸€ä¸ªå¯èƒ½è®©è¯¥é¢†åŸŸçš„äººæ„Ÿåˆ°æƒŠè®¶çš„çŽ°è±¡ï¼šè™½ç„¶é›¶MMDæ„å‘³ç€é€€åŒ–çš„ä¼°è®¡å™¨ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½å­˜åœ¨éžé›¶MMDçš„é€€åŒ–ä¼°è®¡å™¨ï¼›æˆ‘ä»¬ç»™å‡ºäº†ä¸€ä¸ªæž„é€ ï¼Œå¹¶è¯æ˜Žå®ƒä¸ä¼šåœ¨å¸¸è§æƒ…å†µä¸‹å‘ç”Ÿã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè®ºæ–‡æ—¨åœ¨è§£å†³åŒæ ·æœ¬æ£€éªŒä¸­ï¼Œå½“ä¸¤ä¸ªæ ·æœ¬çš„æ ·æœ¬é‡ä¸ç›¸ç­‰æ—¶ï¼Œå¦‚ä½•æœ‰æ•ˆåœ°åˆ©ç”¨æœ€å¤§å‡å€¼å·®å¼‚ï¼ˆMMDï¼‰è¿›è¡Œåˆ†å¸ƒå·®å¼‚æ€§æ£€éªŒçš„é—®é¢˜ã€‚çŽ°æœ‰æ–¹æ³•é€šå¸¸å‡è®¾æ ·æœ¬é‡ç›¸ç­‰ï¼Œæˆ–è€…åªåœ¨æ ·æœ¬é‡æˆæ¯”ä¾‹çš„æƒ…å†µä¸‹æœ‰æ•ˆï¼Œè¿™å¯¼è‡´äº†æ•°æ®æµªè´¹å’Œæ£€éªŒæ•ˆåŠ›é™ä½Žã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯å°†å¹¿ä¹‰U-ç»Ÿè®¡é‡çš„ç†è®ºæ‰©å±•åˆ°MMDä¼°è®¡å™¨ï¼Œä»Žè€ŒæŽ¨å¯¼å‡ºéžç­‰æ ·æœ¬é‡ä¸‹MMDä¼°è®¡å™¨çš„æ¸è¿‘åˆ†å¸ƒã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥é¿å…ä¸¢å¼ƒæ•°æ®ï¼Œå¹¶æ›´å‡†ç¡®åœ°è¯„ä¼°ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ã€‚æ­¤å¤–ï¼Œè®ºæ–‡è¿˜æå‡ºäº†ä¸€ä¸ªæ–°çš„å‡†åˆ™æ¥ä¼˜åŒ–éžç­‰æ ·æœ¬é‡MMDæ£€éªŒçš„æ•ˆåŠ›ã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šè®ºæ–‡çš„ä¸»è¦æŠ€æœ¯æ¡†æž¶åŒ…æ‹¬ï¼š1) æ‰©å±•å¹¿ä¹‰U-ç»Ÿè®¡é‡çš„ç†è®ºï¼›2) å°†æ‰©å±•åŽçš„ç†è®ºåº”ç”¨äºŽMMDä¼°è®¡å™¨ï¼›3) æŽ¨å¯¼éžç­‰æ ·æœ¬é‡ä¸‹MMDä¼°è®¡å™¨çš„æ¸è¿‘åˆ†å¸ƒï¼›4) æå‡ºæ–°çš„æ£€éªŒæ•ˆåŠ›ä¼˜åŒ–å‡†åˆ™ï¼›5) åˆ†æžMMDä¼°è®¡å™¨çš„æ–¹å·®ï¼Œå¹¶æ­ç¤ºå…¶ä¸€äº›æœ‰è¶£çš„æ€§è´¨ã€‚

**å…³é”®åˆ›æ–°**ï¼šè®ºæ–‡æœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹åœ¨äºŽå°†å¹¿ä¹‰U-ç»Ÿè®¡é‡çš„ç†è®ºæˆåŠŸæ‰©å±•åˆ°éžç­‰æ ·æœ¬é‡çš„MMDä¼°è®¡å™¨ï¼Œä»Žè€Œå…‹æœäº†çŽ°æœ‰æ–¹æ³•å¯¹æ ·æœ¬é‡ç›¸ç­‰æˆ–æˆæ¯”ä¾‹çš„é™åˆ¶ã€‚æ­¤å¤–ï¼Œè®ºæ–‡è¿˜æå‡ºäº†ä¸€ä¸ªæ–°çš„æ£€éªŒæ•ˆåŠ›ä¼˜åŒ–å‡†åˆ™ï¼Œå¹¶æ­ç¤ºäº†MMDä¼°è®¡å™¨æ–¹å·®çš„ä¸€äº›åç›´è§‰çš„æ€§è´¨ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡çš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ä½¿ç”¨å¹¿ä¹‰U-ç»Ÿè®¡é‡æ¥å¤„ç†éžç­‰æ ·æœ¬é‡çš„æƒ…å†µï¼›2) æŽ¨å¯¼MMDä¼°è®¡å™¨çš„æ¸è¿‘åˆ†å¸ƒï¼Œä»¥ä¾¿è¿›è¡Œå‡è®¾æ£€éªŒï¼›3) è®¾è®¡æ–°çš„æ£€éªŒæ•ˆåŠ›ä¼˜åŒ–å‡†åˆ™ï¼Œä»¥æé«˜æ£€éªŒçš„å‡†ç¡®æ€§ï¼›4) åˆ†æžMMDä¼°è®¡å™¨çš„æ–¹å·®ï¼Œä»¥äº†è§£å…¶ç»Ÿè®¡æ€§è´¨ã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

è®ºæ–‡çš„ä¸»è¦å®žéªŒç»“æžœé›†ä¸­åœ¨ç†è®ºæŽ¨å¯¼å’Œåˆ†æžä¸Šï¼Œé€šè¿‡å¯¹MMDä¼°è®¡å™¨æ–¹å·®çš„åˆ†æžï¼Œæ­ç¤ºäº†é›¶MMDå¹¶ä¸æ€»æ˜¯æ„å‘³ç€éžé€€åŒ–ä¼°è®¡å™¨ï¼Œä»¥åŠéžé›¶MMDä¹Ÿå¯èƒ½å‡ºçŽ°é€€åŒ–ä¼°è®¡å™¨çš„æƒ…å†µã€‚è™½ç„¶æ‘˜è¦ä¸­æ²¡æœ‰æ˜Žç¡®æåŠå…·ä½“çš„æ•°å€¼å®žéªŒç»“æžœï¼Œä½†ç†è®ºåˆ†æžä¸ºåŽç»­çš„å®žéªŒéªŒè¯æä¾›äº†åšå®žçš„åŸºç¡€ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæžœå¯å¹¿æ³›åº”ç”¨äºŽéœ€è¦è¿›è¡ŒåŒæ ·æœ¬æ£€éªŒçš„é¢†åŸŸï¼Œä¾‹å¦‚ç”Ÿç‰©ä¿¡æ¯å­¦ï¼ˆæ¯”è¾ƒä¸åŒç–¾ç—…çš„åŸºå› è¡¨è¾¾è°±ï¼‰ã€é‡‘èžå­¦ï¼ˆæ¯”è¾ƒä¸åŒæŠ•èµ„ç­–ç•¥çš„æ”¶ç›Šåˆ†å¸ƒï¼‰ã€å›¾åƒå¤„ç†ï¼ˆæ¯”è¾ƒä¸åŒå›¾åƒç”Ÿæˆæ¨¡åž‹çš„è¾“å‡ºè´¨é‡ï¼‰ç­‰ã€‚è¯¥æ–¹æ³•èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°åˆ©ç”¨æ•°æ®ï¼Œæé«˜æ£€éªŒçš„å‡†ç¡®æ€§å’Œå¯é æ€§ï¼Œä»Žè€Œä¸ºç›¸å…³é¢†åŸŸçš„å†³ç­–æä¾›æ›´å¯é çš„ä¾æ®ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Existing two-sample testing techniques, particularly those based on choosing a kernel for the Maximum Mean Discrepancy (MMD), often assume equal sample sizes from the two distributions. Applying these methods in practice can require discarding valuable data, unnecessarily reducing test power. We address this long-standing limitation by extending the theory of generalized U-statistics and applying it to the usual MMD estimator, resulting in new characterization of the asymptotic distributions of the MMD estimator with unequal sample sizes (particularly outside the proportional regimes required by previous partial results). This generalization also provides a new criterion for optimizing the power of an MMD test with unequal sample sizes. Our approach preserves all available data, enhancing test accuracy and applicability in realistic settings. Along the way, we give much cleaner characterizations of the variance of MMD estimators, revealing something that might be surprising to those in the area: while zero MMD implies a degenerate estimator, it is sometimes possible to have a degenerate estimator with nonzero MMD as well; we give a construction and a proof that it does not happen in common situations.

