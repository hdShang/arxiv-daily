---
layout: default
title: 4KDehazeFlow: Ultra-High-Definition Image Dehazing via Flow Matching
---

# 4KDehazeFlow: Ultra-High-Definition Image Dehazing via Flow Matching

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2511.09055" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2511.09055v1</a>
  <a href="https://arxiv.org/pdf/2511.09055.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2511.09055v1" onclick="toggleFavorite(this, '2511.09055v1', '4KDehazeFlow: Ultra-High-Definition Image Dehazing via Flow Matching')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Xingchi Chen, Pu Wang, Xuerui Li, Chaopeng Li, Juxiang Zhou, Jianhou Gan, Dianjie Lu, Guijuan Zhang, Wenqi Ren, Zhuoran Zheng

**åˆ†ç±»**: cs.CV

**å‘å¸ƒæ—¥æœŸ**: 2025-11-12

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡º4KDehazeFlowï¼Œé€šè¿‡Flow Matchingå®ç°è¶…é«˜æ¸…å›¾åƒå»é›¾ï¼Œæå‡è‰²å½©ä¿çœŸåº¦ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `å›¾åƒå»é›¾` `Flow Matching` `å‘é‡åœº` `3DæŸ¥æ‰¾è¡¨` `å¸¸å¾®åˆ†æ–¹ç¨‹` `è¶…é«˜æ¸…å›¾åƒ` `è‰²å½©ä¿çœŸåº¦`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ç°æœ‰åŸºäºå…ˆéªŒçš„æ–¹æ³•åœºæ™¯é€‚åº”æ€§æœ‰é™ï¼Œæ·±åº¦å­¦ä¹ æ–¹æ³•è®¡ç®—å¤æ‚åº¦é«˜ä¸”æ˜“äº§ç”Ÿé¢œè‰²å¤±çœŸï¼Œè¶…é«˜æ¸…å›¾åƒå»é›¾é¢ä¸´æŒ‘æˆ˜ã€‚
2. 4KDehazeFlowå°†å»é›¾å»ºæ¨¡ä¸ºè¿ç»­å‘é‡åœºæµçš„ä¼˜åŒ–ï¼Œåˆ©ç”¨æ•°æ®é©±åŠ¨çš„è‡ªé€‚åº”éçº¿æ€§é¢œè‰²å˜æ¢å®ç°é«˜è´¨é‡å»é›¾ã€‚
3. å®éªŒç»“æœè¡¨æ˜ï¼Œ4KDehazeFlowåœ¨PSNRä¸Šæå‡äº†2dBï¼Œå¹¶åœ¨æµ“é›¾å’Œè‰²å½©ä¿çœŸåº¦æ–¹é¢ä¼˜äºç°æœ‰æ–¹æ³•ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºFlow Matchingå’ŒHaze-Awareå‘é‡åœºçš„è¶…é«˜æ¸…å›¾åƒå»é›¾æ–¹æ³•4KDehazeFlowã€‚è¯¥æ–¹æ³•å°†å»é›¾è¿‡ç¨‹å»ºæ¨¡ä¸ºè¿ç»­å‘é‡åœºæµçš„æ¸è¿›ä¼˜åŒ–ï¼Œä¸ºé«˜è´¨é‡å»é›¾æä¾›é«˜æ•ˆçš„æ•°æ®é©±åŠ¨è‡ªé€‚åº”éçº¿æ€§é¢œè‰²å˜æ¢ã€‚4KDehazeFlowå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼šé€šç”¨æ€§å¼ºï¼Œå…¼å®¹å„ç§æ·±åº¦å­¦ä¹ ç½‘ç»œï¼›æå‡ºå¯å­¦ä¹ çš„3DæŸ¥æ‰¾è¡¨ï¼ˆLUTï¼‰ï¼Œå°†é›¾éœ¾å˜æ¢å‚æ•°ç¼–ç ä¸ºç´§å‡‘çš„3Dæ˜ å°„çŸ©é˜µï¼Œå®ç°é«˜æ•ˆæ¨ç†ï¼›åˆ©ç”¨å››é˜¶é¾™æ ¼-åº“å¡”ï¼ˆRK4ï¼‰å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰æ±‚è§£å™¨ï¼Œé€šè¿‡ç²¾ç¡®çš„é€æ­¥è¿­ä»£æ–¹æ³•ç¨³å®šåœ°æ±‚è§£å»é›¾æµåœºï¼Œæœ‰æ•ˆæŠ‘åˆ¶ä¼ªå½±ã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼Œ4KDehazeFlowä¼˜äºä¸ƒç§æœ€å…ˆè¿›çš„æ–¹æ³•ï¼Œåœ¨PSNRä¸Šæå‡äº†2dBï¼Œå¹¶åœ¨æµ“é›¾å’Œè‰²å½©ä¿çœŸåº¦æ–¹é¢è¡¨ç°æ›´å¥½ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šè¶…é«˜æ¸…å›¾åƒå»é›¾æ—¨åœ¨æ¢å¤è¢«é›¾éœ¾é®è”½çš„å›¾åƒç»†èŠ‚å’Œè‰²å½©ï¼Œç°æœ‰æ–¹æ³•ä¸»è¦å­˜åœ¨ä¸¤ä¸ªç—›ç‚¹ï¼šä¸€æ˜¯åŸºäºå…ˆéªŒçš„æ–¹æ³•éš¾ä»¥é€‚åº”å¤æ‚å¤šå˜çš„åœºæ™¯ï¼›äºŒæ˜¯æ·±åº¦å­¦ä¹ æ–¹æ³•è®¡ç®—é‡å¤§ï¼Œä¸”å®¹æ˜“å¼•å…¥é¢œè‰²å¤±çœŸç­‰ä¼ªå½±ã€‚å› æ­¤ï¼Œå¦‚ä½•åœ¨ä¿è¯å»é›¾æ•ˆæœçš„åŒæ—¶ï¼Œé™ä½è®¡ç®—å¤æ‚åº¦å¹¶æå‡è‰²å½©ä¿çœŸåº¦æ˜¯äºŸå¾…è§£å†³çš„é—®é¢˜ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯å°†å»é›¾è¿‡ç¨‹å»ºæ¨¡ä¸ºä¸€ä¸ªè¿ç»­çš„å‘é‡åœºæµï¼Œé€šè¿‡Flow Matchingå­¦ä¹ ä¸€ä¸ªHaze-Awareçš„å‘é‡åœºï¼Œç„¶ååˆ©ç”¨æ•°å€¼æ–¹æ³•æ±‚è§£è¯¥å‘é‡åœºï¼Œé€æ­¥ä¼˜åŒ–å›¾åƒçš„æ¸…æ™°åº¦ã€‚è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒåœ¨äºåˆ©ç”¨æ•°æ®é©±åŠ¨çš„æ–¹å¼å­¦ä¹ å»é›¾çš„éçº¿æ€§å˜æ¢ï¼Œé¿å…äº†äººä¸ºå…ˆéªŒçš„é™åˆ¶ï¼ŒåŒæ—¶é€šè¿‡æ•°å€¼æ±‚è§£ä¿è¯äº†å˜æ¢çš„å¹³æ»‘æ€§å’Œç¨³å®šæ€§ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼š4KDehazeFlowçš„æ•´ä½“æ¡†æ¶ä¸»è¦åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼š1) Haze-Awareå‘é‡åœºå­¦ä¹ æ¨¡å—ï¼Œç”¨äºå­¦ä¹ é›¾éœ¾ç›¸å…³çš„å‘é‡åœºï¼›2) 3DæŸ¥æ‰¾è¡¨ï¼ˆLUTï¼‰ç¼–ç æ¨¡å—ï¼Œå°†å­¦ä¹ åˆ°çš„å‘é‡åœºå‚æ•°ç¼–ç åˆ°ç´§å‡‘çš„3Dæ˜ å°„çŸ©é˜µä¸­ï¼ŒåŠ é€Ÿæ¨ç†è¿‡ç¨‹ï¼›3) å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰æ±‚è§£æ¨¡å—ï¼Œåˆ©ç”¨å››é˜¶é¾™æ ¼-åº“å¡”ï¼ˆRK4ï¼‰æ–¹æ³•æ±‚è§£å‘é‡åœºï¼Œé€æ­¥è¿­ä»£ä¼˜åŒ–å›¾åƒæ¸…æ™°åº¦ã€‚æ•´ä¸ªæµç¨‹é¦–å…ˆé€šè¿‡æ·±åº¦å­¦ä¹ ç½‘ç»œå­¦ä¹ å‘é‡åœºï¼Œç„¶åå°†å‘é‡åœºä¿¡æ¯å‹ç¼©åˆ°LUTä¸­ï¼Œæœ€ååˆ©ç”¨ODEæ±‚è§£å™¨è¿›è¡Œå›¾åƒå»é›¾ã€‚

**å…³é”®åˆ›æ–°**ï¼šè¯¥è®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºä»¥ä¸‹å‡ ç‚¹ï¼š1) å°†Flow Matchingå¼•å…¥å›¾åƒå»é›¾é¢†åŸŸï¼Œå°†å»é›¾è¿‡ç¨‹å»ºæ¨¡ä¸ºè¿ç»­å‘é‡åœºçš„ä¼˜åŒ–ï¼›2) æå‡ºäº†å¯å­¦ä¹ çš„3DæŸ¥æ‰¾è¡¨ï¼ˆLUTï¼‰ï¼Œç”¨äºé«˜æ•ˆç¼–ç å’Œæ¨ç†é›¾éœ¾å˜æ¢å‚æ•°ï¼Œæ˜¾è‘—é™ä½äº†è®¡ç®—å¤æ‚åº¦ï¼›3) åˆ©ç”¨å››é˜¶é¾™æ ¼-åº“å¡”ï¼ˆRK4ï¼‰æ–¹æ³•æ±‚è§£ODEï¼Œä¿è¯äº†æ•°å€¼è§£çš„ç¨³å®šæ€§å’Œç²¾åº¦ï¼Œæœ‰æ•ˆæŠ‘åˆ¶äº†ä¼ªå½±ã€‚ä¸ç°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•æ›´åŠ é€šç”¨ã€é«˜æ•ˆä¸”èƒ½æ›´å¥½åœ°ä¿æŒè‰²å½©ä¿çœŸåº¦ã€‚

**å…³é”®è®¾è®¡**ï¼šåœ¨Haze-Awareå‘é‡åœºå­¦ä¹ æ¨¡å—ä¸­ï¼Œä½¿ç”¨äº†æ·±åº¦å­¦ä¹ ç½‘ç»œï¼ˆå…·ä½“ç½‘ç»œç»“æ„æœªæ˜ç¡®è¯´æ˜ï¼Œä½†å…¼å®¹å„ç§ç½‘ç»œï¼‰ï¼Œé€šè¿‡æœ€å°åŒ–Flow MatchingæŸå¤±å‡½æ•°æ¥å­¦ä¹ å‘é‡åœºã€‚3D LUTçš„å¤§å°æ˜¯ä¸€ä¸ªå…³é”®å‚æ•°ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ï¼Œä»¥å¹³è¡¡è®¡ç®—å¤æ‚åº¦å’Œç²¾åº¦ã€‚RK4æ±‚è§£å™¨çš„æ­¥é•¿ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦å‚æ•°ï¼Œéœ€è¦é€‰æ‹©åˆé€‚çš„æ­¥é•¿ä»¥ä¿è¯æ±‚è§£çš„ç¨³å®šæ€§å’Œç²¾åº¦ã€‚æŸå¤±å‡½æ•°çš„è®¾è®¡ä¹Ÿè‡³å…³é‡è¦ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘å»é›¾æ•ˆæœã€è‰²å½©ä¿çœŸåº¦å’Œç»“æ„ç›¸ä¼¼æ€§ç­‰å› ç´ ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

å®éªŒç»“æœè¡¨æ˜ï¼Œ4KDehazeFlowåœ¨å¤šä¸ªæ•°æ®é›†ä¸Šè¶…è¶Šäº†ä¸ƒç§æœ€å…ˆè¿›çš„å»é›¾æ–¹æ³•ã€‚åœ¨PSNRæŒ‡æ ‡ä¸Šï¼Œ4KDehazeFlowå¹³å‡æå‡äº†2dBï¼Œå°¤å…¶åœ¨å¤„ç†æµ“é›¾å›¾åƒæ—¶è¡¨ç°æ›´åŠ å‡ºè‰²ã€‚æ­¤å¤–ï¼Œè¯¥æ–¹æ³•åœ¨è‰²å½©ä¿çœŸåº¦æ–¹é¢ä¹Ÿå–å¾—äº†æ˜¾è‘—çš„æå‡ï¼Œæœ‰æ•ˆé¿å…äº†é¢œè‰²å¤±çœŸç­‰é—®é¢˜ã€‚è¿™äº›å®éªŒç»“æœå……åˆ†éªŒè¯äº†4KDehazeFlowçš„æœ‰æ•ˆæ€§å’Œä¼˜è¶Šæ€§ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

4KDehazeFlowåœ¨å®‰é˜²ç›‘æ§ã€è‡ªåŠ¨é©¾é©¶ã€é¥æ„Ÿå›¾åƒå¤„ç†ç­‰é¢†åŸŸå…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚åœ¨å®‰é˜²ç›‘æ§ä¸­ï¼Œå¯ä»¥æå‡é›¾éœ¾å¤©æ°”ä¸‹çš„ç›‘æ§å›¾åƒè´¨é‡ï¼Œæé«˜ç›®æ ‡æ£€æµ‹å’Œè¯†åˆ«çš„å‡†ç¡®ç‡ã€‚åœ¨è‡ªåŠ¨é©¾é©¶ä¸­ï¼Œå¯ä»¥å¢å¼ºè½¦è¾†åœ¨æ¶åŠ£å¤©æ°”ä¸‹çš„æ„ŸçŸ¥èƒ½åŠ›ï¼Œæé«˜é©¾é©¶å®‰å…¨æ€§ã€‚åœ¨é¥æ„Ÿå›¾åƒå¤„ç†ä¸­ï¼Œå¯ä»¥å»é™¤å¤§æ°”é›¾éœ¾çš„å½±å“ï¼Œæé«˜å›¾åƒè§£è¯‘çš„ç²¾åº¦ã€‚è¯¥ç ”ç©¶çš„æˆæœæœ‰åŠ©äºæ¨åŠ¨ç›¸å…³é¢†åŸŸçš„å‘å±•ï¼Œå¹¶å¸¦æ¥æ˜¾è‘—çš„ç¤¾ä¼šå’Œç»æµæ•ˆç›Šã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Ultra-High-Definition (UHD) image dehazing faces challenges such as limited scene adaptability in prior-based methods and high computational complexity with color distortion in deep learning approaches. To address these issues, we propose 4KDehazeFlow, a novel method based on Flow Matching and the Haze-Aware vector field. This method models the dehazing process as a progressive optimization of continuous vector field flow, providing efficient data-driven adaptive nonlinear color transformation for high-quality dehazing. Specifically, our method has the following advantages: 1) 4KDehazeFlow is a general method compatible with various deep learning networks, without relying on any specific network architecture. 2) We propose a learnable 3D lookup table (LUT) that encodes haze transformation parameters into a compact 3D mapping matrix, enabling efficient inference through precomputed mappings. 3) We utilize a fourth-order Runge-Kutta (RK4) ordinary differential equation (ODE) solver to stably solve the dehazing flow field through an accurate step-by-step iterative method, effectively suppressing artifacts. Extensive experiments show that 4KDehazeFlow exceeds seven state-of-the-art methods. It delivers a 2dB PSNR increase and better performance in dense haze and color fidelity.

