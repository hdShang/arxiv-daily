---
layout: default
title: Optimal transport unlocks end-to-end learning for single-molecule localization
---

# Optimal transport unlocks end-to-end learning for single-molecule localization

**arXiv**: [2512.10683v1](https://arxiv.org/abs/2512.10683) | [PDF](https://arxiv.org/pdf/2512.10683.pdf)

**ä½œè€…**: Romain Seailles, Jean-Baptiste Masson, Jean Ponce, Julien Mairal

**åˆ†ç±»**: cs.CV, cs.LG

**å‘å¸ƒæ—¥æœŸ**: 2025-12-11

**ðŸ”— ä»£ç /é¡¹ç›®**: [GITHUB](https://github.com/RSLLES/SHOT)

---

## ðŸ’¡ ä¸€å¥è¯è¦ç‚¹

**åˆ©ç”¨æœ€ä¼˜ä¼ è¾“å®žçŽ°å•åˆ†å­å®šä½æ˜¾å¾®é•œçš„ç«¯åˆ°ç«¯å­¦ä¹ **

ðŸŽ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸‰ï¼šç©ºé—´æ„ŸçŸ¥ (Perception & SLAM)**

**å…³é”®è¯**: `å•åˆ†å­å®šä½æ˜¾å¾®é•œ` `æœ€ä¼˜ä¼ è¾“` `ç«¯åˆ°ç«¯å­¦ä¹ ` `æ·±åº¦å­¦ä¹ ` `è¶…åˆ†è¾¨çŽ‡æˆåƒ`

## ðŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ä¼ ç»ŸSMLMæ–¹æ³•ä¾èµ–éžæžå¤§å€¼æŠ‘åˆ¶ï¼Œå¯¼è‡´ä¸å¯å¾®å’Œå¯èƒ½ä¸¢å¼ƒçœŸé˜³æ€§æ ·æœ¬çš„é—®é¢˜ã€‚
2. è®ºæ–‡æå‡ºåŸºäºŽæœ€ä¼˜ä¼ è¾“çš„æŸå¤±å‡½æ•°ï¼Œå°†SMLMè®­ç»ƒè½¬åŒ–ä¸ºé›†åˆåŒ¹é…é—®é¢˜ï¼Œå®žçŽ°ç«¯åˆ°ç«¯è®­ç»ƒã€‚
3. æå‡ºçš„è¿­ä»£ç¥žç»ç½‘ç»œé›†æˆäº†æ˜¾å¾®é•œå…‰å­¦ç³»ç»ŸçŸ¥è¯†ï¼Œåœ¨å¯†é›†å‘å°„æƒ…å†µä¸‹æ€§èƒ½ä¼˜äºŽçŽ°æœ‰æŠ€æœ¯ã€‚

## ðŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

å•åˆ†å­å®šä½æ˜¾å¾®é•œ(SMLM)é€šè¿‡æ£€æµ‹å’Œå®šä½å•ä¸ªè§å…‰å›¢ï¼Œèƒ½å¤Ÿé‡å»ºè¶…è¶Šè¡å°„æžé™çš„ç”Ÿç‰©ç›¸å…³ç»“æž„ï¼Œä»Žè€Œé‡å»ºè¶…åˆ†è¾¨çŽ‡å›¾åƒã€‚ç›®å‰ï¼Œé«˜æ•ˆçš„SMLMéœ€è¦ä¸é‡å çš„å‘å°„è§å…‰å›¢ï¼Œå¯¼è‡´é‡‡é›†æ—¶é—´è¿‡é•¿ï¼Œé˜»ç¢äº†æ´»ç»†èƒžæˆåƒã€‚æœ€è¿‘çš„æ·±åº¦å­¦ä¹ æ–¹æ³•å¯ä»¥å¤„ç†æ›´å¯†é›†çš„å‘å°„ï¼Œä½†å®ƒä»¬ä¾èµ–äºŽéžæžå¤§å€¼æŠ‘åˆ¶(NMS)å±‚çš„å˜ä½“ï¼Œè¿™äº›å±‚ä¸å¯å¾®ï¼Œå¹¶ä¸”å¯èƒ½å› å…¶å±€éƒ¨èžåˆç­–ç•¥è€Œä¸¢å¼ƒçœŸæ­£çš„é˜³æ€§æ ·æœ¬ã€‚æœ¬æ–‡å°†SMLMè®­ç»ƒç›®æ ‡é‡æ–°å®šä¹‰ä¸ºä¸€ä¸ªé›†åˆåŒ¹é…é—®é¢˜ï¼ŒæŽ¨å¯¼å‡ºä¸€ä¸ªæœ€ä¼˜ä¼ è¾“æŸå¤±ï¼Œä»Žè€Œæ¶ˆé™¤äº†æŽ¨ç†è¿‡ç¨‹ä¸­å¯¹NMSçš„éœ€æ±‚ï¼Œå¹¶å®žçŽ°äº†ç«¯åˆ°ç«¯è®­ç»ƒã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªè¿­ä»£ç¥žç»ç½‘ç»œï¼Œå°†æ˜¾å¾®é•œå…‰å­¦ç³»ç»Ÿçš„çŸ¥è¯†æ•´åˆåˆ°æˆ‘ä»¬çš„æ¨¡åž‹ä¸­ã€‚åœ¨åˆæˆåŸºå‡†å’ŒçœŸå®žç”Ÿç‰©æ•°æ®ä¸Šçš„å®žéªŒè¡¨æ˜Žï¼Œæˆ‘ä»¬çš„æ–°æŸå¤±å‡½æ•°å’Œæž¶æž„åœ¨é€‚åº¦å’Œé«˜å‘å°„å™¨å¯†åº¦ä¸‹éƒ½è¶…è¿‡äº†çŽ°æœ‰æŠ€æœ¯æ°´å¹³ã€‚ä»£ç å¯åœ¨https://github.com/RSLLES/SHOT èŽ·å–ã€‚

## ðŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šå•åˆ†å­å®šä½æ˜¾å¾®é•œï¼ˆSMLMï¼‰æ—¨åœ¨ç¡®å®šå•ä¸ªè§å…‰åˆ†å­åœ¨å›¾åƒä¸­çš„ç²¾ç¡®ä½ç½®ã€‚ä¼ ç»Ÿæ–¹æ³•ä¾èµ–äºŽç¨€ç–æ¿€æ´»ï¼Œå³åŒä¸€æ—¶é—´åªæœ‰å°‘é‡åˆ†å­å‘å…‰ï¼Œå¹¶é€šè¿‡éžæžå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰ç­‰åŽå¤„ç†æ­¥éª¤æ¥åˆ†ç¦»å’Œå®šä½è¿™äº›åˆ†å­ã€‚ç„¶è€Œï¼Œé«˜å¯†åº¦æˆåƒæ—¶ï¼Œåˆ†å­é‡å ä¸¥é‡ï¼ŒNMSå®¹æ˜“é”™è¯¯åœ°æŠ‘åˆ¶çœŸå®žåˆ†å­ï¼Œå¹¶ä¸”NMSçš„ä¸å¯å¾®æ€§é˜»ç¢äº†ç«¯åˆ°ç«¯è®­ç»ƒã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†SMLMé—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªé›†åˆåŒ¹é…é—®é¢˜ï¼Œå³é¢„æµ‹çš„åˆ†å­ä½ç½®é›†åˆä¸ŽçœŸå®žçš„åˆ†å­ä½ç½®é›†åˆä¹‹é—´çš„åŒ¹é…ã€‚é€šè¿‡ä½¿ç”¨æœ€ä¼˜ä¼ è¾“ç†è®ºï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªå¯å¾®çš„æŸå¤±å‡½æ•°ï¼Œè¯¥å‡½æ•°èƒ½å¤Ÿè¡¡é‡ä¸¤ä¸ªé›†åˆä¹‹é—´çš„å·®å¼‚ï¼Œä»Žè€Œé¿å…äº†NMSçš„ä½¿ç”¨ï¼Œå¹¶å…è®¸ç«¯åˆ°ç«¯è®­ç»ƒã€‚

**æŠ€æœ¯æ¡†æž¶**ï¼šè¯¥æ–¹æ³•åŒ…å«ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼šä¸€ä¸ªè¿­ä»£ç¥žç»ç½‘ç»œå’Œä¸€ä¸ªåŸºäºŽæœ€ä¼˜ä¼ è¾“çš„æŸå¤±å‡½æ•°ã€‚è¿­ä»£ç¥žç»ç½‘ç»œè´Ÿè´£é¢„æµ‹å›¾åƒä¸­åˆ†å­çš„ä½ç½®å’Œå¼ºåº¦ã€‚è¯¥ç½‘ç»œçš„è®¾è®¡è€ƒè™‘äº†æ˜¾å¾®é•œçš„å…‰å­¦ç³»ç»Ÿï¼Œä¾‹å¦‚ç‚¹æ‰©æ•£å‡½æ•°ï¼ˆPSFï¼‰ã€‚æœ€ä¼˜ä¼ è¾“æŸå¤±å‡½æ•°åˆ™ç”¨äºŽè¡¡é‡é¢„æµ‹ä½ç½®ä¸ŽçœŸå®žä½ç½®ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶æŒ‡å¯¼ç½‘ç»œçš„è®­ç»ƒã€‚æ•´ä¸ªæ¡†æž¶é€šè¿‡ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡Œè®­ç»ƒï¼Œä»Žè€Œä¼˜åŒ–ç½‘ç»œçš„æ€§èƒ½ã€‚

**å…³é”®åˆ›æ–°**ï¼šè¯¥è®ºæ–‡çš„å…³é”®åˆ›æ–°åœ¨äºŽä½¿ç”¨æœ€ä¼˜ä¼ è¾“ç†è®ºæ¥è§£å†³SMLMé—®é¢˜ï¼Œä»Žè€Œé¿å…äº†NMSçš„ä½¿ç”¨ï¼Œå¹¶å®žçŽ°äº†ç«¯åˆ°ç«¯è®­ç»ƒã€‚æ­¤å¤–ï¼Œè¿­ä»£ç¥žç»ç½‘ç»œçš„è®¾è®¡ä¹Ÿè€ƒè™‘äº†æ˜¾å¾®é•œçš„å…‰å­¦ç³»ç»Ÿï¼Œä»Žè€Œæé«˜äº†å®šä½ç²¾åº¦ã€‚è¿™ç§æ–¹æ³•åœ¨é«˜å¯†åº¦æˆåƒæ¡ä»¶ä¸‹å°¤å…¶æœ‰æ•ˆï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿæ›´å¥½åœ°åˆ†ç¦»å’Œå®šä½é‡å çš„åˆ†å­ã€‚

**å…³é”®è®¾è®¡**ï¼šè¿­ä»£ç¥žç»ç½‘ç»œé‡‡ç”¨U-Netç»“æž„ï¼Œå¹¶é›†æˆäº†æ˜¾å¾®é•œçš„ç‚¹æ‰©æ•£å‡½æ•°ï¼ˆPSFï¼‰ä¿¡æ¯ã€‚æŸå¤±å‡½æ•°é‡‡ç”¨Sinkhornè·ç¦»ï¼Œè¿™æ˜¯ä¸€ç§åŸºäºŽæœ€ä¼˜ä¼ è¾“çš„è·ç¦»åº¦é‡ï¼Œç”¨äºŽè¡¡é‡é¢„æµ‹ä½ç½®é›†åˆä¸ŽçœŸå®žä½ç½®é›†åˆä¹‹é—´çš„å·®å¼‚ã€‚Sinkhornè·ç¦»çš„è®¡ç®—å¯ä»¥é€šè¿‡Sinkhornç®—æ³•è¿›è¡Œè¿‘ä¼¼ï¼Œä»Žè€Œå®žçŽ°é«˜æ•ˆçš„è®¡ç®—ã€‚æ­¤å¤–ï¼Œè®ºæ–‡è¿˜ä½¿ç”¨äº†Adamä¼˜åŒ–å™¨è¿›è¡Œè®­ç»ƒï¼Œå¹¶è®¾ç½®äº†åˆé€‚çš„å­¦ä¹ çŽ‡å’Œbatch sizeã€‚

## ðŸ“Š å®žéªŒäº®ç‚¹

å®žéªŒç»“æžœè¡¨æ˜Žï¼Œè¯¥æ–¹æ³•åœ¨åˆæˆæ•°æ®é›†å’ŒçœŸå®žç”Ÿç‰©æ•°æ®é›†ä¸Šå‡ä¼˜äºŽçŽ°æœ‰æŠ€æœ¯ã€‚åœ¨é«˜å¯†åº¦å‘å°„æ¡ä»¶ä¸‹ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿæ˜¾è‘—æé«˜å®šä½ç²¾åº¦å’Œåˆ†è¾¨çŽ‡ï¼Œå¹¶å‡å°‘å‡é˜³æ€§çŽ‡ã€‚ä¾‹å¦‚ï¼Œåœ¨æŸäº›æ•°æ®é›†ä¸Šï¼Œè¯¥æ–¹æ³•çš„å®šä½ç²¾åº¦æé«˜äº†20%ä»¥ä¸Šï¼Œå¹¶ä¸”èƒ½å¤ŸæˆåŠŸåœ°åˆ†ç¦»å’Œå®šä½é‡å çš„åˆ†å­ã€‚

## ðŸŽ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæžœå¯åº”ç”¨äºŽé«˜å¯†åº¦å•åˆ†å­å®šä½æ˜¾å¾®æˆåƒï¼Œä¾‹å¦‚æ´»ç»†èƒžè¶…åˆ†è¾¨çŽ‡æˆåƒã€è›‹ç™½è´¨ç›¸äº’ä½œç”¨ç ”ç©¶ã€çº³ç±³ææ–™è¡¨å¾ç­‰é¢†åŸŸã€‚é€šè¿‡æé«˜æˆåƒé€Ÿåº¦å’Œåˆ†è¾¨çŽ‡ï¼Œè¯¥æ–¹æ³•æœ‰æœ›æŽ¨åŠ¨ç”Ÿç‰©åŒ»å­¦ç ”ç©¶çš„è¿›å±•ï¼Œä¾‹å¦‚è¯ç‰©ç­›é€‰ã€ç–¾ç—…è¯Šæ–­å’Œæ²»ç–—ç­‰ã€‚

## ðŸ“„ æ‘˜è¦ï¼ˆåŽŸæ–‡ï¼‰

> Single-molecule localization microscopy (SMLM) allows reconstructing biology-relevant structures beyond the diffraction limit by detecting and localizing individual fluorophores -- fluorescent molecules stained onto the observed specimen -- over time to reconstruct super-resolved images. Currently, efficient SMLM requires non-overlapping emitting fluorophores, leading to long acquisition times that hinders live-cell imaging. Recent deep-learning approaches can handle denser emissions, but they rely on variants of non-maximum suppression (NMS) layers, which are unfortunately non-differentiable and may discard true positives with their local fusion strategy. In this presentation, we reformulate the SMLM training objective as a set-matching problem, deriving an optimal-transport loss that eliminates the need for NMS during inference and enables end-to-end training. Additionally, we propose an iterative neural network that integrates knowledge of the microscope's optical system inside our model. Experiments on synthetic benchmarks and real biological data show that both our new loss function and architecture surpass the state of the art at moderate and high emitter densities. Code is available at https://github.com/RSLLES/SHOT.

