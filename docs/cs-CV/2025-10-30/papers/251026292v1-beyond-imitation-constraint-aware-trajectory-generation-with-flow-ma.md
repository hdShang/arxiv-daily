---
layout: default
title: Beyond Imitation: Constraint-Aware Trajectory Generation with Flow Matching For End-to-End Autonomous Driving
---

# Beyond Imitation: Constraint-Aware Trajectory Generation with Flow Matching For End-to-End Autonomous Driving

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2510.26292" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2510.26292v1</a>
  <a href="https://arxiv.org/pdf/2510.26292.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2510.26292v1" onclick="toggleFavorite(this, '2510.26292v1', 'Beyond Imitation: Constraint-Aware Trajectory Generation with Flow Matching For End-to-End Autonomous Driving')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Lin Liu, Guanyi Yu, Ziying Song, Junqiao Li, Caiyan Jia, Feiyang Jia, Peiliang Wu, Yandan Luo

**åˆ†ç±»**: cs.CV

**å‘å¸ƒæ—¥æœŸ**: 2025-10-30

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºCATGï¼Œåˆ©ç”¨çº¦æŸæµåŒ¹é…è¿›è¡Œç«¯åˆ°ç«¯è‡ªåŠ¨é©¾é©¶è½¨è¿¹ç”Ÿæˆï¼Œè§£å†³æ¨¡ä»¿å­¦ä¹ æ¨¡å¼å´©å¡Œé—®é¢˜ã€‚**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±ä¸€ï¼šæœºå™¨äººæ§åˆ¶ (Robot Control)** **æ”¯æŸ±äºŒï¼šRLç®—æ³•ä¸æ¶æ„ (RL & Architecture)**

**å…³é”®è¯**: `è‡ªåŠ¨é©¾é©¶` `è½¨è¿¹è§„åˆ’` `æµåŒ¹é…` `çº¦æŸä¼˜åŒ–` `æ¨¡ä»¿å­¦ä¹ ` `ç”Ÿæˆæ¨¡å‹` `è¿åŠ¨è§„åˆ’`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. æ¨¡ä»¿å­¦ä¹ åœ¨è‡ªåŠ¨é©¾é©¶è§„åˆ’ä¸­æ˜“å‡ºç°æ¨¡å¼å´©å¡Œï¼Œå¯¼è‡´è½¨è¿¹å¤šæ ·æ€§ä¸è¶³ï¼Œç”Ÿæˆæ–¹æ³•éš¾ä»¥ç›´æ¥èå…¥å®‰å…¨çº¦æŸã€‚
2. CATGåˆ©ç”¨çº¦æŸæµåŒ¹é…ï¼Œæ˜¾å¼å»ºæ¨¡æµåŒ¹é…è¿‡ç¨‹ï¼Œç›´æ¥åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­æ–½åŠ å®‰å…¨å’Œè¿åŠ¨å­¦çº¦æŸã€‚
3. CATGåœ¨NavSim v2æŒ‘æˆ˜èµ›ä¸­è·å¾—ç¬¬äºŒåï¼ŒEPDMSå¾—åˆ†ä¸º51.31ï¼Œå¹¶è£è·åˆ›æ–°å¥–ï¼ŒéªŒè¯äº†æœ‰æ•ˆæ€§ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§åä¸ºCATGçš„æ–°å‹è§„åˆ’æ¡†æ¶ï¼Œè¯¥æ¡†æ¶åˆ©ç”¨çº¦æŸæµåŒ¹é…æ¥è§£å†³ç«¯åˆ°ç«¯è‡ªåŠ¨é©¾é©¶ä¸­çš„è§„åˆ’é—®é¢˜ã€‚ç°æœ‰çš„æ¨¡ä»¿å­¦ä¹ æ–¹æ³•å®¹æ˜“å‡ºç°æ¨¡å¼å´©å¡Œï¼Œæ— æ³•ç”Ÿæˆå¤šæ ·åŒ–çš„è½¨è¿¹å‡è®¾ã€‚åŒæ—¶ï¼Œç°æœ‰çš„ç”Ÿæˆæ–¹æ³•éš¾ä»¥å°†å…³é”®çš„å®‰å…¨å’Œç‰©ç†çº¦æŸç›´æ¥èå…¥ç”Ÿæˆè¿‡ç¨‹ï¼Œéœ€è¦é¢å¤–çš„ä¼˜åŒ–é˜¶æ®µæ¥æ”¹è¿›è¾“å‡ºã€‚CATGæ˜¾å¼åœ°å»ºæ¨¡äº†æµåŒ¹é…è¿‡ç¨‹ï¼Œä»è€Œå‡è½»äº†æ¨¡å¼å´©å¡Œï¼Œå¹¶å…è®¸æ¥è‡ªå„ç§æ¡ä»¶ä¿¡å·çš„çµæ´»æŒ‡å¯¼ã€‚ä¸»è¦è´¡çŒ®åœ¨äºå°†æ˜¾å¼çº¦æŸç›´æ¥æ–½åŠ äºæµåŒ¹é…è¿‡ç¨‹ä¸­ï¼Œç¡®ä¿ç”Ÿæˆçš„è½¨è¿¹ç¬¦åˆé‡è¦çš„å®‰å…¨å’Œè¿åŠ¨å­¦è§„åˆ™ã€‚æ­¤å¤–ï¼ŒCATGå°†é©¾é©¶æ¿€è¿›ç¨‹åº¦å‚æ•°åŒ–ä¸ºç”Ÿæˆè¿‡ç¨‹ä¸­çš„æ§åˆ¶ä¿¡å·ï¼Œä»è€Œèƒ½å¤Ÿç²¾ç¡®åœ°æ§åˆ¶è½¨è¿¹é£æ ¼ã€‚åœ¨NavSim v2æŒ‘æˆ˜èµ›ä¸­ï¼ŒCATGè·å¾—äº†ç¬¬äºŒåï¼ŒEPDMSå¾—åˆ†ä¸º51.31ï¼Œå¹¶è£è·åˆ›æ–°å¥–ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šç«¯åˆ°ç«¯è‡ªåŠ¨é©¾é©¶ä¸­çš„è½¨è¿¹è§„åˆ’ä»»åŠ¡ï¼Œç›®æ ‡æ˜¯ç”Ÿæˆå®‰å…¨ã€å¯è¡Œä¸”ç¬¦åˆé©¾é©¶é£æ ¼çš„è½¨è¿¹ã€‚ç°æœ‰æ¨¡ä»¿å­¦ä¹ æ–¹æ³•å®¹æ˜“é™·å…¥æ¨¡å¼å´©å¡Œï¼Œå¯¼è‡´ç”Ÿæˆè½¨è¿¹çš„å¤šæ ·æ€§ä¸è¶³ï¼Œéš¾ä»¥åº”å¯¹å¤æ‚åœºæ™¯ã€‚è€Œç°æœ‰çš„ç”Ÿæˆå¼æ–¹æ³•é€šå¸¸éš¾ä»¥ç›´æ¥å°†å®‰å…¨å’Œç‰©ç†çº¦æŸèå…¥åˆ°ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œéœ€è¦é¢å¤–çš„ä¼˜åŒ–æ­¥éª¤æ¥ä¿è¯è½¨è¿¹çš„å®‰å…¨æ€§ï¼Œå¢åŠ äº†è®¡ç®—è´Ÿæ‹…å’Œå¤æ‚æ€§ã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šæœ¬æ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨çº¦æŸæµåŒ¹é…ï¼ˆConstrained Flow Matchingï¼‰æ¥ç”Ÿæˆè½¨è¿¹ã€‚æµåŒ¹é…æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆç¼“è§£æ¨¡å¼å´©å¡Œé—®é¢˜ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡æ¡ä»¶ä¿¡å·æ¥å¼•å¯¼è½¨è¿¹çš„ç”Ÿæˆã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæœ¬æ–‡åˆ›æ–°æ€§åœ°å°†çº¦æŸç›´æ¥åµŒå…¥åˆ°æµåŒ¹é…è¿‡ç¨‹ä¸­ï¼Œä½¿å¾—ç”Ÿæˆçš„è½¨è¿¹åœ¨æ»¡è¶³å¤šæ ·æ€§çš„åŒæ—¶ï¼Œèƒ½å¤Ÿå¤©ç„¶åœ°æ»¡è¶³å®‰å…¨å’Œè¿åŠ¨å­¦çº¦æŸï¼Œé¿å…äº†åå¤„ç†ä¼˜åŒ–æ­¥éª¤ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šCATGæ¡†æ¶ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼šé¦–å…ˆï¼Œä½¿ç”¨ç¥ç»ç½‘ç»œå­¦ä¹ ä¸€ä¸ªæ¡ä»¶å‘é‡åœºï¼Œè¯¥å‘é‡åœºå®šä¹‰äº†ä»å™ªå£°åˆ†å¸ƒåˆ°ç›®æ ‡è½¨è¿¹çš„è¿ç»­å˜æ¢ã€‚å…¶æ¬¡ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡å¼•å…¥çº¦æŸæŸå¤±å‡½æ•°ï¼Œå¼ºåˆ¶å‘é‡åœºç”Ÿæˆçš„è½¨è¿¹æ»¡è¶³å®‰å…¨å’Œè¿åŠ¨å­¦çº¦æŸã€‚æœ€åï¼Œåœ¨æ¨ç†é˜¶æ®µï¼Œé€šè¿‡é‡‡æ ·å™ªå£°å¹¶æ²¿ç€å‘é‡åœºè¿›è¡Œç§¯åˆ†ï¼Œç”Ÿæˆæ»¡è¶³çº¦æŸçš„è½¨è¿¹ã€‚é©¾é©¶æ¿€è¿›ç¨‹åº¦è¢«å‚æ•°åŒ–ä¸ºä¸€ä¸ªæ§åˆ¶ä¿¡å·ï¼Œç”¨äºè°ƒæ•´ç”Ÿæˆçš„è½¨è¿¹é£æ ¼ã€‚

**å…³é”®åˆ›æ–°**ï¼šæœ€é‡è¦çš„åˆ›æ–°ç‚¹åœ¨äºå°†æ˜¾å¼çº¦æŸç›´æ¥åµŒå…¥åˆ°æµåŒ¹é…è¿‡ç¨‹ä¸­ã€‚ä¼ ç»Ÿçš„ç”Ÿæˆå¼æ–¹æ³•é€šå¸¸å…ˆç”Ÿæˆè½¨è¿¹ï¼Œç„¶åå†é€šè¿‡ä¼˜åŒ–æ¥æ»¡è¶³çº¦æŸï¼Œè€ŒCATGåˆ™åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­å°±ä¿è¯äº†è½¨è¿¹çš„å®‰å…¨æ€§ã€‚è¿™ç§æ–¹æ³•ä¸ä»…æé«˜äº†æ•ˆç‡ï¼Œä¹Ÿä½¿å¾—ç”Ÿæˆçš„è½¨è¿¹æ›´åŠ è‡ªç„¶å’Œå¯è¡Œã€‚

**å…³é”®è®¾è®¡**ï¼šCATGçš„å…³é”®è®¾è®¡åŒ…æ‹¬ï¼š1) ä½¿ç”¨ç¥ç»ç½‘ç»œæ¥å‚æ•°åŒ–æ¡ä»¶å‘é‡åœºï¼Œè¯¥ç½‘ç»œä»¥ç¯å¢ƒä¿¡æ¯å’Œé©¾é©¶é£æ ¼ä½œä¸ºè¾“å…¥ï¼›2) è®¾è®¡äº†ä¸“é—¨çš„çº¦æŸæŸå¤±å‡½æ•°ï¼Œç”¨äºå¼ºåˆ¶ç”Ÿæˆçš„è½¨è¿¹æ»¡è¶³å®‰å…¨è·ç¦»ã€é€Ÿåº¦é™åˆ¶å’ŒåŠ é€Ÿåº¦é™åˆ¶ç­‰çº¦æŸï¼›3) ä½¿ç”¨äº†æ•°å€¼ç§¯åˆ†æ–¹æ³•ï¼ˆå¦‚æ¬§æ‹‰æ–¹æ³•æˆ–é¾™æ ¼-åº“å¡”æ–¹æ³•ï¼‰æ¥æ²¿ç€å‘é‡åœºè¿›è¡Œç§¯åˆ†ï¼Œç”Ÿæˆæœ€ç»ˆçš„è½¨è¿¹ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

CATGåœ¨NavSim v2æŒ‘æˆ˜èµ›ä¸­å–å¾—äº†æ˜¾è‘—æˆæœï¼Œè·å¾—äº†ç¬¬äºŒåï¼ŒEPDMSå¾—åˆ†ä¸º51.31ï¼Œå¹¶è£è·åˆ›æ–°å¥–ã€‚è¿™ä¸€ç»“æœè¡¨æ˜ï¼ŒCATGåœ¨å¤æ‚é©¾é©¶åœºæ™¯ä¸‹å…·æœ‰å¼ºå¤§çš„è½¨è¿¹ç”Ÿæˆèƒ½åŠ›å’Œå®‰å…¨æ€§ã€‚ç›¸è¾ƒäºä¼ ç»Ÿçš„æ¨¡ä»¿å­¦ä¹ æ–¹æ³•ï¼ŒCATGèƒ½å¤Ÿç”Ÿæˆæ›´åŠ å¤šæ ·åŒ–çš„è½¨è¿¹ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ›´å¥½åœ°æ»¡è¶³å®‰å…¨çº¦æŸã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

CATGå¯åº”ç”¨äºå„ç§è‡ªåŠ¨é©¾é©¶åœºæ™¯ï¼Œä¾‹å¦‚åŸå¸‚é“è·¯ã€é«˜é€Ÿå…¬è·¯å’Œè¶Šé‡ç¯å¢ƒã€‚è¯¥æ–¹æ³•èƒ½å¤Ÿç”Ÿæˆå®‰å…¨ã€å¤šæ ·ä¸”ç¬¦åˆé©¾é©¶é£æ ¼çš„è½¨è¿¹ï¼Œæé«˜è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿçš„å¯é æ€§å’Œé€‚åº”æ€§ã€‚æ­¤å¤–ï¼ŒCATGè¿˜å¯ä»¥åº”ç”¨äºæœºå™¨äººå¯¼èˆªã€æ¸¸æˆAIç­‰é¢†åŸŸï¼Œä¸ºè¿™äº›é¢†åŸŸæä¾›æ›´æ™ºèƒ½ã€æ›´å®‰å…¨çš„è¿åŠ¨è§„åˆ’èƒ½åŠ›ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> Planning is a critical component of end-to-end autonomous driving. However, prevailing imitation learning methods often suffer from mode collapse, failing to produce diverse trajectory hypotheses. Meanwhile, existing generative approaches struggle to incorporate crucial safety and physical constraints directly into the generative process, necessitating an additional optimization stage to refine their outputs. To address these limitations, we propose CATG, a novel planning framework that leverages Constrained Flow Matching. Concretely, CATG explicitly models the flow matching process, which inherently mitigates mode collapse and allows for flexible guidance from various conditioning signals. Our primary contribution is the novel imposition of explicit constraints directly within the flow matching process, ensuring that the generated trajectories adhere to vital safety and kinematic rules. Secondly, CATG parameterizes driving aggressiveness as a control signal during generation, enabling precise manipulation of trajectory style. Notably, on the NavSim v2 challenge, CATG achieved 2nd place with an EPDMS score of 51.31 and was honored with the Innovation Award.

