---
layout: default
title: An Adjoint Method for Differentiable Fluid Simulation on Flow Maps
---

# An Adjoint Method for Differentiable Fluid Simulation on Flow Maps

<div class="paper-toolbar">
  <a href="https://arxiv.org/abs/2511.01259" class="toolbar-btn" target="_blank">ğŸ“„ arXiv: 2511.01259v1</a>
  <a href="https://arxiv.org/pdf/2511.01259.pdf" class="toolbar-btn" target="_blank">ğŸ“¥ PDF</a>
  <button class="toolbar-btn favorite-btn" data-arxiv-id="2511.01259v1" onclick="toggleFavorite(this, '2511.01259v1', 'An Adjoint Method for Differentiable Fluid Simulation on Flow Maps')" title="æ·»åŠ åˆ°æ”¶è—å¤¹">â˜† æ”¶è—</button>
  <button class="toolbar-btn" onclick="copyLinkToClipboard(this)">ğŸ”— åˆ†äº«</button>
</div>


**ä½œè€…**: Zhiqi Li, Jinjin He, BarnabÃ¡s BÃ¶rcsÃ¶k, Taiyuan Zhang, Duowen Chen, Tao Du, Ming C. Lin, Greg Turk, Bo Zhu

**åˆ†ç±»**: cs.GR, physics.flu-dyn

**å‘å¸ƒæ—¥æœŸ**: 2025-11-03

**å¤‡æ³¨**: 15 pages, 16 figures

**æœŸåˆŠ**: ACM SIGGRAPH Asia Conference Proceedings (2025)

**DOI**: [10.1145/3757377.3763903](https://doi.org/10.1145/3757377.3763903)

---

## ğŸ’¡ ä¸€å¥è¯è¦ç‚¹

**æå‡ºåŸºäºæµæ˜ å°„çš„å¯å¾®æµä½“æ¨¡æ‹Ÿä¼´éšæ–¹æ³•ï¼Œå®ç°ç²¾ç¡®æ¶¡æ—‹åŠ¨åŠ›å­¦æ§åˆ¶**

ğŸ¯ **åŒ¹é…é¢†åŸŸ**: **æ”¯æŸ±å…«ï¼šç‰©ç†åŠ¨ç”» (Physics-based Animation)**

**å…³é”®è¯**: `å¯å¾®æµä½“æ¨¡æ‹Ÿ` `ä¼´éšæ–¹æ³•` `æµæ˜ å°„` `æ¶¡æ—‹åŠ¨åŠ›å­¦` `æ¢¯åº¦è®¡ç®—`

## ğŸ“‹ æ ¸å¿ƒè¦ç‚¹

1. ä¼ ç»Ÿä¼´éšæ–¹æ³•åœ¨å¯å¾®æµä½“æ¨¡æ‹Ÿä¸­éœ€è¦å­˜å‚¨å¤§é‡ä¸­é—´å˜é‡æˆ–å¾®åˆ†æ•°å€¼æ­¥éª¤ï¼Œå¯¼è‡´è®¡ç®—æˆæœ¬é«˜æ˜‚ã€‚
2. è®ºæ–‡æå‡ºåˆ©ç”¨æ­£å‘æ¨¡æ‹Ÿä¸­çš„æµæ˜ å°„ï¼Œåœ¨åå‘ä¼ æ’­ä¸­ç›´æ¥æ±‚è§£ä¼´éšæ–¹ç¨‹ï¼Œé¿å…äº†å¯¹ä¸­é—´æ­¥éª¤çš„å¾®åˆ†å’Œå­˜å‚¨ã€‚
3. å®éªŒè¡¨æ˜ï¼Œè¯¥æ–¹æ³•åœ¨ä½å†…å­˜å ç”¨ä¸‹ï¼Œèƒ½å¤Ÿç²¾ç¡®è·Ÿè¸ªæ¶¡é‡ï¼Œå¹¶æ”¯æŒéœ€è¦ç²¾ç¡®æ§åˆ¶æ¶¡æ—‹åŠ¨åŠ›å­¦çš„å¯å¾®æ¨¡æ‹Ÿä»»åŠ¡ã€‚

## ğŸ“ æ‘˜è¦ï¼ˆä¸­æ–‡ï¼‰

æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°é¢–çš„ä¼´éšæ±‚è§£å™¨ï¼Œç”¨äºåŸºäºåŒå‘æµæ˜ å°„çš„å¯å¾®æµä½“æ¨¡æ‹Ÿã€‚æ ¸å¿ƒæ€æƒ³æ˜¯æ­£å‘æµä½“æ±‚è§£å™¨åŠå…¶å¯¹åº”çš„åå‘ä¼´éšæ±‚è§£å™¨å…±äº«ç›¸åŒçš„æµæ˜ å°„ï¼Œæ­£å‘è¿‡ç¨‹åˆ©ç”¨è¯¥æ˜ å°„å°†æµä½“è„‰å†²å˜é‡ä»åˆå§‹å¸§ä¼ è¾“åˆ°å½“å‰å¸§ï¼Œä»¥æ¨¡æ‹Ÿæ¶¡æ—‹åŠ¨åŠ›å­¦ã€‚åå‘è¿‡ç¨‹åˆ™åˆ©ç”¨ç›¸åŒçš„æ˜ å°„å°†ä¼´éšå˜é‡ä»å½“å‰å¸§ä¼ æ’­å›åˆå§‹å¸§ï¼Œä»¥è®¡ç®—æ¢¯åº¦ã€‚è¿™ç§å…±äº«çš„é•¿ç¨‹æ˜ å°„ä½¿å¾—æ¢¯åº¦è®¡ç®—çš„ç²¾åº¦èƒ½å¤Ÿç›´æ¥å—ç›Šäºæµæ˜ å°„æ„å»ºçš„æ”¹è¿›ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§æ–°çš„ä¼´éšæ±‚è§£å™¨ï¼Œå®ƒç›´æ¥åœ¨æµæ˜ å°„ä¸Šæ±‚è§£ä¼´éšæ–¹ç¨‹ï¼Œä»è€Œå®ç°å¯¹ä¸å¯å‹ç¼©æµçš„é•¿ç¨‹å’Œç²¾ç¡®å¾®åˆ†ï¼Œè€Œæ— éœ€åƒä¼ ç»Ÿä¼´éšæ–¹æ³•é‚£æ ·å¾®åˆ†ä¸­é—´æ•°å€¼æ­¥éª¤æˆ–å­˜å‚¨ä¸­é—´å˜é‡ã€‚ä¸ºäº†è¿›ä¸€æ­¥æé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§é•¿çŸ­æ—¶ç¨€ç–æµæ˜ å°„è¡¨ç¤ºï¼Œç”¨äºæ¼”åŒ–ä¼´éšå˜é‡ã€‚æˆ‘ä»¬çš„æ–¹æ³•å…·æœ‰ä½å†…å­˜å ç”¨ï¼Œåœ¨$192^3$åˆ†è¾¨ç‡ä¸‹ä»…éœ€6.53GBæ•°æ®ï¼ŒåŒæ—¶ä¿æŒäº†è·Ÿè¸ªæ¶¡é‡çš„ç²¾åº¦ï¼Œä»è€Œå®ç°äº†éœ€è¦ç²¾ç¡®è¯†åˆ«ã€é¢„æµ‹å’Œæ§åˆ¶æ¶¡æ—‹åŠ¨åŠ›å­¦çš„æ–°å‹å¯å¾®æ¨¡æ‹Ÿä»»åŠ¡ã€‚

## ğŸ”¬ æ–¹æ³•è¯¦è§£

**é—®é¢˜å®šä¹‰**ï¼šå¯å¾®æµä½“æ¨¡æ‹Ÿæ—¨åœ¨è®¡ç®—æµä½“æ¨¡æ‹Ÿè¿‡ç¨‹å¯¹å‚æ•°çš„æ¢¯åº¦ï¼Œä»¥ä¾¿è¿›è¡Œä¼˜åŒ–å’Œæ§åˆ¶ã€‚ä¼ ç»Ÿçš„ä¼´éšæ–¹æ³•éœ€è¦å­˜å‚¨å¤§é‡çš„ä¸­é—´å˜é‡æˆ–è€…å¯¹æ•°å€¼æ±‚è§£å™¨è¿›è¡Œå¾®åˆ†ï¼Œè¿™å¯¼è‡´äº†å·¨å¤§çš„å†…å­˜å¼€é”€å’Œè®¡ç®—å¤æ‚åº¦ï¼Œå°¤å…¶æ˜¯åœ¨é«˜åˆ†è¾¨ç‡çš„æ¨¡æ‹Ÿä¸­ã€‚ç°æœ‰çš„æ–¹æ³•éš¾ä»¥åœ¨ä¿è¯ç²¾åº¦çš„å‰æä¸‹ï¼Œæœ‰æ•ˆåœ°å¤„ç†å¤§è§„æ¨¡çš„æµä½“æ¨¡æ‹Ÿã€‚

**æ ¸å¿ƒæ€è·¯**ï¼šè®ºæ–‡çš„æ ¸å¿ƒæ€è·¯æ˜¯åˆ©ç”¨æµæ˜ å°„ï¼ˆFlow Mapï¼‰å°†æµä½“æ¨¡æ‹Ÿä¸­çš„æ­£å‘è¿‡ç¨‹å’Œåå‘ä¼´éšè¿‡ç¨‹è”ç³»èµ·æ¥ã€‚æ­£å‘æ¨¡æ‹Ÿä½¿ç”¨æµæ˜ å°„æ¥è¿½è¸ªæµä½“ç²’å­çš„è¿åŠ¨ï¼Œè€Œåå‘ä¼ æ’­åˆ™åˆ©ç”¨ç›¸åŒçš„æµæ˜ å°„æ¥ä¼ æ’­ä¼´éšå˜é‡ã€‚é€šè¿‡åœ¨æµæ˜ å°„ä¸Šç›´æ¥æ±‚è§£ä¼´éšæ–¹ç¨‹ï¼Œé¿å…äº†å¯¹ä¸­é—´æ•°å€¼æ­¥éª¤çš„å¾®åˆ†å’Œå­˜å‚¨ï¼Œä»è€Œæ˜¾è‘—é™ä½äº†å†…å­˜å ç”¨å’Œè®¡ç®—å¤æ‚åº¦ã€‚

**æŠ€æœ¯æ¡†æ¶**ï¼šè¯¥æ–¹æ³•ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š1) æ­£å‘æµä½“æ¨¡æ‹Ÿï¼šä½¿ç”¨æµæ˜ å°„æ¥æ¨¡æ‹Ÿæµä½“çš„è¿åŠ¨ï¼Œå¹¶è®°å½•æµæ˜ å°„çš„ä¿¡æ¯ã€‚2) ä¼´éšæ–¹ç¨‹æ±‚è§£ï¼šåœ¨æµæ˜ å°„ä¸Šç›´æ¥æ±‚è§£ä¼´éšæ–¹ç¨‹ï¼Œè®¡ç®—æ¢¯åº¦ã€‚3) æ¢¯åº¦åº”ç”¨ï¼šå°†è®¡ç®—å¾—åˆ°çš„æ¢¯åº¦ç”¨äºä¼˜åŒ–å’Œæ§åˆ¶æµä½“æ¨¡æ‹Ÿè¿‡ç¨‹ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè®ºæ–‡è¿˜æå‡ºäº†é•¿çŸ­æ—¶ç¨€ç–æµæ˜ å°„è¡¨ç¤ºã€‚

**å…³é”®åˆ›æ–°**ï¼šè¯¥æ–¹æ³•æœ€é‡è¦çš„æŠ€æœ¯åˆ›æ–°ç‚¹åœ¨äºåˆ©ç”¨æµæ˜ å°„å°†æ­£å‘æ¨¡æ‹Ÿå’Œåå‘ä¼´éšè¿‡ç¨‹è”ç³»èµ·æ¥ï¼Œå¹¶åœ¨æµæ˜ å°„ä¸Šç›´æ¥æ±‚è§£ä¼´éšæ–¹ç¨‹ã€‚ä¸ä¼ ç»Ÿçš„ä¼´éšæ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•ä¸éœ€è¦å­˜å‚¨ä¸­é—´å˜é‡æˆ–å¾®åˆ†æ•°å€¼æ­¥éª¤ï¼Œä»è€Œæ˜¾è‘—é™ä½äº†å†…å­˜å ç”¨å’Œè®¡ç®—å¤æ‚åº¦ã€‚æ­¤å¤–ï¼Œé•¿çŸ­æ—¶ç¨€ç–æµæ˜ å°„è¡¨ç¤ºè¿›ä¸€æ­¥æé«˜äº†è®¡ç®—æ•ˆç‡ã€‚

**å…³é”®è®¾è®¡**ï¼šè®ºæ–‡æå‡ºäº†é•¿çŸ­æ—¶ç¨€ç–æµæ˜ å°„è¡¨ç¤ºï¼Œç”¨äºé«˜æ•ˆåœ°å­˜å‚¨å’Œè®¿é—®æµæ˜ å°„ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œå°†æµæ˜ å°„åˆ†è§£ä¸ºé•¿æ—¶å’ŒçŸ­æ—¶ä¸¤éƒ¨åˆ†ï¼Œé•¿æ—¶éƒ¨åˆ†ç”¨äºè¿½è¸ªæµä½“çš„æ•´ä½“è¿åŠ¨è¶‹åŠ¿ï¼ŒçŸ­æ—¶éƒ¨åˆ†ç”¨äºæ•æ‰æµä½“çš„å±€éƒ¨ç»†èŠ‚ã€‚æ­¤å¤–ï¼Œè®ºæ–‡è¿˜è®¾è®¡äº†ç›¸åº”çš„æŸå¤±å‡½æ•°ï¼Œç”¨äºä¼˜åŒ–æµä½“æ¨¡æ‹Ÿè¿‡ç¨‹ä¸­çš„å‚æ•°ã€‚

## ğŸ“Š å®éªŒäº®ç‚¹

è¯¥æ–¹æ³•åœ¨$192^3$åˆ†è¾¨ç‡ä¸‹ä»…éœ€6.53GBå†…å­˜ï¼Œæ˜¾è‘—ä½äºä¼ ç»Ÿä¼´éšæ–¹æ³•ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿç²¾ç¡®è·Ÿè¸ªæ¶¡é‡ï¼Œå¹¶æ”¯æŒéœ€è¦ç²¾ç¡®è¯†åˆ«ã€é¢„æµ‹å’Œæ§åˆ¶æ¶¡æ—‹åŠ¨åŠ›å­¦çš„å¯å¾®æ¨¡æ‹Ÿä»»åŠ¡ã€‚ä¸ç°æœ‰æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥æ–¹æ³•åœ¨å†…å­˜å ç”¨å’Œè®¡ç®—æ•ˆç‡æ–¹é¢å…·æœ‰æ˜¾è‘—ä¼˜åŠ¿ï¼ŒåŒæ—¶ä¿æŒäº†è¾ƒé«˜çš„ç²¾åº¦ã€‚

## ğŸ¯ åº”ç”¨åœºæ™¯

è¯¥ç ”ç©¶æˆæœå¯åº”ç”¨äºå„ç§éœ€è¦ç²¾ç¡®æ§åˆ¶æµä½“è¿åŠ¨çš„é¢†åŸŸï¼Œä¾‹å¦‚ï¼šæµä½“æ§åˆ¶ã€æœºå™¨äººæ“ä½œã€è®¡ç®—æœºåŠ¨ç”»ã€ä»¥åŠææ–™è®¾è®¡ç­‰ã€‚é€šè¿‡å¯å¾®æµä½“æ¨¡æ‹Ÿï¼Œå¯ä»¥ä¼˜åŒ–æ§åˆ¶ç­–ç•¥ï¼Œç”Ÿæˆæ›´é€¼çœŸçš„åŠ¨ç”»æ•ˆæœï¼Œå¹¶è®¾è®¡å…·æœ‰ç‰¹å®šæµä½“åŠ¨åŠ›å­¦ç‰¹æ€§çš„ææ–™ã€‚è¯¥æ–¹æ³•ä¸ºæµä½“æ¨¡æ‹Ÿä¸æœºå™¨å­¦ä¹ çš„ç»“åˆæä¾›äº†æ–°çš„æ€è·¯ã€‚

## ğŸ“„ æ‘˜è¦ï¼ˆåŸæ–‡ï¼‰

> This paper presents a novel adjoint solver for differentiable fluid simulation based on bidirectional flow maps. Our key observation is that the forward fluid solver and its corresponding backward, adjoint solver share the same flow map as the forward simulation. In the forward pass, this map transports fluid impulse variables from the initial frame to the current frame to simulate vortical dynamics. In the backward pass, the same map propagates adjoint variables from the current frame back to the initial frame to compute gradients. This shared long-range map allows the accuracy of gradient computation to benefit directly from improvements in flow map construction. Building on this insight, we introduce a novel adjoint solver that solves the adjoint equations directly on the flow map, enabling long-range and accurate differentiation of incompressible flows without differentiating intermediate numerical steps or storing intermediate variables, as required in conventional adjoint methods. To further improve efficiency, we propose a long-short time-sparse flow map representation for evolving adjoint variables. Our approach has low memory usage, requiring only 6.53GB of data at a resolution of $192^3$ while preserving high accuracy in tracking vorticity, enabling new differentiable simulation tasks that require precise identification, prediction, and control of vortex dynamics.

